Found 31 matrices to analyze
Analyzing first 3 layers...

============================================================
FULL ANALYSIS: /home/datadi/burns/aws/workloads/data/wanda_unstructured/layer0-mlp.down_proj.pt
============================================================
Matrix shape: torch.Size([4096, 11008])
Computing pairwise Hamming distances for ALL 11008 features...
WARNING: This may take a long time and use significant memory...
Distance matrix computed (shape: (60582528,))
Computing hierarchical clustering linkage with method='ward'...
Linkage matrix computed

--- Analyzing with 10 clusters ---
Computing metrics for 10 clusters...
Computing within-cluster distances:   0%|          | 0/10 [00:00<?, ?it/s]Computing within-cluster distances:  80%|████████  | 8/10 [00:00<00:00, 67.98it/s]Computing within-cluster distances: 100%|██████████| 10/10 [00:00<00:00, 60.42it/s]
Computing between-cluster distances for 45 cluster pairs...
  0%|          | 0/45 [00:00<?, ?it/s] 11%|█         | 5/45 [00:00<00:00, 48.25it/s] 22%|██▏       | 10/45 [00:00<00:00, 43.79it/s] 33%|███▎      | 15/45 [00:00<00:00, 43.97it/s] 44%|████▍     | 20/45 [00:00<00:00, 43.54it/s] 56%|█████▌    | 25/45 [00:00<00:00, 42.03it/s] 67%|██████▋   | 30/45 [00:00<00:00, 41.68it/s] 78%|███████▊  | 35/45 [00:00<00:00, 40.54it/s] 89%|████████▉ | 40/45 [00:00<00:00, 40.40it/s]100%|██████████| 45/45 [00:01<00:00, 41.56it/s]100%|██████████| 45/45 [00:01<00:00, 42.02it/s]

Clustering Summary (n_clusters=10):
  Mean within-cluster distance: 0.4147
  Mean between-cluster distance: 0.4302
  Separation ratio: 1.0375
  Cluster size distribution: min=51, max=2885, mean=1100.8

--- Analyzing with 50 clusters ---
Computing metrics for 50 clusters...
Computing within-cluster distances:   0%|          | 0/50 [00:00<?, ?it/s]Computing within-cluster distances:  50%|█████     | 25/50 [00:00<00:00, 246.55it/s]Computing within-cluster distances: 100%|██████████| 50/50 [00:00<00:00, 142.31it/s]Computing within-cluster distances: 100%|██████████| 50/50 [00:00<00:00, 151.85it/s]
Computing between-cluster distances for 1000 cluster pairs...
  0%|          | 0/1000 [00:00<?, ?it/s]  2%|▏         | 16/1000 [00:00<00:06, 142.83it/s]  3%|▎         | 31/1000 [00:00<00:08, 113.03it/s]  5%|▍         | 47/1000 [00:00<00:07, 127.71it/s]  6%|▌         | 61/1000 [00:00<00:08, 112.98it/s]  8%|▊         | 76/1000 [00:00<00:07, 123.12it/s]  9%|▉         | 89/1000 [00:00<00:07, 119.75it/s] 10%|█         | 102/1000 [00:00<00:08, 111.22it/s] 12%|█▏        | 115/1000 [00:00<00:07, 115.06it/s] 13%|█▎        | 127/1000 [00:01<00:07, 113.73it/s] 14%|█▍        | 140/1000 [00:01<00:07, 118.24it/s] 15%|█▌        | 152/1000 [00:01<00:07, 117.41it/s] 16%|█▋        | 164/1000 [00:01<00:07, 113.34it/s] 18%|█▊        | 178/1000 [00:01<00:07, 114.06it/s] 19%|█▉        | 190/1000 [00:01<00:07, 111.28it/s] 20%|██        | 203/1000 [00:01<00:06, 115.33it/s] 22%|██▏       | 216/1000 [00:01<00:06, 115.22it/s] 23%|██▎       | 229/1000 [00:01<00:06, 114.96it/s] 24%|██▍       | 242/1000 [00:02<00:06, 119.06it/s] 25%|██▌       | 254/1000 [00:02<00:06, 114.50it/s] 27%|██▋       | 267/1000 [00:02<00:06, 118.29it/s] 28%|██▊       | 280/1000 [00:02<00:05, 120.31it/s] 29%|██▉       | 293/1000 [00:02<00:06, 114.96it/s] 30%|███       | 305/1000 [00:02<00:06, 110.13it/s] 32%|███▏      | 323/1000 [00:02<00:05, 128.24it/s] 34%|███▎      | 337/1000 [00:02<00:05, 114.26it/s] 35%|███▌      | 351/1000 [00:02<00:05, 120.44it/s] 36%|███▋      | 364/1000 [00:03<00:05, 117.98it/s] 38%|███▊      | 377/1000 [00:03<00:05, 114.02it/s] 39%|███▉      | 389/1000 [00:03<00:05, 113.07it/s] 40%|████      | 404/1000 [00:03<00:04, 122.04it/s] 42%|████▏     | 418/1000 [00:03<00:04, 124.51it/s] 43%|████▎     | 433/1000 [00:03<00:04, 128.15it/s] 45%|████▍     | 446/1000 [00:03<00:04, 114.10it/s] 46%|████▌     | 460/1000 [00:03<00:04, 118.83it/s] 47%|████▋     | 473/1000 [00:04<00:04, 116.60it/s] 48%|████▊     | 485/1000 [00:04<00:04, 116.16it/s] 50%|████▉     | 498/1000 [00:04<00:04, 119.50it/s] 51%|█████     | 511/1000 [00:04<00:04, 110.64it/s] 52%|█████▎    | 525/1000 [00:04<00:04, 118.26it/s] 54%|█████▍    | 541/1000 [00:04<00:03, 129.44it/s] 56%|█████▌    | 555/1000 [00:04<00:03, 121.85it/s] 57%|█████▋    | 568/1000 [00:04<00:03, 112.62it/s] 58%|█████▊    | 582/1000 [00:04<00:03, 117.51it/s] 60%|█████▉    | 595/1000 [00:05<00:03, 116.62it/s] 61%|██████    | 608/1000 [00:05<00:03, 117.82it/s] 63%|██████▎   | 626/1000 [00:05<00:02, 134.77it/s] 64%|██████▍   | 640/1000 [00:05<00:03, 119.08it/s] 66%|██████▌   | 656/1000 [00:05<00:02, 128.38it/s] 67%|██████▋   | 670/1000 [00:05<00:02, 125.81it/s] 68%|██████▊   | 683/1000 [00:05<00:02, 116.09it/s] 70%|██████▉   | 695/1000 [00:05<00:02, 116.74it/s] 71%|███████   | 709/1000 [00:05<00:02, 121.73it/s] 72%|███████▏  | 723/1000 [00:06<00:02, 123.85it/s] 74%|███████▎  | 736/1000 [00:06<00:02, 125.16it/s] 75%|███████▍  | 749/1000 [00:06<00:02, 123.73it/s] 76%|███████▌  | 762/1000 [00:06<00:01, 123.21it/s] 78%|███████▊  | 776/1000 [00:06<00:01, 127.68it/s] 79%|███████▉  | 789/1000 [00:06<00:01, 120.72it/s] 80%|████████  | 805/1000 [00:06<00:01, 131.52it/s] 82%|████████▏ | 819/1000 [00:06<00:01, 130.91it/s] 83%|████████▎ | 833/1000 [00:06<00:01, 116.32it/s] 85%|████████▍ | 846/1000 [00:07<00:01, 107.26it/s] 86%|████████▌ | 859/1000 [00:07<00:01, 112.18it/s] 88%|████████▊ | 875/1000 [00:07<00:01, 123.78it/s] 89%|████████▉ | 888/1000 [00:07<00:00, 113.40it/s] 90%|█████████ | 904/1000 [00:07<00:00, 125.07it/s] 92%|█████████▏| 921/1000 [00:07<00:00, 135.68it/s] 94%|█████████▎| 935/1000 [00:07<00:00, 130.32it/s] 95%|█████████▍| 949/1000 [00:07<00:00, 125.69it/s] 96%|█████████▌| 962/1000 [00:08<00:00, 115.63it/s] 97%|█████████▋| 974/1000 [00:08<00:00, 115.88it/s] 99%|█████████▊| 987/1000 [00:08<00:00, 116.89it/s]100%|██████████| 1000/1000 [00:08<00:00, 119.85it/s]

Clustering Summary (n_clusters=50):
  Mean within-cluster distance: 0.4300
  Mean between-cluster distance: 0.4600
  Separation ratio: 1.0696
  Cluster size distribution: min=4, max=2867, mean=220.2

--- Analyzing with 100 clusters ---
Computing metrics for 100 clusters...
Computing within-cluster distances:   0%|          | 0/100 [00:00<?, ?it/s]Computing within-cluster distances:  44%|████▍     | 44/100 [00:00<00:00, 428.59it/s]Computing within-cluster distances:  87%|████████▋ | 87/100 [00:00<00:00, 328.87it/s]Computing within-cluster distances: 100%|██████████| 100/100 [00:00<00:00, 224.40it/s]
Computing between-cluster distances for 1000 cluster pairs...
  0%|          | 0/1000 [00:00<?, ?it/s]  2%|▏         | 20/1000 [00:00<00:04, 197.13it/s]  4%|▍         | 40/1000 [00:00<00:05, 175.37it/s]  6%|▌         | 59/1000 [00:00<00:05, 179.95it/s]  8%|▊         | 84/1000 [00:00<00:04, 203.72it/s] 10%|█         | 105/1000 [00:00<00:04, 199.46it/s] 13%|█▎        | 126/1000 [00:00<00:04, 194.22it/s] 15%|█▍        | 146/1000 [00:00<00:04, 175.38it/s] 17%|█▋        | 168/1000 [00:00<00:04, 187.16it/s] 19%|█▉        | 193/1000 [00:00<00:03, 202.77it/s] 21%|██▏       | 214/1000 [00:01<00:04, 195.77it/s] 23%|██▎       | 234/1000 [00:01<00:04, 191.28it/s] 25%|██▌       | 254/1000 [00:01<00:04, 177.82it/s] 27%|██▋       | 273/1000 [00:01<00:04, 180.53it/s] 29%|██▉       | 293/1000 [00:01<00:03, 184.26it/s] 31%|███▏      | 314/1000 [00:01<00:03, 183.89it/s] 33%|███▎      | 333/1000 [00:01<00:03, 176.41it/s] 36%|███▌      | 358/1000 [00:01<00:03, 184.80it/s] 38%|███▊      | 377/1000 [00:02<00:03, 173.25it/s] 40%|███▉      | 395/1000 [00:02<00:03, 172.47it/s] 42%|████▏     | 416/1000 [00:02<00:03, 181.69it/s] 44%|████▎     | 435/1000 [00:02<00:03, 173.75it/s] 46%|████▌     | 455/1000 [00:02<00:03, 180.89it/s] 48%|████▊     | 478/1000 [00:02<00:02, 187.08it/s] 50%|█████     | 501/1000 [00:02<00:02, 196.53it/s] 52%|█████▏    | 521/1000 [00:02<00:02, 168.46it/s] 54%|█████▍    | 542/1000 [00:02<00:02, 176.68it/s] 56%|█████▌    | 561/1000 [00:03<00:02, 176.51it/s] 58%|█████▊    | 580/1000 [00:03<00:02, 177.89it/s] 60%|█████▉    | 599/1000 [00:03<00:02, 177.85it/s] 62%|██████▏   | 618/1000 [00:03<00:02, 176.42it/s] 64%|██████▎   | 636/1000 [00:03<00:02, 175.19it/s] 66%|██████▌   | 662/1000 [00:03<00:01, 197.49it/s] 68%|██████▊   | 682/1000 [00:03<00:01, 159.29it/s] 70%|███████   | 703/1000 [00:03<00:01, 169.40it/s] 72%|███████▏  | 721/1000 [00:04<00:01, 166.29it/s] 74%|███████▍  | 739/1000 [00:04<00:01, 167.61it/s] 76%|███████▌  | 758/1000 [00:04<00:01, 173.28it/s] 78%|███████▊  | 776/1000 [00:04<00:01, 160.69it/s] 79%|███████▉  | 793/1000 [00:04<00:01, 156.88it/s] 81%|████████  | 809/1000 [00:04<00:01, 153.97it/s] 83%|████████▎ | 828/1000 [00:04<00:01, 160.51it/s] 85%|████████▍ | 848/1000 [00:04<00:00, 167.66it/s] 87%|████████▋ | 869/1000 [00:04<00:00, 178.49it/s] 89%|████████▉ | 888/1000 [00:05<00:00, 170.91it/s] 91%|█████████ | 912/1000 [00:05<00:00, 189.33it/s] 93%|█████████▎| 932/1000 [00:05<00:00, 184.02it/s] 95%|█████████▌| 951/1000 [00:05<00:00, 185.31it/s] 97%|█████████▋| 974/1000 [00:05<00:00, 194.89it/s] 99%|█████████▉| 994/1000 [00:05<00:00, 174.57it/s]100%|██████████| 1000/1000 [00:05<00:00, 178.62it/s]

Clustering Summary (n_clusters=100):
  Mean within-cluster distance: 0.4198
  Mean between-cluster distance: 0.4581
  Separation ratio: 1.0914
  Cluster size distribution: min=2, max=1681, mean=110.1

--- Analyzing with 500 clusters ---
Computing metrics for 500 clusters...
Computing within-cluster distances:   0%|          | 0/500 [00:00<?, ?it/s]Computing within-cluster distances:  38%|███▊      | 192/500 [00:00<00:00, 1909.06it/s]Computing within-cluster distances:  77%|███████▋  | 383/500 [00:00<00:00, 1152.73it/s]Computing within-cluster distances: 100%|██████████| 500/500 [00:00<00:00, 599.58it/s] 
Computing between-cluster distances for 1000 cluster pairs...
  0%|          | 0/1000 [00:00<?, ?it/s]  4%|▎         | 37/1000 [00:00<00:02, 365.60it/s]  7%|▋         | 74/1000 [00:00<00:02, 351.49it/s] 11%|█▏        | 113/1000 [00:00<00:02, 365.44it/s] 16%|█▌        | 157/1000 [00:00<00:02, 391.79it/s] 20%|██        | 200/1000 [00:00<00:01, 403.61it/s] 24%|██▍       | 241/1000 [00:00<00:01, 387.78it/s] 29%|██▉       | 289/1000 [00:00<00:01, 416.67it/s] 33%|███▎      | 331/1000 [00:00<00:01, 389.84it/s] 37%|███▋      | 374/1000 [00:00<00:01, 400.47it/s] 42%|████▏     | 422/1000 [00:01<00:01, 423.82it/s] 46%|████▋     | 465/1000 [00:01<00:01, 423.25it/s] 51%|█████     | 508/1000 [00:01<00:01, 418.06it/s] 56%|█████▌    | 560/1000 [00:01<00:00, 446.75it/s] 61%|██████    | 606/1000 [00:01<00:00, 435.02it/s] 66%|██████▌   | 655/1000 [00:01<00:00, 449.17it/s] 70%|███████   | 701/1000 [00:01<00:00, 402.00it/s] 75%|███████▍  | 748/1000 [00:01<00:00, 419.32it/s] 79%|███████▉  | 791/1000 [00:01<00:00, 411.81it/s] 84%|████████▍ | 839/1000 [00:02<00:00, 428.77it/s] 89%|████████▊ | 886/1000 [00:02<00:00, 440.13it/s] 93%|█████████▎| 931/1000 [00:02<00:00, 413.76it/s] 98%|█████████▊| 979/1000 [00:02<00:00, 428.99it/s]100%|██████████| 1000/1000 [00:02<00:00, 419.38it/s]

Clustering Summary (n_clusters=500):
  Mean within-cluster distance: 0.3692
  Mean between-cluster distance: 0.4456
  Separation ratio: 1.2071
  Cluster size distribution: min=2, max=1681, mean=22.0

--- Analyzing with 1000 clusters ---
Computing metrics for 1000 clusters...
Computing within-cluster distances:   0%|          | 0/1000 [00:00<?, ?it/s]Computing within-cluster distances:  30%|███       | 303/1000 [00:00<00:00, 3029.41it/s]Computing within-cluster distances:  61%|██████    | 606/1000 [00:00<00:00, 2646.24it/s]Computing within-cluster distances:  87%|████████▋ | 874/1000 [00:00<00:00, 1227.37it/s]Computing within-cluster distances: 100%|██████████| 1000/1000 [00:01<00:00, 982.69it/s]
Computing between-cluster distances for 1000 cluster pairs...
  0%|          | 0/1000 [00:00<?, ?it/s]  7%|▋         | 68/1000 [00:00<00:01, 679.19it/s] 14%|█▎        | 136/1000 [00:00<00:01, 603.25it/s] 21%|██        | 209/1000 [00:00<00:01, 652.29it/s] 28%|██▊       | 276/1000 [00:00<00:01, 657.03it/s] 34%|███▍      | 343/1000 [00:00<00:01, 652.84it/s] 41%|████      | 411/1000 [00:00<00:00, 659.98it/s] 48%|████▊     | 478/1000 [00:00<00:00, 655.26it/s] 55%|█████▍    | 546/1000 [00:00<00:00, 659.09it/s] 62%|██████▏   | 616/1000 [00:00<00:00, 669.95it/s] 69%|██████▉   | 688/1000 [00:01<00:00, 683.79it/s] 76%|███████▋  | 763/1000 [00:01<00:00, 703.11it/s] 84%|████████▍ | 843/1000 [00:01<00:00, 730.68it/s] 92%|█████████▏| 917/1000 [00:01<00:00, 721.03it/s] 99%|█████████▉| 990/1000 [00:01<00:00, 707.90it/s]100%|██████████| 1000/1000 [00:01<00:00, 681.48it/s]

Clustering Summary (n_clusters=1000):
  Mean within-cluster distance: 0.3080
  Mean between-cluster distance: 0.4321
  Separation ratio: 1.4026
  Cluster size distribution: min=1, max=1681, mean=11.0

--- Analyzing with 2000 clusters ---
Computing metrics for 2000 clusters...
Computing within-cluster distances:   0%|          | 0/2000 [00:00<?, ?it/s]Computing within-cluster distances:  26%|██▋       | 527/2000 [00:00<00:00, 5268.96it/s]Computing within-cluster distances:  53%|█████▎    | 1054/2000 [00:00<00:00, 4784.41it/s]Computing within-cluster distances:  77%|███████▋  | 1536/2000 [00:00<00:00, 2085.10it/s]Computing within-cluster distances:  93%|█████████▎| 1853/2000 [00:01<00:00, 1357.50it/s]Computing within-cluster distances: 100%|██████████| 2000/2000 [00:01<00:00, 1677.06it/s]
Computing between-cluster distances for 1000 cluster pairs...
  0%|          | 0/1000 [00:00<?, ?it/s] 11%|█▏        | 113/1000 [00:00<00:00, 1125.00it/s] 24%|██▍       | 240/1000 [00:00<00:00, 1208.35it/s] 36%|███▌      | 361/1000 [00:00<00:00, 1200.86it/s] 49%|████▊     | 487/1000 [00:00<00:00, 1208.51it/s] 61%|██████    | 609/1000 [00:00<00:00, 1211.24it/s] 74%|███████▍  | 742/1000 [00:00<00:00, 1249.17it/s] 87%|████████▋ | 867/1000 [00:00<00:00, 1157.32it/s] 98%|█████████▊| 984/1000 [00:00<00:00, 1160.71it/s]100%|██████████| 1000/1000 [00:00<00:00, 1188.02it/s]

Clustering Summary (n_clusters=2000):
  Mean within-cluster distance: 0.2052
  Mean between-cluster distance: 0.4183
  Separation ratio: 2.0383
  Cluster size distribution: min=1, max=863, mean=5.5

============================================================
Total computation time: 20.33 minutes
============================================================
✓ Intermediate results saved to: /home/datadi/burns/aws/workloads/results/metrics/agglomerative_clustering/wanda/agglomerative_clustering_full_results.json

============================================================
FULL ANALYSIS: /home/datadi/burns/aws/workloads/data/wanda_unstructured/layer2-mlp.down_proj.pt
============================================================
Matrix shape: torch.Size([4096, 11008])
Computing pairwise Hamming distances for ALL 11008 features...
WARNING: This may take a long time and use significant memory...
Distance matrix computed (shape: (60582528,))
Computing hierarchical clustering linkage with method='ward'...
Linkage matrix computed

--- Analyzing with 10 clusters ---
Computing metrics for 10 clusters...
Computing within-cluster distances:   0%|          | 0/10 [00:00<?, ?it/s]Computing within-cluster distances: 100%|██████████| 10/10 [00:00<00:00, 93.86it/s]Computing within-cluster distances: 100%|██████████| 10/10 [00:00<00:00, 93.71it/s]
Computing between-cluster distances for 45 cluster pairs...
  0%|          | 0/45 [00:00<?, ?it/s] 22%|██▏       | 10/45 [00:00<00:00, 89.70it/s] 42%|████▏     | 19/45 [00:00<00:00, 76.25it/s] 60%|██████    | 27/45 [00:00<00:00, 58.13it/s] 84%|████████▍ | 38/45 [00:00<00:00, 70.83it/s]100%|██████████| 45/45 [00:00<00:00, 63.84it/s]

Clustering Summary (n_clusters=10):
  Mean within-cluster distance: 0.4131
  Mean between-cluster distance: 0.4379
  Separation ratio: 1.0602
  Cluster size distribution: min=4, max=5204, mean=1100.8

--- Analyzing with 50 clusters ---
Computing metrics for 50 clusters...
Computing within-cluster distances:   0%|          | 0/50 [00:00<?, ?it/s]Computing within-cluster distances:  40%|████      | 20/50 [00:00<00:00, 193.31it/s]Computing within-cluster distances: 100%|██████████| 50/50 [00:00<00:00, 269.72it/s]
Computing between-cluster distances for 1000 cluster pairs...
  0%|          | 0/1000 [00:00<?, ?it/s]  3%|▎         | 28/1000 [00:00<00:03, 256.50it/s]  5%|▌         | 54/1000 [00:00<00:04, 193.43it/s]  8%|▊         | 75/1000 [00:00<00:05, 165.60it/s]  9%|▉         | 93/1000 [00:00<00:05, 166.24it/s] 12%|█▏        | 121/1000 [00:00<00:04, 199.04it/s] 14%|█▍        | 142/1000 [00:00<00:04, 192.60it/s] 16%|█▋        | 163/1000 [00:00<00:04, 196.84it/s] 18%|█▊        | 184/1000 [00:01<00:04, 165.25it/s] 21%|██▏       | 214/1000 [00:01<00:04, 195.67it/s] 24%|██▎       | 235/1000 [00:01<00:03, 194.81it/s] 26%|██▌       | 262/1000 [00:01<00:03, 214.40it/s] 28%|██▊       | 285/1000 [00:01<00:03, 205.34it/s] 31%|███       | 309/1000 [00:01<00:03, 208.29it/s] 33%|███▎      | 331/1000 [00:01<00:03, 199.98it/s] 35%|███▌      | 352/1000 [00:01<00:03, 190.70it/s] 38%|███▊      | 378/1000 [00:01<00:02, 208.44it/s] 40%|████      | 400/1000 [00:02<00:02, 206.23it/s] 43%|████▎     | 433/1000 [00:02<00:02, 233.00it/s] 46%|████▌     | 457/1000 [00:02<00:02, 205.20it/s] 48%|████▊     | 479/1000 [00:02<00:02, 190.59it/s] 50%|█████     | 505/1000 [00:02<00:02, 205.23it/s] 53%|█████▎    | 527/1000 [00:02<00:02, 197.30it/s] 55%|█████▍    | 548/1000 [00:02<00:02, 170.98it/s] 57%|█████▋    | 572/1000 [00:02<00:02, 185.75it/s] 59%|█████▉    | 592/1000 [00:03<00:02, 183.66it/s] 61%|██████    | 611/1000 [00:03<00:02, 167.80it/s] 64%|██████▍   | 639/1000 [00:03<00:01, 191.99it/s] 66%|██████▌   | 659/1000 [00:03<00:01, 186.44it/s] 68%|██████▊   | 684/1000 [00:03<00:01, 196.60it/s] 70%|███████   | 705/1000 [00:03<00:01, 194.75it/s] 73%|███████▎  | 728/1000 [00:03<00:01, 197.81it/s] 75%|███████▌  | 754/1000 [00:03<00:01, 212.12it/s] 78%|███████▊  | 776/1000 [00:03<00:01, 202.06it/s] 80%|███████▉  | 797/1000 [00:04<00:01, 201.05it/s] 82%|████████▏ | 820/1000 [00:04<00:00, 205.07it/s] 84%|████████▍ | 841/1000 [00:04<00:00, 190.63it/s] 87%|████████▋ | 871/1000 [00:04<00:00, 211.49it/s] 89%|████████▉ | 893/1000 [00:04<00:00, 208.34it/s] 91%|█████████▏| 914/1000 [00:04<00:00, 195.23it/s] 93%|█████████▎| 934/1000 [00:04<00:00, 194.76it/s] 96%|█████████▌| 957/1000 [00:04<00:00, 202.43it/s] 98%|█████████▊| 979/1000 [00:04<00:00, 206.59it/s]100%|██████████| 1000/1000 [00:05<00:00, 190.21it/s]100%|██████████| 1000/1000 [00:05<00:00, 195.89it/s]

Clustering Summary (n_clusters=50):
  Mean within-cluster distance: 0.4205
  Mean between-cluster distance: 0.4491
  Separation ratio: 1.0680
  Cluster size distribution: min=2, max=3790, mean=220.2

--- Analyzing with 100 clusters ---
Computing metrics for 100 clusters...
Computing within-cluster distances:   0%|          | 0/100 [00:00<?, ?it/s]Computing within-cluster distances:   8%|▊         | 8/100 [00:00<00:01, 76.58it/s]Computing within-cluster distances:  77%|███████▋  | 77/100 [00:00<00:00, 429.92it/s]Computing within-cluster distances: 100%|██████████| 100/100 [00:00<00:00, 324.25it/s]
Computing between-cluster distances for 1000 cluster pairs...
  0%|          | 0/1000 [00:00<?, ?it/s]  2%|▏         | 23/1000 [00:00<00:04, 221.33it/s]  5%|▍         | 48/1000 [00:00<00:04, 230.14it/s]  7%|▋         | 72/1000 [00:00<00:04, 219.57it/s] 10%|█         | 103/1000 [00:00<00:03, 248.04it/s] 13%|█▎        | 133/1000 [00:00<00:03, 256.68it/s] 16%|█▌        | 161/1000 [00:00<00:03, 263.67it/s] 19%|█▉        | 188/1000 [00:00<00:03, 250.84it/s] 21%|██▏       | 214/1000 [00:00<00:03, 233.65it/s] 25%|██▌       | 253/1000 [00:00<00:02, 273.65it/s] 28%|██▊       | 281/1000 [00:01<00:02, 259.49it/s] 31%|███       | 309/1000 [00:01<00:02, 264.50it/s] 34%|███▎      | 336/1000 [00:01<00:02, 246.09it/s] 37%|███▋      | 369/1000 [00:01<00:02, 268.27it/s] 40%|███▉      | 397/1000 [00:01<00:02, 265.16it/s] 42%|████▏     | 424/1000 [00:01<00:02, 263.01it/s] 45%|████▌     | 451/1000 [00:01<00:02, 253.55it/s] 48%|████▊     | 477/1000 [00:01<00:02, 250.58it/s] 50%|█████     | 503/1000 [00:01<00:01, 252.62it/s] 53%|█████▎    | 533/1000 [00:02<00:01, 266.11it/s] 57%|█████▋    | 567/1000 [00:02<00:01, 285.13it/s] 60%|█████▉    | 596/1000 [00:02<00:01, 274.77it/s] 62%|██████▏   | 624/1000 [00:02<00:01, 274.06it/s] 65%|██████▌   | 654/1000 [00:02<00:01, 271.26it/s] 68%|██████▊   | 682/1000 [00:02<00:01, 263.76it/s] 72%|███████▏  | 715/1000 [00:02<00:01, 276.76it/s] 74%|███████▍  | 743/1000 [00:02<00:00, 268.86it/s] 77%|███████▋  | 770/1000 [00:02<00:00, 264.86it/s] 80%|███████▉  | 797/1000 [00:03<00:00, 258.30it/s] 82%|████████▏ | 823/1000 [00:03<00:00, 252.14it/s] 85%|████████▍ | 849/1000 [00:03<00:00, 237.58it/s] 87%|████████▋ | 873/1000 [00:03<00:00, 234.74it/s] 90%|█████████ | 900/1000 [00:03<00:00, 243.43it/s] 92%|█████████▎| 925/1000 [00:03<00:00, 230.18it/s] 95%|█████████▍| 949/1000 [00:03<00:00, 229.92it/s] 98%|█████████▊| 976/1000 [00:03<00:00, 237.85it/s]100%|██████████| 1000/1000 [00:03<00:00, 238.34it/s]100%|██████████| 1000/1000 [00:03<00:00, 253.75it/s]

Clustering Summary (n_clusters=100):
  Mean within-cluster distance: 0.4054
  Mean between-cluster distance: 0.4403
  Separation ratio: 1.0860
  Cluster size distribution: min=2, max=2370, mean=110.1

--- Analyzing with 500 clusters ---
Computing metrics for 500 clusters...
Computing within-cluster distances:   0%|          | 0/500 [00:00<?, ?it/s]Computing within-cluster distances:   4%|▎         | 18/500 [00:00<00:02, 170.19it/s]Computing within-cluster distances:   8%|▊         | 39/500 [00:00<00:02, 189.08it/s]Computing within-cluster distances:  13%|█▎        | 65/500 [00:00<00:01, 220.34it/s]Computing within-cluster distances:  18%|█▊        | 88/500 [00:00<00:01, 219.42it/s]Computing within-cluster distances:  22%|██▏       | 111/500 [00:00<00:01, 222.28it/s]Computing within-cluster distances:  27%|██▋       | 134/500 [00:00<00:01, 220.92it/s]Computing within-cluster distances:  70%|███████   | 350/500 [00:00<00:00, 835.04it/s]Computing within-cluster distances:  87%|████████▋ | 435/500 [00:00<00:00, 690.76it/s]Computing within-cluster distances: 100%|██████████| 500/500 [00:00<00:00, 534.08it/s]
Computing between-cluster distances for 1000 cluster pairs...
  0%|          | 0/1000 [00:00<?, ?it/s]  5%|▍         | 46/1000 [00:00<00:02, 449.33it/s]  9%|▉         | 91/1000 [00:00<00:02, 446.29it/s] 14%|█▎        | 136/1000 [00:00<00:01, 434.42it/s] 18%|█▊        | 180/1000 [00:00<00:01, 432.10it/s] 23%|██▎       | 229/1000 [00:00<00:01, 451.42it/s] 28%|██▊       | 281/1000 [00:00<00:01, 472.46it/s] 33%|███▎      | 329/1000 [00:00<00:01, 464.17it/s] 38%|███▊      | 380/1000 [00:00<00:01, 476.08it/s] 43%|████▎     | 433/1000 [00:00<00:01, 489.98it/s] 49%|████▉     | 492/1000 [00:01<00:00, 515.63it/s] 55%|█████▍    | 549/1000 [00:01<00:00, 530.76it/s] 60%|██████    | 603/1000 [00:01<00:00, 519.13it/s] 66%|██████▌   | 655/1000 [00:01<00:00, 509.33it/s] 71%|███████   | 707/1000 [00:01<00:00, 491.49it/s] 76%|███████▌  | 757/1000 [00:01<00:00, 480.44it/s] 81%|████████  | 806/1000 [00:01<00:00, 474.70it/s] 86%|████████▌ | 855/1000 [00:01<00:00, 477.50it/s] 90%|█████████ | 903/1000 [00:01<00:00, 468.62it/s] 95%|█████████▌| 950/1000 [00:01<00:00, 467.43it/s]100%|█████████▉| 997/1000 [00:02<00:00, 466.98it/s]100%|██████████| 1000/1000 [00:02<00:00, 478.13it/s]

Clustering Summary (n_clusters=500):
  Mean within-cluster distance: 0.3327
  Mean between-cluster distance: 0.4144
  Separation ratio: 1.2455
  Cluster size distribution: min=1, max=506, mean=22.0

--- Analyzing with 1000 clusters ---
Computing metrics for 1000 clusters...
Computing within-cluster distances:   0%|          | 0/1000 [00:00<?, ?it/s]Computing within-cluster distances:   2%|▏         | 24/1000 [00:00<00:04, 236.60it/s]Computing within-cluster distances:   5%|▍         | 48/1000 [00:00<00:04, 232.12it/s]Computing within-cluster distances:   7%|▋         | 72/1000 [00:00<00:03, 233.68it/s]Computing within-cluster distances:  11%|█         | 112/1000 [00:00<00:02, 297.16it/s]Computing within-cluster distances:  16%|█▌        | 159/1000 [00:00<00:02, 355.27it/s]Computing within-cluster distances:  20%|█▉        | 195/1000 [00:00<00:02, 333.97it/s]Computing within-cluster distances:  23%|██▎       | 229/1000 [00:00<00:02, 314.42it/s]Computing within-cluster distances:  26%|██▌       | 261/1000 [00:00<00:02, 313.56it/s]Computing within-cluster distances:  29%|██▉       | 294/1000 [00:00<00:02, 315.27it/s]Computing within-cluster distances:  33%|███▎      | 326/1000 [00:01<00:02, 305.72it/s]Computing within-cluster distances:  66%|██████▌   | 658/1000 [00:01<00:00, 1172.73it/s]Computing within-cluster distances:  78%|███████▊  | 781/1000 [00:01<00:00, 1179.25it/s]Computing within-cluster distances: 100%|██████████| 1000/1000 [00:01<00:00, 735.00it/s]
Computing between-cluster distances for 1000 cluster pairs...
  0%|          | 0/1000 [00:00<?, ?it/s]  6%|▌         | 59/1000 [00:00<00:01, 568.52it/s] 12%|█▏        | 121/1000 [00:00<00:01, 597.19it/s] 18%|█▊        | 183/1000 [00:00<00:01, 604.17it/s] 25%|██▍       | 248/1000 [00:00<00:01, 621.92it/s] 31%|███▏      | 314/1000 [00:00<00:01, 633.35it/s] 39%|███▊      | 387/1000 [00:00<00:00, 665.01it/s] 46%|████▌     | 455/1000 [00:00<00:00, 663.76it/s] 53%|█████▎    | 527/1000 [00:00<00:00, 681.10it/s] 60%|█████▉    | 599/1000 [00:00<00:00, 689.72it/s] 67%|██████▋   | 668/1000 [00:01<00:00, 668.42it/s] 74%|███████▍  | 741/1000 [00:01<00:00, 685.73it/s] 81%|████████  | 810/1000 [00:01<00:00, 681.53it/s] 88%|████████▊ | 879/1000 [00:01<00:00, 659.80it/s] 95%|█████████▍| 946/1000 [00:01<00:00, 660.54it/s]100%|██████████| 1000/1000 [00:01<00:00, 660.00it/s]

Clustering Summary (n_clusters=1000):
  Mean within-cluster distance: 0.2826
  Mean between-cluster distance: 0.4004
  Separation ratio: 1.4172
  Cluster size distribution: min=1, max=248, mean=11.0

--- Analyzing with 2000 clusters ---
Computing metrics for 2000 clusters...
Computing within-cluster distances:   0%|          | 0/2000 [00:00<?, ?it/s]Computing within-cluster distances:   2%|▏         | 39/2000 [00:00<00:05, 382.35it/s]Computing within-cluster distances:   4%|▍         | 78/2000 [00:00<00:05, 370.46it/s]Computing within-cluster distances:   6%|▌         | 116/2000 [00:00<00:05, 360.88it/s]Computing within-cluster distances:   8%|▊         | 153/2000 [00:00<00:05, 339.64it/s]Computing within-cluster distances:   9%|▉         | 188/2000 [00:00<00:05, 324.73it/s]Computing within-cluster distances:  17%|█▋        | 347/2000 [00:00<00:02, 713.70it/s]Computing within-cluster distances:  23%|██▎       | 462/2000 [00:00<00:01, 839.86it/s]Computing within-cluster distances:  27%|██▋       | 549/2000 [00:00<00:01, 728.36it/s]Computing within-cluster distances:  31%|███▏      | 626/2000 [00:01<00:01, 717.71it/s]Computing within-cluster distances:  36%|███▌      | 716/2000 [00:01<00:01, 766.89it/s]Computing within-cluster distances:  40%|███▉      | 796/2000 [00:01<00:01, 724.47it/s]Computing within-cluster distances:  56%|█████▋    | 1129/2000 [00:01<00:00, 1433.15it/s]Computing within-cluster distances:  78%|███████▊  | 1567/2000 [00:01<00:00, 2256.85it/s]Computing within-cluster distances: 100%|██████████| 2000/2000 [00:01<00:00, 1316.11it/s]
Computing between-cluster distances for 1000 cluster pairs...
  0%|          | 0/1000 [00:00<?, ?it/s] 11%|█         | 108/1000 [00:00<00:00, 1077.32it/s] 22%|██▏       | 216/1000 [00:00<00:00, 1026.59it/s] 32%|███▏      | 321/1000 [00:00<00:00, 1028.69it/s] 44%|████▎     | 436/1000 [00:00<00:00, 1073.85it/s] 54%|█████▍    | 544/1000 [00:00<00:00, 1075.50it/s] 65%|██████▌   | 652/1000 [00:00<00:00, 1070.60it/s] 76%|███████▌  | 762/1000 [00:00<00:00, 1078.72it/s] 87%|████████▋ | 870/1000 [00:00<00:00, 1058.69it/s] 98%|█████████▊| 985/1000 [00:00<00:00, 1083.22it/s]100%|██████████| 1000/1000 [00:00<00:00, 1070.99it/s]

Clustering Summary (n_clusters=2000):
  Mean within-cluster distance: 0.2256
  Mean between-cluster distance: 0.3870
  Separation ratio: 1.7151
  Cluster size distribution: min=1, max=175, mean=5.5

============================================================
Total computation time: 21.19 minutes
============================================================
✓ Intermediate results saved to: /home/datadi/burns/aws/workloads/results/metrics/agglomerative_clustering/wanda/agglomerative_clustering_full_results.json

============================================================
FULL ANALYSIS: /home/datadi/burns/aws/workloads/data/wanda_unstructured/layer3-mlp.down_proj.pt
============================================================
Matrix shape: torch.Size([4096, 11008])
Computing pairwise Hamming distances for ALL 11008 features...
WARNING: This may take a long time and use significant memory...
Distance matrix computed (shape: (60582528,))
Computing hierarchical clustering linkage with method='ward'...
Linkage matrix computed

--- Analyzing with 10 clusters ---
Computing metrics for 10 clusters...
Computing within-cluster distances:   0%|          | 0/10 [00:00<?, ?it/s]Computing within-cluster distances: 100%|██████████| 10/10 [00:00<00:00, 95.93it/s]Computing within-cluster distances: 100%|██████████| 10/10 [00:00<00:00, 95.77it/s]
Computing between-cluster distances for 45 cluster pairs...
  0%|          | 0/45 [00:00<?, ?it/s] 18%|█▊        | 8/45 [00:00<00:00, 75.59it/s] 36%|███▌      | 16/45 [00:00<00:00, 63.01it/s] 51%|█████     | 23/45 [00:00<00:00, 61.27it/s] 69%|██████▉   | 31/45 [00:00<00:00, 64.86it/s] 84%|████████▍ | 38/45 [00:00<00:00, 61.58it/s]100%|██████████| 45/45 [00:00<00:00, 63.92it/s]100%|██████████| 45/45 [00:00<00:00, 63.83it/s]

Clustering Summary (n_clusters=10):
  Mean within-cluster distance: 0.4064
  Mean between-cluster distance: 0.4226
  Separation ratio: 1.0399
  Cluster size distribution: min=8, max=5621, mean=1100.8

--- Analyzing with 50 clusters ---
Computing metrics for 50 clusters...
Computing within-cluster distances:   0%|          | 0/50 [00:00<?, ?it/s]Computing within-cluster distances:  70%|███████   | 35/50 [00:00<00:00, 337.84it/s]Computing within-cluster distances: 100%|██████████| 50/50 [00:00<00:00, 219.87it/s]
Computing between-cluster distances for 1000 cluster pairs...
  0%|          | 0/1000 [00:00<?, ?it/s]  2%|▏         | 20/1000 [00:00<00:04, 199.34it/s]  4%|▍         | 40/1000 [00:00<00:05, 169.08it/s]  6%|▋         | 63/1000 [00:00<00:04, 194.36it/s]  8%|▊         | 83/1000 [00:00<00:05, 173.61it/s] 10%|█         | 102/1000 [00:00<00:05, 176.96it/s] 12%|█▏        | 121/1000 [00:00<00:04, 177.13it/s] 14%|█▍        | 145/1000 [00:00<00:04, 192.93it/s] 16%|█▋        | 165/1000 [00:00<00:04, 179.03it/s] 18%|█▊        | 185/1000 [00:01<00:04, 184.91it/s] 20%|██        | 204/1000 [00:01<00:04, 179.52it/s] 22%|██▏       | 223/1000 [00:01<00:04, 179.50it/s] 24%|██▍       | 243/1000 [00:01<00:04, 184.04it/s] 26%|██▌       | 262/1000 [00:01<00:04, 167.29it/s] 28%|██▊       | 283/1000 [00:01<00:04, 177.10it/s] 30%|███       | 302/1000 [00:01<00:03, 180.18it/s] 32%|███▏      | 323/1000 [00:01<00:03, 186.19it/s] 34%|███▍      | 342/1000 [00:01<00:03, 186.84it/s] 36%|███▌      | 362/1000 [00:01<00:03, 188.98it/s] 38%|███▊      | 381/1000 [00:02<00:03, 178.50it/s] 40%|████      | 400/1000 [00:02<00:03, 179.64it/s] 42%|████▏     | 420/1000 [00:02<00:03, 184.24it/s] 44%|████▍     | 439/1000 [00:02<00:03, 181.79it/s] 46%|████▌     | 460/1000 [00:02<00:02, 189.69it/s] 48%|████▊     | 480/1000 [00:02<00:02, 189.77it/s] 50%|█████     | 500/1000 [00:02<00:02, 190.82it/s] 52%|█████▏    | 520/1000 [00:02<00:02, 188.56it/s] 55%|█████▍    | 547/1000 [00:02<00:02, 207.42it/s] 57%|█████▋    | 568/1000 [00:03<00:02, 183.07it/s] 59%|█████▊    | 587/1000 [00:03<00:02, 176.39it/s] 60%|██████    | 605/1000 [00:03<00:02, 167.10it/s] 63%|██████▎   | 628/1000 [00:03<00:02, 182.21it/s] 65%|██████▍   | 647/1000 [00:03<00:01, 177.24it/s] 66%|██████▋   | 665/1000 [00:03<00:01, 176.94it/s] 69%|██████▉   | 688/1000 [00:03<00:01, 187.69it/s] 71%|███████   | 707/1000 [00:03<00:01, 182.69it/s] 73%|███████▎  | 731/1000 [00:03<00:01, 197.91it/s] 75%|███████▌  | 751/1000 [00:04<00:01, 174.35it/s] 77%|███████▋  | 770/1000 [00:04<00:01, 177.14it/s] 80%|███████▉  | 795/1000 [00:04<00:01, 196.72it/s] 82%|████████▏ | 816/1000 [00:04<00:00, 196.43it/s] 84%|████████▍ | 839/1000 [00:04<00:00, 202.64it/s] 86%|████████▌ | 860/1000 [00:04<00:00, 181.37it/s] 88%|████████▊ | 885/1000 [00:04<00:00, 191.62it/s] 90%|█████████ | 905/1000 [00:04<00:00, 184.03it/s] 92%|█████████▏| 924/1000 [00:05<00:00, 182.56it/s] 95%|█████████▍| 948/1000 [00:05<00:00, 193.80it/s] 97%|█████████▋| 970/1000 [00:05<00:00, 197.49it/s] 99%|█████████▉| 990/1000 [00:05<00:00, 179.11it/s]100%|██████████| 1000/1000 [00:05<00:00, 184.09it/s]

Clustering Summary (n_clusters=50):
  Mean within-cluster distance: 0.4107
  Mean between-cluster distance: 0.4352
  Separation ratio: 1.0595
  Cluster size distribution: min=2, max=3397, mean=220.2

--- Analyzing with 100 clusters ---
Computing metrics for 100 clusters...
Computing within-cluster distances:   0%|          | 0/100 [00:00<?, ?it/s]Computing within-cluster distances:  57%|█████▋    | 57/100 [00:00<00:00, 560.60it/s]Computing within-cluster distances: 100%|██████████| 100/100 [00:00<00:00, 298.24it/s]
Computing between-cluster distances for 1000 cluster pairs...
  0%|          | 0/1000 [00:00<?, ?it/s]  2%|▏         | 18/1000 [00:00<00:05, 179.38it/s]  4%|▍         | 44/1000 [00:00<00:04, 225.21it/s]  7%|▋         | 67/1000 [00:00<00:04, 223.12it/s] 10%|▉         | 97/1000 [00:00<00:03, 248.72it/s] 12%|█▏        | 122/1000 [00:00<00:03, 248.89it/s] 15%|█▌        | 150/1000 [00:00<00:03, 257.80it/s] 18%|█▊        | 176/1000 [00:00<00:03, 240.13it/s] 20%|██        | 201/1000 [00:00<00:03, 234.62it/s] 22%|██▎       | 225/1000 [00:00<00:03, 213.46it/s] 25%|██▌       | 250/1000 [00:01<00:03, 221.20it/s] 27%|██▋       | 273/1000 [00:01<00:03, 215.63it/s] 30%|██▉       | 295/1000 [00:01<00:03, 210.67it/s] 32%|███▏      | 317/1000 [00:01<00:03, 210.53it/s] 34%|███▍      | 343/1000 [00:01<00:02, 224.18it/s] 37%|███▋      | 370/1000 [00:01<00:02, 232.43it/s] 40%|███▉      | 397/1000 [00:01<00:02, 241.26it/s] 42%|████▎     | 425/1000 [00:01<00:02, 251.35it/s] 45%|████▌     | 454/1000 [00:01<00:02, 257.76it/s] 48%|████▊     | 480/1000 [00:02<00:02, 234.13it/s] 50%|█████     | 504/1000 [00:02<00:02, 209.03it/s] 53%|█████▎    | 526/1000 [00:02<00:02, 207.73it/s] 55%|█████▍    | 548/1000 [00:02<00:02, 205.01it/s] 58%|█████▊    | 577/1000 [00:02<00:01, 226.68it/s] 60%|██████    | 601/1000 [00:02<00:01, 227.12it/s] 63%|██████▎   | 629/1000 [00:02<00:01, 240.25it/s] 66%|██████▌   | 660/1000 [00:02<00:01, 254.76it/s] 69%|██████▊   | 686/1000 [00:02<00:01, 255.09it/s] 72%|███████▏  | 717/1000 [00:03<00:01, 270.12it/s] 74%|███████▍  | 745/1000 [00:03<00:01, 232.02it/s] 78%|███████▊  | 776/1000 [00:03<00:00, 247.71it/s] 80%|████████  | 804/1000 [00:03<00:00, 251.66it/s] 83%|████████▎ | 830/1000 [00:03<00:00, 235.40it/s] 86%|████████▌ | 858/1000 [00:03<00:00, 246.54it/s] 89%|████████▉ | 891/1000 [00:03<00:00, 263.91it/s] 93%|█████████▎| 928/1000 [00:03<00:00, 289.60it/s] 96%|█████████▌| 958/1000 [00:04<00:00, 256.39it/s] 98%|█████████▊| 985/1000 [00:04<00:00, 255.55it/s]100%|██████████| 1000/1000 [00:04<00:00, 238.50it/s]

Clustering Summary (n_clusters=100):
  Mean within-cluster distance: 0.3907
  Mean between-cluster distance: 0.4333
  Separation ratio: 1.1091
  Cluster size distribution: min=2, max=2315, mean=110.1

--- Analyzing with 500 clusters ---
Computing metrics for 500 clusters...
Computing within-cluster distances:   0%|          | 0/500 [00:00<?, ?it/s]Computing within-cluster distances:  39%|███▉      | 196/500 [00:00<00:00, 1940.80it/s]Computing within-cluster distances:  78%|███████▊  | 391/500 [00:00<00:00, 701.13it/s] Computing within-cluster distances: 100%|██████████| 500/500 [00:00<00:00, 477.90it/s]Computing within-cluster distances: 100%|██████████| 500/500 [00:00<00:00, 563.52it/s]
Computing between-cluster distances for 1000 cluster pairs...
  0%|          | 0/1000 [00:00<?, ?it/s]  4%|▍         | 44/1000 [00:00<00:02, 433.99it/s]  9%|▉         | 91/1000 [00:00<00:02, 452.56it/s] 14%|█▍        | 142/1000 [00:00<00:01, 476.27it/s] 19%|█▉        | 193/1000 [00:00<00:01, 487.92it/s] 24%|██▍       | 244/1000 [00:00<00:01, 493.10it/s] 29%|██▉       | 294/1000 [00:00<00:01, 477.03it/s] 34%|███▍      | 342/1000 [00:00<00:01, 459.73it/s] 39%|███▉      | 394/1000 [00:00<00:01, 477.02it/s] 44%|████▍     | 444/1000 [00:00<00:01, 481.94it/s] 49%|████▉     | 493/1000 [00:01<00:01, 462.37it/s] 54%|█████▍    | 543/1000 [00:01<00:00, 471.98it/s] 59%|█████▉    | 594/1000 [00:01<00:00, 481.87it/s] 64%|██████▍   | 643/1000 [00:01<00:00, 465.21it/s] 70%|██████▉   | 698/1000 [00:01<00:00, 489.08it/s] 75%|███████▍  | 748/1000 [00:01<00:00, 456.36it/s] 80%|███████▉  | 795/1000 [00:01<00:00, 451.34it/s] 84%|████████▍ | 841/1000 [00:01<00:00, 431.00it/s] 89%|████████▊ | 886/1000 [00:01<00:00, 432.38it/s] 94%|█████████▎| 937/1000 [00:02<00:00, 453.94it/s] 98%|█████████▊| 983/1000 [00:02<00:00, 452.81it/s]100%|██████████| 1000/1000 [00:02<00:00, 463.96it/s]

Clustering Summary (n_clusters=500):
  Mean within-cluster distance: 0.3444
  Mean between-cluster distance: 0.4147
  Separation ratio: 1.2040
  Cluster size distribution: min=1, max=560, mean=22.0

--- Analyzing with 1000 clusters ---
Computing metrics for 1000 clusters...
Computing within-cluster distances:   0%|          | 0/1000 [00:00<?, ?it/s]Computing within-cluster distances:  34%|███▍      | 338/1000 [00:00<00:00, 3373.21it/s]Computing within-cluster distances:  68%|██████▊   | 676/1000 [00:00<00:00, 1219.60it/s]Computing within-cluster distances:  86%|████████▋ | 865/1000 [00:01<00:00, 650.31it/s] Computing within-cluster distances:  98%|█████████▊| 983/1000 [00:01<00:00, 696.59it/s]Computing within-cluster distances: 100%|██████████| 1000/1000 [00:01<00:00, 812.41it/s]
Computing between-cluster distances for 1000 cluster pairs...
  0%|          | 0/1000 [00:00<?, ?it/s]  7%|▋         | 73/1000 [00:00<00:01, 725.68it/s] 15%|█▍        | 146/1000 [00:00<00:01, 663.26it/s] 22%|██▏       | 224/1000 [00:00<00:01, 713.25it/s] 30%|██▉       | 296/1000 [00:00<00:00, 711.34it/s] 37%|███▋      | 368/1000 [00:00<00:00, 705.55it/s] 44%|████▍     | 439/1000 [00:00<00:00, 699.80it/s] 51%|█████     | 510/1000 [00:00<00:00, 693.16it/s] 58%|█████▊    | 584/1000 [00:00<00:00, 706.53it/s] 66%|██████▌   | 655/1000 [00:00<00:00, 681.56it/s] 74%|███████▎  | 735/1000 [00:01<00:00, 715.22it/s] 81%|████████  | 807/1000 [00:01<00:00, 710.86it/s] 88%|████████▊ | 881/1000 [00:01<00:00, 716.77it/s] 95%|█████████▌| 953/1000 [00:01<00:00, 709.15it/s]100%|██████████| 1000/1000 [00:01<00:00, 709.30it/s]

Clustering Summary (n_clusters=1000):
  Mean within-cluster distance: 0.2967
  Mean between-cluster distance: 0.4035
  Separation ratio: 1.3601
  Cluster size distribution: min=1, max=295, mean=11.0

--- Analyzing with 2000 clusters ---
Computing metrics for 2000 clusters...
Computing within-cluster distances:   0%|          | 0/2000 [00:00<?, ?it/s]Computing within-cluster distances:  32%|███▏      | 631/2000 [00:00<00:00, 6306.28it/s]Computing within-cluster distances:  63%|██████▎   | 1262/2000 [00:00<00:00, 1315.39it/s]Computing within-cluster distances:  79%|███████▊  | 1572/2000 [00:01<00:00, 1104.31it/s]Computing within-cluster distances:  89%|████████▉ | 1777/2000 [00:01<00:00, 1215.29it/s]Computing within-cluster distances: 100%|██████████| 2000/2000 [00:01<00:00, 1420.69it/s]
Computing between-cluster distances for 1000 cluster pairs...
  0%|          | 0/1000 [00:00<?, ?it/s] 11%|█         | 108/1000 [00:00<00:00, 1074.79it/s] 22%|██▏       | 218/1000 [00:00<00:00, 1087.28it/s] 35%|███▍      | 346/1000 [00:00<00:00, 1174.20it/s] 47%|████▋     | 468/1000 [00:00<00:00, 1188.13it/s] 59%|█████▊    | 587/1000 [00:00<00:00, 1175.68it/s] 70%|███████   | 705/1000 [00:00<00:00, 1144.33it/s] 82%|████████▎ | 825/1000 [00:00<00:00, 1161.20it/s] 94%|█████████▍| 942/1000 [00:00<00:00, 1100.76it/s]100%|██████████| 1000/1000 [00:00<00:00, 1123.99it/s]

Clustering Summary (n_clusters=2000):
  Mean within-cluster distance: 0.2306
  Mean between-cluster distance: 0.3896
  Separation ratio: 1.6894
  Cluster size distribution: min=1, max=223, mean=5.5

============================================================
Total computation time: 17.88 minutes
============================================================
✓ Intermediate results saved to: /home/datadi/burns/aws/workloads/results/metrics/agglomerative_clustering/wanda/agglomerative_clustering_full_results.json

============================================================
✓ FULL Wanda analysis complete!
✓ Results saved to: /home/datadi/burns/aws/workloads/results/metrics/agglomerative_clustering/wanda/agglomerative_clustering_full_results.json
============================================================
