Found 31 up_proj matrices to analyze

============================================================
FULL ANALYSIS: /home/datadi/burns/aws/workloads/data/wanda_unstructured/layer0-mlp.up_proj.pt
============================================================
Matrix shape: torch.Size([11008, 4096])
Computing pairwise Hamming distances for ALL 4096 features...
Distance matrix computed (shape: (8386560,))
Computing hierarchical clustering linkage with method='ward'...
Linkage matrix computed

--- Analyzing with 10 clusters ---
Computing metrics for 10 clusters...
Computing within-cluster distances:   0%|          | 0/10 [00:00<?, ?it/s]Computing within-cluster distances:  70%|███████   | 7/10 [00:00<00:00, 60.15it/s]Computing within-cluster distances: 100%|██████████| 10/10 [00:00<00:00, 50.19it/s]
Computing between-cluster distances for 45 cluster pairs...
  0%|          | 0/45 [00:00<?, ?it/s]  9%|▉         | 4/45 [00:00<00:01, 34.82it/s] 18%|█▊        | 8/45 [00:00<00:01, 32.44it/s] 31%|███       | 14/45 [00:00<00:00, 39.44it/s] 40%|████      | 18/45 [00:00<00:00, 36.57it/s] 49%|████▉     | 22/45 [00:00<00:00, 34.19it/s] 64%|██████▍   | 29/45 [00:00<00:00, 41.18it/s] 76%|███████▌  | 34/45 [00:00<00:00, 39.07it/s] 84%|████████▍ | 38/45 [00:01<00:00, 37.20it/s] 98%|█████████▊| 44/45 [00:01<00:00, 42.21it/s]100%|██████████| 45/45 [00:01<00:00, 38.79it/s]

Clustering Summary (n_clusters=10):
  Mean within-cluster distance: 0.3939
  Mean between-cluster distance: 0.4092
  Separation ratio: 1.0389
  Cluster size distribution: min=10, max=1008, mean=409.6

--- Analyzing with 50 clusters ---
Computing metrics for 50 clusters...
Computing within-cluster distances:   0%|          | 0/50 [00:00<?, ?it/s]Computing within-cluster distances:  42%|████▏     | 21/50 [00:00<00:00, 197.80it/s]Computing within-cluster distances:  82%|████████▏ | 41/50 [00:00<00:00, 104.50it/s]Computing within-cluster distances: 100%|██████████| 50/50 [00:00<00:00, 98.65it/s] 
Computing between-cluster distances for 1000 cluster pairs...
  0%|          | 0/1000 [00:00<?, ?it/s]  1%|          | 8/1000 [00:00<00:12, 77.39it/s]  2%|▏         | 17/1000 [00:00<00:13, 75.06it/s]  2%|▎         | 25/1000 [00:00<00:12, 75.11it/s]  4%|▎         | 36/1000 [00:00<00:11, 84.18it/s]  4%|▍         | 45/1000 [00:00<00:11, 85.67it/s]  5%|▌         | 54/1000 [00:00<00:12, 77.35it/s]  6%|▌         | 62/1000 [00:00<00:13, 71.93it/s]  7%|▋         | 70/1000 [00:00<00:13, 69.64it/s]  8%|▊         | 79/1000 [00:01<00:12, 73.79it/s]  9%|▉         | 88/1000 [00:01<00:12, 74.22it/s] 10%|█         | 100/1000 [00:01<00:10, 82.49it/s] 11%|█         | 109/1000 [00:01<00:11, 75.72it/s] 12%|█▏        | 118/1000 [00:01<00:11, 77.03it/s] 13%|█▎        | 127/1000 [00:01<00:11, 77.14it/s] 14%|█▎        | 136/1000 [00:01<00:10, 80.30it/s] 14%|█▍        | 145/1000 [00:01<00:11, 77.09it/s] 15%|█▌        | 154/1000 [00:01<00:10, 79.25it/s] 16%|█▋        | 164/1000 [00:02<00:10, 81.07it/s] 17%|█▋        | 173/1000 [00:02<00:10, 78.90it/s] 18%|█▊        | 183/1000 [00:02<00:10, 81.16it/s] 19%|█▉        | 192/1000 [00:02<00:10, 73.73it/s] 20%|██        | 200/1000 [00:02<00:10, 75.19it/s] 21%|██        | 211/1000 [00:02<00:09, 80.88it/s] 22%|██▏       | 220/1000 [00:02<00:09, 82.27it/s] 23%|██▎       | 229/1000 [00:02<00:09, 80.92it/s] 24%|██▍       | 238/1000 [00:03<00:09, 82.78it/s] 25%|██▍       | 247/1000 [00:03<00:09, 82.72it/s] 26%|██▌       | 256/1000 [00:03<00:09, 78.46it/s] 27%|██▋       | 266/1000 [00:03<00:08, 82.22it/s] 28%|██▊       | 275/1000 [00:03<00:09, 78.46it/s] 28%|██▊       | 283/1000 [00:03<00:09, 76.31it/s] 29%|██▉       | 291/1000 [00:03<00:09, 73.83it/s] 30%|██▉       | 299/1000 [00:03<00:10, 67.28it/s] 31%|███       | 308/1000 [00:03<00:09, 72.76it/s] 32%|███▏      | 318/1000 [00:04<00:08, 77.30it/s] 33%|███▎      | 326/1000 [00:04<00:08, 75.98it/s] 33%|███▎      | 334/1000 [00:04<00:09, 73.56it/s] 34%|███▍      | 342/1000 [00:04<00:08, 74.77it/s] 35%|███▌      | 353/1000 [00:04<00:07, 82.10it/s] 36%|███▌      | 362/1000 [00:04<00:07, 82.17it/s] 37%|███▋      | 371/1000 [00:04<00:08, 75.83it/s] 38%|███▊      | 379/1000 [00:04<00:08, 72.18it/s] 39%|███▊      | 387/1000 [00:05<00:08, 69.94it/s] 40%|███▉      | 397/1000 [00:05<00:08, 73.91it/s] 40%|████      | 405/1000 [00:05<00:08, 69.38it/s] 41%|████▏     | 413/1000 [00:05<00:08, 68.52it/s] 42%|████▏     | 421/1000 [00:05<00:08, 69.86it/s] 43%|████▎     | 429/1000 [00:05<00:07, 71.86it/s] 44%|████▍     | 438/1000 [00:05<00:07, 74.94it/s] 45%|████▍     | 446/1000 [00:05<00:07, 76.03it/s] 45%|████▌     | 454/1000 [00:05<00:07, 75.43it/s] 46%|████▌     | 462/1000 [00:06<00:07, 76.49it/s] 47%|████▋     | 470/1000 [00:06<00:06, 76.58it/s] 48%|████▊     | 478/1000 [00:06<00:06, 75.54it/s] 49%|████▊     | 486/1000 [00:06<00:07, 69.86it/s] 50%|████▉     | 495/1000 [00:06<00:06, 72.39it/s] 50%|█████     | 504/1000 [00:06<00:06, 75.84it/s] 51%|█████     | 512/1000 [00:06<00:06, 74.51it/s] 52%|█████▏    | 520/1000 [00:06<00:07, 68.55it/s] 53%|█████▎    | 527/1000 [00:06<00:06, 68.08it/s] 53%|█████▎    | 534/1000 [00:07<00:06, 67.38it/s] 54%|█████▍    | 542/1000 [00:07<00:06, 70.70it/s] 55%|█████▌    | 551/1000 [00:07<00:06, 71.96it/s] 56%|█████▌    | 561/1000 [00:07<00:05, 78.77it/s] 57%|█████▋    | 569/1000 [00:07<00:05, 76.79it/s] 58%|█████▊    | 577/1000 [00:07<00:05, 75.87it/s] 58%|█████▊    | 585/1000 [00:07<00:05, 71.91it/s] 60%|█████▉    | 596/1000 [00:07<00:05, 80.18it/s] 60%|██████    | 605/1000 [00:07<00:04, 79.91it/s] 61%|██████▏   | 614/1000 [00:08<00:04, 79.17it/s] 62%|██████▏   | 624/1000 [00:08<00:04, 82.12it/s] 63%|██████▎   | 633/1000 [00:08<00:04, 75.24it/s] 64%|██████▍   | 643/1000 [00:08<00:04, 77.62it/s] 65%|██████▌   | 651/1000 [00:08<00:04, 75.02it/s] 66%|██████▌   | 661/1000 [00:08<00:04, 79.38it/s] 67%|██████▋   | 670/1000 [00:08<00:04, 78.22it/s] 68%|██████▊   | 681/1000 [00:08<00:03, 86.17it/s] 69%|██████▉   | 690/1000 [00:09<00:03, 85.68it/s] 70%|███████   | 700/1000 [00:09<00:03, 87.91it/s] 71%|███████   | 710/1000 [00:09<00:03, 89.90it/s] 72%|███████▏  | 720/1000 [00:09<00:03, 88.35it/s] 73%|███████▎  | 729/1000 [00:09<00:03, 76.79it/s] 74%|███████▍  | 740/1000 [00:09<00:03, 81.46it/s] 75%|███████▌  | 750/1000 [00:09<00:02, 83.88it/s] 76%|███████▌  | 760/1000 [00:09<00:02, 86.23it/s] 77%|███████▋  | 769/1000 [00:09<00:02, 84.07it/s] 78%|███████▊  | 778/1000 [00:10<00:02, 77.64it/s] 79%|███████▊  | 786/1000 [00:10<00:02, 73.32it/s] 79%|███████▉  | 794/1000 [00:10<00:02, 74.54it/s] 80%|████████  | 805/1000 [00:10<00:02, 82.48it/s] 81%|████████▏ | 814/1000 [00:10<00:02, 79.42it/s] 82%|████████▏ | 823/1000 [00:10<00:02, 77.96it/s] 83%|████████▎ | 832/1000 [00:10<00:02, 79.03it/s] 84%|████████▍ | 840/1000 [00:10<00:02, 78.54it/s] 85%|████████▍ | 848/1000 [00:11<00:02, 72.54it/s] 86%|████████▌ | 857/1000 [00:11<00:01, 73.77it/s] 87%|████████▋ | 867/1000 [00:11<00:01, 79.05it/s] 88%|████████▊ | 876/1000 [00:11<00:01, 78.07it/s] 88%|████████▊ | 884/1000 [00:11<00:01, 76.63it/s] 89%|████████▉ | 892/1000 [00:11<00:01, 72.16it/s] 90%|█████████ | 900/1000 [00:11<00:01, 73.47it/s] 91%|█████████ | 909/1000 [00:11<00:01, 77.35it/s] 92%|█████████▏| 917/1000 [00:11<00:01, 75.03it/s] 92%|█████████▎| 925/1000 [00:12<00:01, 69.98it/s] 93%|█████████▎| 933/1000 [00:12<00:00, 67.16it/s] 94%|█████████▍| 941/1000 [00:12<00:00, 69.62it/s] 95%|█████████▌| 950/1000 [00:12<00:00, 71.97it/s] 96%|█████████▌| 958/1000 [00:12<00:00, 70.18it/s] 97%|█████████▋| 966/1000 [00:12<00:00, 72.43it/s] 97%|█████████▋| 974/1000 [00:12<00:00, 69.80it/s] 98%|█████████▊| 982/1000 [00:12<00:00, 71.60it/s] 99%|█████████▉| 990/1000 [00:12<00:00, 69.00it/s]100%|█████████▉| 999/1000 [00:13<00:00, 73.74it/s]100%|██████████| 1000/1000 [00:13<00:00, 76.39it/s]

Clustering Summary (n_clusters=50):
  Mean within-cluster distance: 0.3966
  Mean between-cluster distance: 0.4152
  Separation ratio: 1.0469
  Cluster size distribution: min=2, max=335, mean=81.9

--- Analyzing with 100 clusters ---
Computing metrics for 100 clusters...
Computing within-cluster distances:   0%|          | 0/100 [00:00<?, ?it/s]Computing within-cluster distances:  34%|███▍      | 34/100 [00:00<00:00, 320.81it/s]Computing within-cluster distances:  67%|██████▋   | 67/100 [00:00<00:00, 161.30it/s]Computing within-cluster distances:  88%|████████▊ | 88/100 [00:00<00:00, 140.02it/s]Computing within-cluster distances: 100%|██████████| 100/100 [00:00<00:00, 142.29it/s]
Computing between-cluster distances for 1000 cluster pairs...
  0%|          | 0/1000 [00:00<?, ?it/s]  1%|          | 10/1000 [00:00<00:09, 99.38it/s]  2%|▏         | 20/1000 [00:00<00:10, 97.79it/s]  3%|▎         | 31/1000 [00:00<00:09, 100.75it/s]  4%|▍         | 42/1000 [00:00<00:09, 96.95it/s]   5%|▌         | 52/1000 [00:00<00:09, 97.66it/s]  6%|▌         | 62/1000 [00:00<00:09, 95.12it/s]  7%|▋         | 74/1000 [00:00<00:09, 100.23it/s]  8%|▊         | 85/1000 [00:00<00:09, 91.52it/s]  10%|▉         | 95/1000 [00:01<00:09, 91.12it/s] 11%|█         | 108/1000 [00:01<00:08, 100.04it/s] 12%|█▏        | 119/1000 [00:01<00:08, 100.39it/s] 13%|█▎        | 130/1000 [00:01<00:08, 98.22it/s]  14%|█▍        | 141/1000 [00:01<00:08, 100.07it/s] 15%|█▌        | 152/1000 [00:01<00:08, 102.38it/s] 16%|█▋        | 163/1000 [00:01<00:08, 97.95it/s]  17%|█▋        | 174/1000 [00:01<00:08, 100.47it/s] 18%|█▊        | 185/1000 [00:01<00:08, 94.82it/s]  20%|█▉        | 195/1000 [00:02<00:08, 93.93it/s] 21%|██        | 209/1000 [00:02<00:07, 104.59it/s] 22%|██▏       | 221/1000 [00:02<00:07, 108.85it/s] 23%|██▎       | 232/1000 [00:02<00:07, 107.62it/s] 24%|██▍       | 243/1000 [00:02<00:07, 100.07it/s] 25%|██▌       | 254/1000 [00:02<00:07, 97.26it/s]  26%|██▋       | 265/1000 [00:02<00:07, 98.40it/s] 28%|██▊       | 275/1000 [00:02<00:07, 98.10it/s] 28%|██▊       | 285/1000 [00:02<00:07, 94.64it/s] 30%|██▉       | 295/1000 [00:03<00:07, 93.91it/s] 30%|███       | 305/1000 [00:03<00:07, 95.14it/s] 32%|███▏      | 319/1000 [00:03<00:06, 105.85it/s] 33%|███▎      | 330/1000 [00:03<00:06, 101.55it/s] 34%|███▍      | 341/1000 [00:03<00:06, 102.74it/s] 35%|███▌      | 352/1000 [00:03<00:06, 101.98it/s] 37%|███▋      | 367/1000 [00:03<00:05, 112.57it/s] 38%|███▊      | 379/1000 [00:03<00:05, 105.99it/s] 39%|███▉      | 392/1000 [00:03<00:05, 110.49it/s] 41%|████      | 406/1000 [00:03<00:05, 118.44it/s] 42%|████▏     | 418/1000 [00:04<00:05, 112.27it/s] 43%|████▎     | 430/1000 [00:04<00:05, 109.05it/s] 44%|████▍     | 443/1000 [00:04<00:04, 114.63it/s] 46%|████▌     | 458/1000 [00:04<00:04, 123.18it/s] 47%|████▋     | 471/1000 [00:04<00:04, 121.24it/s] 48%|████▊     | 485/1000 [00:04<00:04, 124.87it/s] 50%|████▉     | 498/1000 [00:04<00:04, 119.14it/s] 51%|█████     | 512/1000 [00:04<00:03, 123.91it/s] 53%|█████▎    | 526/1000 [00:04<00:03, 124.53it/s] 54%|█████▍    | 539/1000 [00:05<00:04, 104.49it/s] 55%|█████▌    | 551/1000 [00:05<00:04, 104.00it/s] 56%|█████▌    | 562/1000 [00:05<00:04, 103.92it/s] 57%|█████▋    | 574/1000 [00:05<00:04, 105.80it/s] 59%|█████▊    | 587/1000 [00:05<00:03, 111.61it/s] 60%|█████▉    | 599/1000 [00:05<00:03, 107.88it/s] 61%|██████▏   | 613/1000 [00:05<00:03, 115.67it/s] 62%|██████▎   | 625/1000 [00:05<00:03, 110.05it/s] 64%|██████▎   | 637/1000 [00:06<00:03, 110.62it/s] 65%|██████▍   | 649/1000 [00:06<00:03, 105.32it/s] 66%|██████▌   | 660/1000 [00:06<00:03, 101.97it/s] 67%|██████▋   | 671/1000 [00:06<00:03, 100.42it/s] 68%|██████▊   | 683/1000 [00:06<00:03, 103.38it/s] 69%|██████▉   | 694/1000 [00:06<00:03, 94.53it/s]  70%|███████   | 704/1000 [00:06<00:03, 87.26it/s] 71%|███████▏  | 713/1000 [00:06<00:03, 86.04it/s] 72%|███████▎  | 725/1000 [00:07<00:03, 91.51it/s] 74%|███████▎  | 735/1000 [00:07<00:02, 90.40it/s] 75%|███████▍  | 748/1000 [00:07<00:02, 100.05it/s] 76%|███████▌  | 759/1000 [00:07<00:02, 100.53it/s] 77%|███████▋  | 770/1000 [00:07<00:02, 99.93it/s]  78%|███████▊  | 785/1000 [00:07<00:01, 113.03it/s] 80%|███████▉  | 798/1000 [00:07<00:01, 117.36it/s] 81%|████████  | 810/1000 [00:07<00:01, 110.64it/s] 82%|████████▏ | 822/1000 [00:07<00:01, 113.18it/s] 83%|████████▎ | 834/1000 [00:07<00:01, 114.32it/s] 85%|████████▍ | 846/1000 [00:08<00:01, 114.25it/s] 86%|████████▌ | 860/1000 [00:08<00:01, 120.39it/s] 87%|████████▋ | 873/1000 [00:08<00:01, 122.55it/s] 89%|████████▊ | 886/1000 [00:08<00:00, 123.82it/s] 90%|████████▉ | 899/1000 [00:08<00:00, 120.56it/s] 91%|█████████ | 912/1000 [00:08<00:00, 112.00it/s] 92%|█████████▎| 925/1000 [00:08<00:00, 116.10it/s] 94%|█████████▍| 941/1000 [00:08<00:00, 126.64it/s] 95%|█████████▌| 954/1000 [00:08<00:00, 124.24it/s] 97%|█████████▋| 967/1000 [00:09<00:00, 123.00it/s] 98%|█████████▊| 982/1000 [00:09<00:00, 128.58it/s]100%|█████████▉| 995/1000 [00:09<00:00, 116.73it/s]100%|██████████| 1000/1000 [00:09<00:00, 106.94it/s]

Clustering Summary (n_clusters=100):
  Mean within-cluster distance: 0.3670
  Mean between-cluster distance: 0.4117
  Separation ratio: 1.1218
  Cluster size distribution: min=1, max=335, mean=41.0

--- Analyzing with 500 clusters ---
Computing metrics for 500 clusters...
Computing within-cluster distances:   0%|          | 0/500 [00:00<?, ?it/s]Computing within-cluster distances:  16%|█▌        | 79/500 [00:00<00:00, 777.29it/s]Computing within-cluster distances:  31%|███▏      | 157/500 [00:00<00:00, 393.41it/s]Computing within-cluster distances:  45%|████▌     | 226/500 [00:00<00:00, 480.10it/s]Computing within-cluster distances:  59%|█████▉    | 297/500 [00:00<00:00, 546.43it/s]Computing within-cluster distances:  72%|███████▏  | 360/500 [00:00<00:00, 531.73it/s]Computing within-cluster distances:  84%|████████▍ | 419/500 [00:00<00:00, 503.92it/s]Computing within-cluster distances:  95%|█████████▌| 476/500 [00:00<00:00, 515.49it/s]Computing within-cluster distances: 100%|██████████| 500/500 [00:01<00:00, 478.67it/s]
Computing between-cluster distances for 1000 cluster pairs...
  0%|          | 0/1000 [00:00<?, ?it/s]  3%|▎         | 30/1000 [00:00<00:03, 295.35it/s]  7%|▋         | 66/1000 [00:00<00:02, 323.84it/s] 10%|▉         | 99/1000 [00:00<00:02, 320.21it/s] 14%|█▎        | 135/1000 [00:00<00:02, 332.97it/s] 17%|█▋        | 169/1000 [00:00<00:02, 314.72it/s] 20%|██        | 203/1000 [00:00<00:02, 315.29it/s] 24%|██▍       | 241/1000 [00:00<00:02, 331.88it/s] 28%|██▊       | 275/1000 [00:00<00:02, 319.10it/s] 31%|███       | 308/1000 [00:00<00:02, 299.97it/s] 34%|███▍      | 344/1000 [00:01<00:02, 316.77it/s] 38%|███▊      | 381/1000 [00:01<00:01, 330.96it/s] 42%|████▏     | 415/1000 [00:01<00:01, 320.69it/s] 45%|████▍     | 449/1000 [00:01<00:01, 324.38it/s] 49%|████▊     | 487/1000 [00:01<00:01, 338.83it/s] 52%|█████▏    | 522/1000 [00:01<00:01, 316.91it/s] 56%|█████▌    | 559/1000 [00:01<00:01, 330.25it/s] 59%|█████▉    | 593/1000 [00:01<00:01, 324.44it/s] 63%|██████▎   | 626/1000 [00:01<00:01, 319.76it/s] 66%|██████▌   | 661/1000 [00:02<00:01, 325.72it/s] 70%|██████▉   | 696/1000 [00:02<00:00, 329.99it/s] 73%|███████▎  | 730/1000 [00:02<00:00, 331.55it/s] 76%|███████▋  | 764/1000 [00:02<00:00, 311.61it/s] 80%|███████▉  | 796/1000 [00:02<00:00, 311.14it/s] 83%|████████▎ | 828/1000 [00:02<00:00, 304.86it/s] 86%|████████▌ | 859/1000 [00:02<00:00, 303.62it/s] 90%|█████████ | 900/1000 [00:02<00:00, 329.98it/s] 93%|█████████▎| 934/1000 [00:02<00:00, 317.28it/s] 97%|█████████▋| 969/1000 [00:03<00:00, 326.26it/s]100%|██████████| 1000/1000 [00:03<00:00, 320.80it/s]

Clustering Summary (n_clusters=500):
  Mean within-cluster distance: 0.3092
  Mean between-cluster distance: 0.3876
  Separation ratio: 1.2535
  Cluster size distribution: min=1, max=214, mean=8.2

--- Analyzing with 1000 clusters ---
Computing metrics for 1000 clusters...
Computing within-cluster distances:   0%|          | 0/1000 [00:00<?, ?it/s]Computing within-cluster distances:   9%|▉         | 90/1000 [00:00<00:01, 886.91it/s]Computing within-cluster distances:  18%|█▊        | 179/1000 [00:00<00:01, 540.93it/s]Computing within-cluster distances:  36%|███▌      | 359/1000 [00:00<00:00, 963.06it/s]Computing within-cluster distances:  56%|█████▌    | 559/1000 [00:00<00:00, 1297.73it/s]Computing within-cluster distances:  71%|███████   | 708/1000 [00:00<00:00, 1353.72it/s]Computing within-cluster distances:  86%|████████▌ | 856/1000 [00:00<00:00, 1352.58it/s]Computing within-cluster distances: 100%|██████████| 1000/1000 [00:00<00:00, 1164.55it/s]Computing within-cluster distances: 100%|██████████| 1000/1000 [00:00<00:00, 1130.37it/s]
Computing between-cluster distances for 1000 cluster pairs...
  0%|          | 0/1000 [00:00<?, ?it/s]  6%|▌         | 57/1000 [00:00<00:01, 569.14it/s] 12%|█▏        | 123/1000 [00:00<00:01, 619.50it/s] 19%|█▉        | 190/1000 [00:00<00:01, 641.09it/s] 26%|██▌       | 255/1000 [00:00<00:01, 613.28it/s] 32%|███▏      | 324/1000 [00:00<00:01, 634.95it/s] 40%|████      | 401/1000 [00:00<00:00, 678.75it/s] 47%|████▋     | 470/1000 [00:00<00:00, 645.30it/s] 54%|█████▍    | 544/1000 [00:00<00:00, 673.90it/s] 61%|██████    | 612/1000 [00:00<00:00, 660.99it/s] 68%|██████▊   | 680/1000 [00:01<00:00, 664.89it/s] 75%|███████▌  | 752/1000 [00:01<00:00, 680.87it/s] 82%|████████▏ | 821/1000 [00:01<00:00, 649.97it/s] 89%|████████▉ | 892/1000 [00:01<00:00, 665.88it/s] 96%|█████████▌| 959/1000 [00:01<00:00, 638.13it/s]100%|██████████| 1000/1000 [00:01<00:00, 650.32it/s]

Clustering Summary (n_clusters=1000):
  Mean within-cluster distance: 0.2559
  Mean between-cluster distance: 0.3822
  Separation ratio: 1.4936
  Cluster size distribution: min=1, max=156, mean=4.1

--- Analyzing with 2000 clusters ---
Computing metrics for 1999 clusters...
Computing within-cluster distances:   0%|          | 0/1999 [00:00<?, ?it/s]Computing within-cluster distances:   6%|▌         | 113/1999 [00:00<00:01, 1116.49it/s]Computing within-cluster distances:  12%|█▏        | 241/1999 [00:00<00:01, 1211.91it/s]Computing within-cluster distances:  26%|██▋       | 527/1999 [00:00<00:00, 1960.05it/s]Computing within-cluster distances:  50%|█████     | 1001/1999 [00:00<00:00, 3045.31it/s]Computing within-cluster distances:  68%|██████▊   | 1360/1999 [00:00<00:00, 3240.79it/s]Computing within-cluster distances:  86%|████████▌ | 1718/1999 [00:00<00:00, 3353.18it/s]Computing within-cluster distances: 100%|██████████| 1999/1999 [00:00<00:00, 2768.20it/s]
Computing between-cluster distances for 1000 cluster pairs...
  0%|          | 0/1000 [00:00<?, ?it/s] 14%|█▍        | 145/1000 [00:00<00:00, 1448.55it/s] 29%|██▉       | 290/1000 [00:00<00:00, 1370.03it/s] 44%|████▎     | 437/1000 [00:00<00:00, 1413.30it/s] 58%|█████▊    | 585/1000 [00:00<00:00, 1425.89it/s] 74%|███████▍  | 739/1000 [00:00<00:00, 1464.24it/s] 90%|████████▉ | 895/1000 [00:00<00:00, 1493.30it/s]100%|██████████| 1000/1000 [00:00<00:00, 1437.78it/s]

Clustering Summary (n_clusters=2000):
  Mean within-cluster distance: 0.1216
  Mean between-cluster distance: 0.3780
  Separation ratio: 3.1084
  Cluster size distribution: min=1, max=117, mean=2.0

============================================================
Total computation time: 9.18 minutes
============================================================
✓ Intermediate results saved to: /home/datadi/burns/aws/workloads/results/metrics/agglomerative_clustering/wanda/agglomerative_clustering_up_proj_full_results.json

============================================================
FULL ANALYSIS: /home/datadi/burns/aws/workloads/data/wanda_unstructured/layer2-mlp.up_proj.pt
============================================================
Matrix shape: torch.Size([11008, 4096])
Computing pairwise Hamming distances for ALL 4096 features...
Distance matrix computed (shape: (8386560,))
Computing hierarchical clustering linkage with method='ward'...
Linkage matrix computed

--- Analyzing with 10 clusters ---
Computing metrics for 10 clusters...
Computing within-cluster distances:   0%|          | 0/10 [00:00<?, ?it/s]Computing within-cluster distances: 100%|██████████| 10/10 [00:00<00:00, 75.42it/s]Computing within-cluster distances: 100%|██████████| 10/10 [00:00<00:00, 75.30it/s]
Computing between-cluster distances for 45 cluster pairs...
  0%|          | 0/45 [00:00<?, ?it/s] 16%|█▌        | 7/45 [00:00<00:00, 55.81it/s] 31%|███       | 14/45 [00:00<00:00, 57.12it/s] 49%|████▉     | 22/45 [00:00<00:00, 58.59it/s] 64%|██████▍   | 29/45 [00:00<00:00, 59.25it/s] 78%|███████▊  | 35/45 [00:00<00:00, 53.77it/s] 91%|█████████ | 41/45 [00:00<00:00, 53.73it/s]100%|██████████| 45/45 [00:00<00:00, 53.99it/s]

Clustering Summary (n_clusters=10):
  Mean within-cluster distance: 0.2694
  Mean between-cluster distance: 0.4164
  Separation ratio: 1.5457
  Cluster size distribution: min=1, max=1883, mean=409.6

--- Analyzing with 50 clusters ---
Computing metrics for 50 clusters...
Computing within-cluster distances:   0%|          | 0/50 [00:00<?, ?it/s]Computing within-cluster distances:  36%|███▌      | 18/50 [00:00<00:00, 164.23it/s]Computing within-cluster distances:  70%|███████   | 35/50 [00:00<00:00, 92.86it/s] Computing within-cluster distances:  92%|█████████▏| 46/50 [00:00<00:00, 77.15it/s]Computing within-cluster distances: 100%|██████████| 50/50 [00:00<00:00, 81.92it/s]
Computing between-cluster distances for 1000 cluster pairs...
  0%|          | 0/1000 [00:00<?, ?it/s]  1%|          | 6/1000 [00:00<00:17, 56.72it/s]  1%|▏         | 14/1000 [00:00<00:15, 64.04it/s]  2%|▏         | 21/1000 [00:00<00:16, 58.66it/s]  3%|▎         | 28/1000 [00:00<00:16, 60.28it/s]  4%|▎         | 35/1000 [00:00<00:15, 60.69it/s]  4%|▍         | 42/1000 [00:00<00:16, 58.37it/s]  5%|▍         | 48/1000 [00:00<00:16, 58.24it/s]  6%|▌         | 55/1000 [00:00<00:16, 58.68it/s]  6%|▌         | 62/1000 [00:01<00:15, 60.74it/s]  7%|▋         | 69/1000 [00:01<00:14, 62.29it/s]  8%|▊         | 76/1000 [00:01<00:15, 60.32it/s]  8%|▊         | 83/1000 [00:01<00:15, 60.09it/s]  9%|▉         | 90/1000 [00:01<00:14, 60.89it/s] 10%|▉         | 98/1000 [00:01<00:14, 63.60it/s] 10%|█         | 105/1000 [00:01<00:14, 61.10it/s] 11%|█         | 112/1000 [00:01<00:14, 63.14it/s] 12%|█▏        | 119/1000 [00:01<00:13, 63.09it/s] 13%|█▎        | 128/1000 [00:02<00:13, 66.94it/s] 14%|█▎        | 137/1000 [00:02<00:11, 72.65it/s] 14%|█▍        | 145/1000 [00:02<00:12, 66.67it/s] 15%|█▌        | 152/1000 [00:02<00:12, 66.29it/s] 16%|█▌        | 159/1000 [00:02<00:12, 67.25it/s] 17%|█▋        | 166/1000 [00:02<00:12, 64.66it/s] 18%|█▊        | 175/1000 [00:02<00:11, 70.57it/s] 18%|█▊        | 183/1000 [00:02<00:11, 68.74it/s] 19%|█▉        | 190/1000 [00:02<00:11, 68.68it/s] 20%|█▉        | 197/1000 [00:03<00:11, 68.01it/s] 20%|██        | 204/1000 [00:03<00:11, 67.42it/s] 21%|██        | 211/1000 [00:03<00:12, 62.86it/s] 22%|██▏       | 218/1000 [00:03<00:12, 61.65it/s] 22%|██▎       | 225/1000 [00:03<00:12, 60.80it/s] 23%|██▎       | 233/1000 [00:03<00:11, 64.71it/s] 24%|██▍       | 241/1000 [00:03<00:11, 68.85it/s] 25%|██▍       | 248/1000 [00:03<00:11, 63.21it/s] 26%|██▌       | 255/1000 [00:04<00:12, 60.43it/s] 26%|██▌       | 262/1000 [00:04<00:12, 60.43it/s] 27%|██▋       | 269/1000 [00:04<00:12, 58.96it/s] 28%|██▊       | 277/1000 [00:04<00:11, 63.08it/s] 28%|██▊       | 284/1000 [00:04<00:11, 63.70it/s] 29%|██▉       | 291/1000 [00:04<00:11, 61.68it/s] 30%|██▉       | 298/1000 [00:04<00:12, 58.45it/s] 31%|███       | 307/1000 [00:04<00:10, 65.19it/s] 32%|███▏      | 315/1000 [00:04<00:10, 65.47it/s] 32%|███▏      | 322/1000 [00:05<00:10, 66.46it/s] 33%|███▎      | 329/1000 [00:05<00:10, 64.96it/s] 34%|███▎      | 336/1000 [00:05<00:10, 64.59it/s] 34%|███▍      | 343/1000 [00:05<00:10, 62.09it/s] 35%|███▌      | 350/1000 [00:05<00:10, 63.72it/s] 36%|███▌      | 357/1000 [00:05<00:09, 65.13it/s] 36%|███▋      | 364/1000 [00:05<00:10, 60.20it/s] 37%|███▋      | 372/1000 [00:05<00:09, 63.52it/s] 38%|███▊      | 379/1000 [00:05<00:09, 62.70it/s] 39%|███▊      | 386/1000 [00:06<00:10, 60.44it/s] 39%|███▉      | 393/1000 [00:06<00:09, 61.74it/s] 40%|████      | 401/1000 [00:06<00:09, 65.46it/s] 41%|████      | 408/1000 [00:06<00:09, 61.83it/s] 42%|████▏     | 415/1000 [00:06<00:09, 62.97it/s] 42%|████▏     | 422/1000 [00:06<00:09, 62.51it/s] 43%|████▎     | 429/1000 [00:06<00:09, 60.01it/s] 44%|████▍     | 439/1000 [00:06<00:07, 70.43it/s] 45%|████▍     | 447/1000 [00:07<00:07, 70.23it/s] 46%|████▌     | 455/1000 [00:07<00:08, 67.17it/s] 46%|████▋     | 463/1000 [00:07<00:07, 67.20it/s] 47%|████▋     | 470/1000 [00:07<00:07, 67.02it/s] 48%|████▊     | 477/1000 [00:07<00:07, 65.43it/s] 48%|████▊     | 484/1000 [00:07<00:08, 63.79it/s] 49%|████▉     | 491/1000 [00:07<00:07, 63.65it/s] 50%|████▉     | 498/1000 [00:07<00:08, 61.53it/s] 50%|█████     | 505/1000 [00:07<00:08, 59.17it/s] 51%|█████▏    | 513/1000 [00:08<00:07, 64.04it/s] 52%|█████▏    | 520/1000 [00:08<00:07, 63.72it/s] 53%|█████▎    | 528/1000 [00:08<00:07, 66.54it/s] 54%|█████▎    | 535/1000 [00:08<00:07, 66.04it/s] 54%|█████▍    | 542/1000 [00:08<00:07, 63.38it/s] 55%|█████▍    | 549/1000 [00:08<00:06, 64.72it/s] 56%|█████▌    | 557/1000 [00:08<00:06, 67.32it/s] 56%|█████▋    | 565/1000 [00:08<00:06, 68.01it/s] 57%|█████▋    | 573/1000 [00:08<00:06, 70.37it/s] 58%|█████▊    | 581/1000 [00:09<00:05, 70.76it/s] 59%|█████▉    | 589/1000 [00:09<00:05, 71.23it/s] 60%|█████▉    | 598/1000 [00:09<00:05, 75.51it/s] 61%|██████    | 606/1000 [00:09<00:05, 74.64it/s] 61%|██████▏   | 614/1000 [00:09<00:05, 75.54it/s] 62%|██████▏   | 622/1000 [00:09<00:05, 68.52it/s] 63%|██████▎   | 629/1000 [00:09<00:05, 65.17it/s] 64%|██████▎   | 636/1000 [00:09<00:05, 65.94it/s] 65%|██████▍   | 646/1000 [00:09<00:04, 72.15it/s] 66%|██████▌   | 655/1000 [00:10<00:04, 74.90it/s] 66%|██████▋   | 663/1000 [00:10<00:04, 70.27it/s] 67%|██████▋   | 671/1000 [00:10<00:04, 67.42it/s] 68%|██████▊   | 679/1000 [00:10<00:04, 69.40it/s] 69%|██████▊   | 687/1000 [00:10<00:04, 71.69it/s] 70%|██████▉   | 695/1000 [00:10<00:04, 67.72it/s] 70%|███████   | 702/1000 [00:10<00:04, 67.49it/s] 71%|███████   | 710/1000 [00:10<00:04, 68.89it/s] 72%|███████▏  | 717/1000 [00:11<00:04, 66.64it/s] 72%|███████▏  | 724/1000 [00:11<00:04, 63.93it/s] 73%|███████▎  | 732/1000 [00:11<00:04, 66.39it/s] 74%|███████▍  | 739/1000 [00:11<00:04, 61.66it/s] 75%|███████▍  | 746/1000 [00:11<00:04, 59.13it/s] 75%|███████▌  | 754/1000 [00:11<00:03, 63.25it/s] 76%|███████▌  | 761/1000 [00:11<00:03, 61.90it/s] 77%|███████▋  | 768/1000 [00:11<00:03, 59.12it/s] 78%|███████▊  | 775/1000 [00:11<00:03, 61.29it/s] 78%|███████▊  | 784/1000 [00:12<00:03, 68.62it/s] 79%|███████▉  | 791/1000 [00:12<00:03, 64.32it/s] 80%|███████▉  | 798/1000 [00:12<00:03, 65.22it/s] 80%|████████  | 805/1000 [00:12<00:03, 63.83it/s] 81%|████████  | 812/1000 [00:12<00:03, 60.37it/s] 82%|████████▏ | 819/1000 [00:12<00:03, 59.35it/s] 83%|████████▎ | 827/1000 [00:12<00:02, 63.38it/s] 83%|████████▎ | 834/1000 [00:12<00:02, 62.51it/s] 84%|████████▍ | 841/1000 [00:13<00:02, 62.72it/s] 85%|████████▍ | 848/1000 [00:13<00:02, 62.05it/s] 86%|████████▌ | 855/1000 [00:13<00:02, 57.96it/s] 86%|████████▌ | 861/1000 [00:13<00:02, 58.29it/s] 87%|████████▋ | 868/1000 [00:13<00:02, 60.65it/s] 88%|████████▊ | 875/1000 [00:13<00:02, 58.38it/s] 88%|████████▊ | 883/1000 [00:13<00:01, 61.67it/s] 89%|████████▉ | 890/1000 [00:13<00:01, 63.74it/s] 90%|████████▉ | 897/1000 [00:13<00:01, 61.52it/s] 90%|█████████ | 904/1000 [00:14<00:01, 61.72it/s] 91%|█████████ | 911/1000 [00:14<00:01, 61.87it/s] 92%|█████████▏| 918/1000 [00:14<00:01, 58.52it/s] 92%|█████████▏| 924/1000 [00:14<00:01, 58.79it/s] 93%|█████████▎| 930/1000 [00:14<00:01, 56.80it/s] 94%|█████████▎| 937/1000 [00:14<00:01, 59.79it/s] 94%|█████████▍| 944/1000 [00:14<00:01, 55.70it/s] 95%|█████████▌| 950/1000 [00:14<00:00, 55.87it/s] 96%|█████████▌| 957/1000 [00:14<00:00, 56.03it/s] 96%|█████████▋| 963/1000 [00:15<00:00, 57.05it/s] 97%|█████████▋| 969/1000 [00:15<00:00, 54.97it/s] 98%|█████████▊| 975/1000 [00:15<00:00, 55.67it/s] 98%|█████████▊| 981/1000 [00:15<00:00, 55.71it/s] 99%|█████████▉| 988/1000 [00:15<00:00, 58.00it/s] 99%|█████████▉| 994/1000 [00:15<00:00, 57.47it/s]100%|██████████| 1000/1000 [00:15<00:00, 63.56it/s]

Clustering Summary (n_clusters=50):
  Mean within-cluster distance: 0.3536
  Mean between-cluster distance: 0.3884
  Separation ratio: 1.0983
  Cluster size distribution: min=1, max=245, mean=81.9

--- Analyzing with 100 clusters ---
Computing metrics for 100 clusters...
Computing within-cluster distances:   0%|          | 0/100 [00:00<?, ?it/s]Computing within-cluster distances:  24%|██▍       | 24/100 [00:00<00:00, 225.22it/s]Computing within-cluster distances:  47%|████▋     | 47/100 [00:00<00:00, 126.60it/s]Computing within-cluster distances:  62%|██████▏   | 62/100 [00:00<00:00, 115.21it/s]Computing within-cluster distances:  75%|███████▌  | 75/100 [00:00<00:00, 111.59it/s]Computing within-cluster distances:  87%|████████▋ | 87/100 [00:00<00:00, 102.83it/s]Computing within-cluster distances:  98%|█████████▊| 98/100 [00:00<00:00, 93.91it/s] Computing within-cluster distances: 100%|██████████| 100/100 [00:00<00:00, 108.01it/s]
Computing between-cluster distances for 1000 cluster pairs...
  0%|          | 0/1000 [00:00<?, ?it/s]  1%|          | 10/1000 [00:00<00:09, 99.14it/s]  2%|▏         | 20/1000 [00:00<00:10, 91.04it/s]  3%|▎         | 31/1000 [00:00<00:10, 94.65it/s]  4%|▍         | 41/1000 [00:00<00:10, 92.69it/s]  5%|▌         | 51/1000 [00:00<00:10, 94.61it/s]  6%|▋         | 63/1000 [00:00<00:09, 100.83it/s]  7%|▋         | 74/1000 [00:00<00:10, 91.00it/s]   9%|▊         | 86/1000 [00:00<00:09, 97.09it/s] 10%|▉         | 96/1000 [00:01<00:09, 95.52it/s] 11%|█         | 108/1000 [00:01<00:08, 101.21it/s] 12%|█▏        | 119/1000 [00:01<00:09, 96.72it/s]  13%|█▎        | 133/1000 [00:01<00:08, 107.21it/s] 14%|█▍        | 144/1000 [00:01<00:08, 104.27it/s] 16%|█▌        | 155/1000 [00:01<00:08, 102.81it/s] 17%|█▋        | 166/1000 [00:01<00:08, 98.50it/s]  18%|█▊        | 176/1000 [00:01<00:08, 94.32it/s] 19%|█▊        | 186/1000 [00:01<00:08, 95.33it/s] 20%|█▉        | 197/1000 [00:02<00:08, 98.03it/s] 21%|██        | 208/1000 [00:02<00:07, 99.77it/s] 22%|██▏       | 219/1000 [00:02<00:07, 100.47it/s] 23%|██▎       | 230/1000 [00:02<00:07, 100.38it/s] 24%|██▍       | 241/1000 [00:02<00:07, 102.77it/s] 25%|██▌       | 252/1000 [00:02<00:07, 101.41it/s] 26%|██▋       | 263/1000 [00:02<00:07, 101.81it/s] 28%|██▊       | 275/1000 [00:02<00:06, 104.75it/s] 29%|██▉       | 288/1000 [00:02<00:06, 110.47it/s] 30%|███       | 300/1000 [00:02<00:06, 104.76it/s] 31%|███       | 311/1000 [00:03<00:06, 102.44it/s] 32%|███▏      | 322/1000 [00:03<00:07, 96.73it/s]  33%|███▎      | 333/1000 [00:03<00:06, 99.14it/s] 34%|███▍      | 344/1000 [00:03<00:06, 100.67it/s] 36%|███▌      | 355/1000 [00:03<00:06, 97.07it/s]  36%|███▋      | 365/1000 [00:03<00:06, 95.32it/s] 38%|███▊      | 375/1000 [00:03<00:06, 93.90it/s] 38%|███▊      | 385/1000 [00:03<00:06, 94.83it/s] 40%|███▉      | 395/1000 [00:04<00:06, 93.39it/s] 41%|████      | 406/1000 [00:04<00:06, 94.48it/s] 42%|████▏     | 416/1000 [00:04<00:06, 93.03it/s] 43%|████▎     | 426/1000 [00:04<00:06, 92.76it/s] 44%|████▎     | 436/1000 [00:04<00:06, 92.30it/s] 45%|████▌     | 450/1000 [00:04<00:05, 103.59it/s] 46%|████▌     | 461/1000 [00:04<00:05, 103.74it/s] 47%|████▋     | 472/1000 [00:04<00:05, 97.43it/s]  48%|████▊     | 484/1000 [00:04<00:05, 102.97it/s] 50%|████▉     | 496/1000 [00:04<00:04, 107.07it/s] 51%|█████     | 507/1000 [00:05<00:04, 102.53it/s] 52%|█████▏    | 518/1000 [00:05<00:04, 104.34it/s] 53%|█████▎    | 529/1000 [00:05<00:04, 103.11it/s] 54%|█████▍    | 540/1000 [00:05<00:04, 101.93it/s] 55%|█████▌    | 552/1000 [00:05<00:04, 102.27it/s] 56%|█████▋    | 563/1000 [00:05<00:04, 97.79it/s]  57%|█████▋    | 573/1000 [00:05<00:04, 98.23it/s] 58%|█████▊    | 583/1000 [00:05<00:04, 98.46it/s] 60%|█████▉    | 595/1000 [00:05<00:03, 101.49it/s] 61%|██████    | 606/1000 [00:06<00:04, 97.89it/s]  62%|██████▏   | 618/1000 [00:06<00:03, 102.42it/s] 63%|██████▎   | 630/1000 [00:06<00:03, 105.29it/s] 64%|██████▍   | 641/1000 [00:06<00:03, 102.78it/s] 65%|██████▌   | 652/1000 [00:06<00:03, 99.08it/s]  66%|██████▋   | 663/1000 [00:06<00:03, 99.89it/s] 67%|██████▋   | 674/1000 [00:06<00:03, 99.32it/s] 69%|██████▊   | 686/1000 [00:06<00:03, 103.52it/s] 70%|██████▉   | 697/1000 [00:07<00:03, 100.67it/s] 71%|███████   | 708/1000 [00:07<00:02, 102.97it/s] 72%|███████▏  | 719/1000 [00:07<00:02, 101.58it/s] 73%|███████▎  | 730/1000 [00:07<00:02, 99.13it/s]  74%|███████▍  | 740/1000 [00:07<00:02, 94.83it/s] 75%|███████▌  | 750/1000 [00:07<00:02, 95.55it/s] 76%|███████▌  | 761/1000 [00:07<00:02, 98.56it/s] 77%|███████▋  | 773/1000 [00:07<00:02, 101.13it/s] 78%|███████▊  | 784/1000 [00:07<00:02, 96.70it/s]  80%|███████▉  | 795/1000 [00:07<00:02, 98.90it/s] 81%|████████  | 807/1000 [00:08<00:01, 102.66it/s] 82%|████████▏ | 818/1000 [00:08<00:01, 103.79it/s] 83%|████████▎ | 829/1000 [00:08<00:01, 101.82it/s] 84%|████████▍ | 840/1000 [00:08<00:01, 98.69it/s]  85%|████████▌ | 850/1000 [00:08<00:01, 98.71it/s] 86%|████████▌ | 860/1000 [00:08<00:01, 96.29it/s] 87%|████████▋ | 870/1000 [00:08<00:01, 93.06it/s] 88%|████████▊ | 880/1000 [00:08<00:01, 93.02it/s] 89%|████████▉ | 890/1000 [00:08<00:01, 90.30it/s] 90%|█████████ | 900/1000 [00:09<00:01, 84.79it/s] 91%|█████████ | 910/1000 [00:09<00:01, 85.90it/s] 92%|█████████▏| 919/1000 [00:09<00:00, 83.17it/s] 93%|█████████▎| 929/1000 [00:09<00:00, 86.91it/s] 94%|█████████▍| 938/1000 [00:09<00:00, 85.08it/s] 95%|█████████▍| 947/1000 [00:09<00:00, 80.54it/s] 96%|█████████▌| 956/1000 [00:09<00:00, 82.72it/s] 96%|█████████▋| 965/1000 [00:09<00:00, 79.43it/s] 97%|█████████▋| 974/1000 [00:10<00:00, 81.13it/s] 98%|█████████▊| 983/1000 [00:10<00:00, 82.87it/s] 99%|█████████▉| 993/1000 [00:10<00:00, 84.00it/s]100%|██████████| 1000/1000 [00:10<00:00, 96.92it/s]

Clustering Summary (n_clusters=100):
  Mean within-cluster distance: 0.3442
  Mean between-cluster distance: 0.3849
  Separation ratio: 1.1184
  Cluster size distribution: min=1, max=119, mean=41.0

--- Analyzing with 500 clusters ---
Computing metrics for 500 clusters...
Computing within-cluster distances:   0%|          | 0/500 [00:00<?, ?it/s]Computing within-cluster distances:  14%|█▍        | 70/500 [00:00<00:00, 688.06it/s]Computing within-cluster distances:  28%|██▊       | 139/500 [00:00<00:00, 500.79it/s]Computing within-cluster distances:  39%|███▊      | 193/500 [00:00<00:00, 443.37it/s]Computing within-cluster distances:  48%|████▊     | 240/500 [00:00<00:00, 442.89it/s]Computing within-cluster distances:  57%|█████▋    | 286/500 [00:00<00:00, 421.05it/s]Computing within-cluster distances:  66%|██████▌   | 329/500 [00:00<00:00, 401.03it/s]Computing within-cluster distances:  74%|███████▍  | 370/500 [00:00<00:00, 373.88it/s]Computing within-cluster distances:  82%|████████▏ | 408/500 [00:01<00:00, 353.86it/s]Computing within-cluster distances:  89%|████████▉ | 444/500 [00:01<00:00, 348.27it/s]Computing within-cluster distances:  96%|█████████▌| 479/500 [00:01<00:00, 347.33it/s]Computing within-cluster distances: 100%|██████████| 500/500 [00:01<00:00, 397.94it/s]
Computing between-cluster distances for 1000 cluster pairs...
  0%|          | 0/1000 [00:00<?, ?it/s]  2%|▏         | 24/1000 [00:00<00:04, 239.58it/s]  5%|▍         | 49/1000 [00:00<00:03, 243.08it/s]  7%|▋         | 74/1000 [00:00<00:03, 241.85it/s] 10%|█         | 100/1000 [00:00<00:03, 248.34it/s] 12%|█▎        | 125/1000 [00:00<00:03, 244.22it/s] 15%|█▌        | 150/1000 [00:00<00:03, 236.71it/s] 17%|█▋        | 174/1000 [00:00<00:03, 233.53it/s] 20%|█▉        | 199/1000 [00:00<00:03, 235.16it/s] 22%|██▏       | 223/1000 [00:00<00:03, 236.06it/s] 25%|██▍       | 247/1000 [00:01<00:03, 234.96it/s] 27%|██▋       | 272/1000 [00:01<00:03, 238.43it/s] 30%|██▉       | 298/1000 [00:01<00:02, 241.80it/s] 32%|███▏      | 323/1000 [00:01<00:02, 236.01it/s] 35%|███▍      | 347/1000 [00:01<00:02, 236.24it/s] 37%|███▋      | 372/1000 [00:01<00:02, 237.96it/s] 40%|████      | 401/1000 [00:01<00:02, 250.83it/s] 43%|████▎     | 428/1000 [00:01<00:02, 254.88it/s] 45%|████▌     | 454/1000 [00:01<00:02, 250.79it/s] 48%|████▊     | 480/1000 [00:01<00:02, 245.83it/s] 50%|█████     | 505/1000 [00:02<00:02, 245.46it/s] 53%|█████▎    | 532/1000 [00:02<00:01, 250.10it/s] 56%|█████▌    | 558/1000 [00:02<00:01, 245.91it/s] 58%|█████▊    | 583/1000 [00:02<00:01, 244.56it/s] 61%|██████    | 609/1000 [00:02<00:01, 248.33it/s] 63%|██████▎   | 634/1000 [00:02<00:01, 248.53it/s] 66%|██████▌   | 661/1000 [00:02<00:01, 253.80it/s] 69%|██████▊   | 687/1000 [00:02<00:01, 253.83it/s] 71%|███████▏  | 714/1000 [00:02<00:01, 256.98it/s] 74%|███████▍  | 740/1000 [00:03<00:01, 251.25it/s] 77%|███████▋  | 768/1000 [00:03<00:00, 259.24it/s] 79%|███████▉  | 794/1000 [00:03<00:00, 253.07it/s] 82%|████████▏ | 822/1000 [00:03<00:00, 259.61it/s] 85%|████████▍ | 849/1000 [00:03<00:00, 255.63it/s] 88%|████████▊ | 875/1000 [00:03<00:00, 250.66it/s] 90%|█████████ | 901/1000 [00:03<00:00, 247.64it/s] 93%|█████████▎| 926/1000 [00:03<00:00, 243.08it/s] 95%|█████████▌| 951/1000 [00:03<00:00, 241.83it/s] 98%|█████████▊| 977/1000 [00:03<00:00, 245.54it/s]100%|██████████| 1000/1000 [00:04<00:00, 246.51it/s]

Clustering Summary (n_clusters=500):
  Mean within-cluster distance: 0.3533
  Mean between-cluster distance: 0.3764
  Separation ratio: 1.0654
  Cluster size distribution: min=1, max=46, mean=8.2

--- Analyzing with 1000 clusters ---
Computing metrics for 1000 clusters...
Computing within-cluster distances:   0%|          | 0/1000 [00:00<?, ?it/s]Computing within-cluster distances:  15%|█▌        | 152/1000 [00:00<00:00, 1516.20it/s]Computing within-cluster distances:  30%|███       | 304/1000 [00:00<00:00, 1318.26it/s]Computing within-cluster distances:  44%|████▍     | 438/1000 [00:00<00:00, 1262.00it/s]Computing within-cluster distances:  57%|█████▋    | 566/1000 [00:00<00:00, 1238.36it/s]Computing within-cluster distances:  69%|██████▉   | 691/1000 [00:00<00:00, 1109.77it/s]Computing within-cluster distances:  80%|████████  | 804/1000 [00:00<00:00, 1068.93it/s]Computing within-cluster distances:  91%|█████████ | 912/1000 [00:00<00:00, 1056.07it/s]Computing within-cluster distances: 100%|██████████| 1000/1000 [00:00<00:00, 1130.81it/s]
Computing between-cluster distances for 1000 cluster pairs...
  0%|          | 0/1000 [00:00<?, ?it/s]  6%|▌         | 59/1000 [00:00<00:01, 586.10it/s] 12%|█▏        | 118/1000 [00:00<00:01, 537.09it/s] 18%|█▊        | 178/1000 [00:00<00:01, 562.41it/s] 24%|██▎       | 235/1000 [00:00<00:01, 563.82it/s] 29%|██▉       | 292/1000 [00:00<00:01, 541.85it/s] 35%|███▍      | 347/1000 [00:00<00:01, 533.33it/s] 40%|████      | 401/1000 [00:00<00:01, 530.96it/s] 46%|████▌     | 455/1000 [00:00<00:01, 524.69it/s] 51%|█████     | 510/1000 [00:00<00:00, 531.32it/s] 56%|█████▋    | 564/1000 [00:01<00:00, 532.17it/s] 62%|██████▏   | 618/1000 [00:01<00:00, 515.83it/s] 67%|██████▋   | 670/1000 [00:01<00:00, 514.88it/s] 73%|███████▎  | 729/1000 [00:01<00:00, 535.58it/s] 78%|███████▊  | 785/1000 [00:01<00:00, 538.66it/s] 84%|████████▍ | 839/1000 [00:01<00:00, 538.40it/s] 89%|████████▉ | 893/1000 [00:01<00:00, 523.92it/s] 95%|█████████▍| 947/1000 [00:01<00:00, 527.75it/s]100%|██████████| 1000/1000 [00:01<00:00, 533.60it/s]

Clustering Summary (n_clusters=1000):
  Mean within-cluster distance: 0.3164
  Mean between-cluster distance: 0.3751
  Separation ratio: 1.1853
  Cluster size distribution: min=1, max=26, mean=4.1

--- Analyzing with 2000 clusters ---
Computing metrics for 2000 clusters...
Computing within-cluster distances:   0%|          | 0/2000 [00:00<?, ?it/s]Computing within-cluster distances:  16%|█▋        | 325/2000 [00:00<00:00, 3236.48it/s]Computing within-cluster distances:  32%|███▏      | 649/2000 [00:00<00:00, 3116.85it/s]Computing within-cluster distances:  48%|████▊     | 961/2000 [00:00<00:00, 3009.69it/s]Computing within-cluster distances:  63%|██████▎   | 1263/2000 [00:00<00:00, 2925.47it/s]Computing within-cluster distances:  78%|███████▊  | 1556/2000 [00:00<00:00, 2774.78it/s]Computing within-cluster distances:  92%|█████████▏| 1835/2000 [00:00<00:00, 2657.65it/s]Computing within-cluster distances: 100%|██████████| 2000/2000 [00:00<00:00, 2800.66it/s]
Computing between-cluster distances for 1000 cluster pairs...
  0%|          | 0/1000 [00:00<?, ?it/s] 12%|█▏        | 121/1000 [00:00<00:00, 1205.80it/s] 24%|██▍       | 242/1000 [00:00<00:00, 1206.38it/s] 38%|███▊      | 375/1000 [00:00<00:00, 1256.41it/s] 50%|█████     | 501/1000 [00:00<00:00, 1251.59it/s] 63%|██████▎   | 628/1000 [00:00<00:00, 1253.30it/s] 75%|███████▌  | 754/1000 [00:00<00:00, 1253.20it/s] 88%|████████▊ | 884/1000 [00:00<00:00, 1265.22it/s]100%|██████████| 1000/1000 [00:00<00:00, 1247.68it/s]

Clustering Summary (n_clusters=2000):
  Mean within-cluster distance: 0.1646
  Mean between-cluster distance: 0.3749
  Separation ratio: 2.2775
  Cluster size distribution: min=1, max=19, mean=2.0

============================================================
Total computation time: 9.57 minutes
============================================================
✓ Intermediate results saved to: /home/datadi/burns/aws/workloads/results/metrics/agglomerative_clustering/wanda/agglomerative_clustering_up_proj_full_results.json

============================================================
FULL ANALYSIS: /home/datadi/burns/aws/workloads/data/wanda_unstructured/layer3-mlp.up_proj.pt
============================================================
Matrix shape: torch.Size([11008, 4096])
Computing pairwise Hamming distances for ALL 4096 features...
Distance matrix computed (shape: (8386560,))
Computing hierarchical clustering linkage with method='ward'...
Linkage matrix computed

--- Analyzing with 10 clusters ---
Computing metrics for 10 clusters...
Computing within-cluster distances:   0%|          | 0/10 [00:00<?, ?it/s]Computing within-cluster distances:  50%|█████     | 5/10 [00:00<00:00, 39.80it/s]Computing within-cluster distances: 100%|██████████| 10/10 [00:00<00:00, 73.68it/s]
Computing between-cluster distances for 45 cluster pairs...
  0%|          | 0/45 [00:00<?, ?it/s] 11%|█         | 5/45 [00:00<00:00, 48.02it/s] 24%|██▍       | 11/45 [00:00<00:00, 46.78it/s] 40%|████      | 18/45 [00:00<00:00, 52.83it/s] 53%|█████▎    | 24/45 [00:00<00:00, 48.27it/s] 64%|██████▍   | 29/45 [00:00<00:00, 48.24it/s] 80%|████████  | 36/45 [00:00<00:00, 54.18it/s] 93%|█████████▎| 42/45 [00:00<00:00, 49.89it/s]100%|██████████| 45/45 [00:00<00:00, 52.56it/s]

Clustering Summary (n_clusters=10):
  Mean within-cluster distance: 0.3918
  Mean between-cluster distance: 0.4071
  Separation ratio: 1.0391
  Cluster size distribution: min=3, max=2028, mean=409.6

--- Analyzing with 50 clusters ---
Computing metrics for 50 clusters...
Computing within-cluster distances:   0%|          | 0/50 [00:00<?, ?it/s]Computing within-cluster distances:  18%|█▊        | 9/50 [00:00<00:00, 84.85it/s]Computing within-cluster distances:  36%|███▌      | 18/50 [00:00<00:00, 81.50it/s]Computing within-cluster distances:  56%|█████▌    | 28/50 [00:00<00:00, 84.93it/s]Computing within-cluster distances:  76%|███████▌  | 38/50 [00:00<00:00, 88.52it/s]Computing within-cluster distances: 100%|██████████| 50/50 [00:00<00:00, 105.04it/s]
Computing between-cluster distances for 1000 cluster pairs...
  0%|          | 0/1000 [00:00<?, ?it/s]  1%|          | 7/1000 [00:00<00:15, 66.15it/s]  1%|▏         | 14/1000 [00:00<00:15, 65.01it/s]  2%|▎         | 25/1000 [00:00<00:11, 83.67it/s]  3%|▎         | 34/1000 [00:00<00:12, 74.89it/s]  4%|▍         | 44/1000 [00:00<00:12, 78.40it/s]  5%|▌         | 52/1000 [00:00<00:12, 78.43it/s]  6%|▌         | 61/1000 [00:00<00:11, 79.98it/s]  7%|▋         | 70/1000 [00:00<00:11, 79.39it/s]  8%|▊         | 78/1000 [00:01<00:12, 76.42it/s]  9%|▊         | 87/1000 [00:01<00:11, 78.35it/s] 10%|▉         | 95/1000 [00:01<00:12, 74.75it/s] 10%|█         | 104/1000 [00:01<00:11, 78.86it/s] 11%|█         | 112/1000 [00:01<00:11, 78.69it/s] 12%|█▏        | 120/1000 [00:01<00:11, 75.32it/s] 13%|█▎        | 128/1000 [00:01<00:11, 74.77it/s] 14%|█▎        | 136/1000 [00:01<00:11, 72.96it/s] 14%|█▍        | 144/1000 [00:01<00:11, 72.21it/s] 15%|█▌        | 152/1000 [00:02<00:11, 74.14it/s] 16%|█▌        | 160/1000 [00:02<00:11, 75.67it/s] 17%|█▋        | 168/1000 [00:02<00:11, 71.66it/s] 18%|█▊        | 176/1000 [00:02<00:11, 71.35it/s] 19%|█▊        | 186/1000 [00:02<00:10, 78.86it/s] 19%|█▉        | 194/1000 [00:02<00:10, 74.64it/s] 20%|██        | 202/1000 [00:02<00:10, 75.60it/s] 21%|██        | 212/1000 [00:02<00:09, 79.22it/s] 22%|██▏       | 220/1000 [00:02<00:10, 77.21it/s] 23%|██▎       | 230/1000 [00:02<00:09, 82.41it/s] 24%|██▍       | 239/1000 [00:03<00:09, 78.70it/s] 25%|██▍       | 247/1000 [00:03<00:09, 75.98it/s] 26%|██▌       | 257/1000 [00:03<00:09, 80.68it/s] 27%|██▋       | 266/1000 [00:03<00:08, 82.44it/s] 28%|██▊       | 275/1000 [00:03<00:08, 82.71it/s] 28%|██▊       | 284/1000 [00:03<00:09, 78.54it/s] 29%|██▉       | 294/1000 [00:03<00:08, 84.28it/s] 30%|███       | 303/1000 [00:03<00:08, 84.63it/s] 31%|███       | 312/1000 [00:04<00:08, 83.78it/s] 32%|███▏      | 322/1000 [00:04<00:07, 86.67it/s] 33%|███▎      | 333/1000 [00:04<00:07, 90.90it/s] 34%|███▍      | 343/1000 [00:04<00:07, 85.42it/s] 35%|███▌      | 352/1000 [00:04<00:07, 84.72it/s] 36%|███▌      | 362/1000 [00:04<00:07, 87.56it/s] 37%|███▋      | 371/1000 [00:04<00:07, 80.68it/s] 38%|███▊      | 381/1000 [00:04<00:07, 85.73it/s] 39%|███▉      | 390/1000 [00:04<00:07, 77.99it/s] 40%|███▉      | 399/1000 [00:05<00:07, 79.43it/s] 41%|████      | 408/1000 [00:05<00:07, 74.82it/s] 42%|████▏     | 416/1000 [00:05<00:07, 74.73it/s] 42%|████▎     | 425/1000 [00:05<00:07, 77.66it/s] 43%|████▎     | 433/1000 [00:05<00:07, 77.24it/s] 44%|████▍     | 442/1000 [00:05<00:06, 80.62it/s] 45%|████▌     | 451/1000 [00:05<00:07, 75.93it/s] 46%|████▌     | 459/1000 [00:05<00:07, 75.14it/s] 47%|████▋     | 469/1000 [00:05<00:06, 80.59it/s] 48%|████▊     | 478/1000 [00:06<00:06, 78.67it/s] 49%|████▊     | 486/1000 [00:06<00:06, 76.06it/s] 50%|████▉     | 495/1000 [00:06<00:06, 77.61it/s] 50%|█████     | 504/1000 [00:06<00:06, 80.93it/s] 51%|█████▏    | 513/1000 [00:06<00:06, 74.79it/s] 52%|█████▏    | 521/1000 [00:06<00:06, 72.37it/s] 53%|█████▎    | 529/1000 [00:06<00:06, 71.42it/s] 54%|█████▎    | 537/1000 [00:06<00:06, 70.45it/s] 55%|█████▍    | 547/1000 [00:06<00:05, 77.38it/s] 56%|█████▌    | 555/1000 [00:07<00:06, 71.41it/s] 56%|█████▋    | 564/1000 [00:07<00:05, 74.83it/s] 57%|█████▋    | 572/1000 [00:07<00:05, 73.71it/s] 58%|█████▊    | 582/1000 [00:07<00:05, 77.05it/s] 59%|█████▉    | 590/1000 [00:07<00:05, 75.77it/s] 60%|█████▉    | 598/1000 [00:07<00:05, 76.69it/s] 61%|██████    | 606/1000 [00:07<00:05, 70.54it/s] 61%|██████▏   | 614/1000 [00:07<00:05, 67.92it/s] 62%|██████▏   | 621/1000 [00:08<00:05, 68.26it/s] 63%|██████▎   | 630/1000 [00:08<00:05, 72.15it/s] 64%|██████▍   | 638/1000 [00:08<00:05, 69.51it/s] 65%|██████▍   | 646/1000 [00:08<00:05, 67.62it/s] 66%|██████▌   | 655/1000 [00:08<00:04, 71.42it/s] 66%|██████▋   | 663/1000 [00:08<00:04, 72.30it/s] 67%|██████▋   | 671/1000 [00:08<00:04, 73.08it/s] 68%|██████▊   | 679/1000 [00:08<00:04, 71.01it/s] 69%|██████▉   | 688/1000 [00:08<00:04, 73.65it/s] 70%|██████▉   | 697/1000 [00:09<00:03, 77.32it/s] 70%|███████   | 705/1000 [00:09<00:04, 71.14it/s] 71%|███████▏  | 713/1000 [00:09<00:04, 70.63it/s] 72%|███████▏  | 721/1000 [00:09<00:03, 71.58it/s] 73%|███████▎  | 729/1000 [00:09<00:03, 72.00it/s] 74%|███████▎  | 737/1000 [00:09<00:03, 72.76it/s] 75%|███████▍  | 747/1000 [00:09<00:03, 77.83it/s] 76%|███████▌  | 755/1000 [00:09<00:03, 70.35it/s] 76%|███████▋  | 764/1000 [00:10<00:03, 74.40it/s] 77%|███████▋  | 772/1000 [00:10<00:03, 75.76it/s] 78%|███████▊  | 780/1000 [00:10<00:02, 76.09it/s] 79%|███████▉  | 788/1000 [00:10<00:02, 75.98it/s] 80%|███████▉  | 796/1000 [00:10<00:02, 71.59it/s] 80%|████████  | 804/1000 [00:10<00:02, 71.30it/s] 82%|████████▏ | 815/1000 [00:10<00:02, 79.01it/s] 82%|████████▏ | 823/1000 [00:10<00:02, 76.63it/s] 83%|████████▎ | 834/1000 [00:10<00:01, 84.12it/s] 84%|████████▍ | 843/1000 [00:11<00:01, 80.69it/s] 85%|████████▌ | 852/1000 [00:11<00:01, 80.58it/s] 86%|████████▌ | 862/1000 [00:11<00:01, 84.72it/s] 87%|████████▋ | 871/1000 [00:11<00:01, 80.17it/s] 88%|████████▊ | 881/1000 [00:11<00:01, 85.11it/s] 89%|████████▉ | 890/1000 [00:11<00:01, 80.62it/s] 90%|████████▉ | 899/1000 [00:11<00:01, 80.37it/s] 91%|█████████ | 908/1000 [00:11<00:01, 82.13it/s] 92%|█████████▏| 918/1000 [00:11<00:00, 86.10it/s] 93%|█████████▎| 927/1000 [00:12<00:00, 79.62it/s] 94%|█████████▎| 936/1000 [00:12<00:00, 81.44it/s] 94%|█████████▍| 945/1000 [00:12<00:00, 78.95it/s] 95%|█████████▌| 953/1000 [00:12<00:00, 76.58it/s] 96%|█████████▌| 961/1000 [00:12<00:00, 77.40it/s] 97%|█████████▋| 969/1000 [00:12<00:00, 72.12it/s] 98%|█████████▊| 977/1000 [00:12<00:00, 72.47it/s] 98%|█████████▊| 985/1000 [00:12<00:00, 70.22it/s] 99%|█████████▉| 993/1000 [00:12<00:00, 69.09it/s]100%|██████████| 1000/1000 [00:13<00:00, 76.59it/s]

Clustering Summary (n_clusters=50):
  Mean within-cluster distance: 0.3640
  Mean between-cluster distance: 0.3870
  Separation ratio: 1.0632
  Cluster size distribution: min=1, max=193, mean=81.9

--- Analyzing with 100 clusters ---
Computing metrics for 100 clusters...
Computing within-cluster distances:   0%|          | 0/100 [00:00<?, ?it/s]Computing within-cluster distances:  13%|█▎        | 13/100 [00:00<00:00, 126.99it/s]Computing within-cluster distances:  26%|██▌       | 26/100 [00:00<00:00, 127.06it/s]Computing within-cluster distances:  39%|███▉      | 39/100 [00:00<00:00, 126.40it/s]Computing within-cluster distances:  52%|█████▏    | 52/100 [00:00<00:00, 119.67it/s]Computing within-cluster distances:  65%|██████▌   | 65/100 [00:00<00:00, 122.49it/s]Computing within-cluster distances:  78%|███████▊  | 78/100 [00:00<00:00, 119.57it/s]Computing within-cluster distances: 100%|██████████| 100/100 [00:00<00:00, 137.60it/s]
Computing between-cluster distances for 1000 cluster pairs...
  0%|          | 0/1000 [00:00<?, ?it/s]  1%|          | 11/1000 [00:00<00:09, 104.85it/s]  2%|▏         | 23/1000 [00:00<00:08, 112.79it/s]  4%|▎         | 35/1000 [00:00<00:08, 112.85it/s]  5%|▍         | 47/1000 [00:00<00:08, 109.84it/s]  6%|▌         | 59/1000 [00:00<00:08, 113.19it/s]  7%|▋         | 71/1000 [00:00<00:08, 111.35it/s]  8%|▊         | 83/1000 [00:00<00:08, 112.30it/s] 10%|▉         | 96/1000 [00:00<00:07, 115.05it/s] 11%|█         | 108/1000 [00:00<00:07, 115.40it/s] 12%|█▏        | 120/1000 [00:01<00:07, 116.15it/s] 13%|█▎        | 132/1000 [00:01<00:07, 115.01it/s] 14%|█▍        | 145/1000 [00:01<00:07, 119.18it/s] 16%|█▌        | 157/1000 [00:01<00:07, 111.63it/s] 17%|█▋        | 169/1000 [00:01<00:07, 113.22it/s] 18%|█▊        | 183/1000 [00:01<00:06, 119.67it/s] 20%|█▉        | 196/1000 [00:01<00:06, 115.39it/s] 21%|██        | 208/1000 [00:01<00:06, 116.56it/s] 22%|██▏       | 220/1000 [00:01<00:06, 114.87it/s] 23%|██▎       | 232/1000 [00:02<00:06, 110.58it/s] 24%|██▍       | 244/1000 [00:02<00:07, 107.83it/s] 26%|██▌       | 255/1000 [00:02<00:06, 107.13it/s] 27%|██▋       | 269/1000 [00:02<00:06, 114.18it/s] 28%|██▊       | 281/1000 [00:02<00:06, 109.44it/s] 29%|██▉       | 294/1000 [00:02<00:06, 112.54it/s] 31%|███       | 306/1000 [00:02<00:06, 113.22it/s] 32%|███▏      | 318/1000 [00:02<00:06, 112.07it/s] 33%|███▎      | 330/1000 [00:02<00:06, 110.76it/s] 34%|███▍      | 343/1000 [00:03<00:05, 115.62it/s] 36%|███▌      | 355/1000 [00:03<00:05, 114.87it/s] 37%|███▋      | 367/1000 [00:03<00:05, 114.81it/s] 38%|███▊      | 381/1000 [00:03<00:05, 119.65it/s] 40%|███▉      | 395/1000 [00:03<00:04, 121.59it/s] 41%|████      | 408/1000 [00:03<00:05, 115.60it/s] 42%|████▏     | 421/1000 [00:03<00:04, 118.15it/s] 44%|████▎     | 436/1000 [00:03<00:04, 124.26it/s] 45%|████▍     | 449/1000 [00:03<00:04, 115.83it/s] 46%|████▌     | 461/1000 [00:04<00:04, 114.38it/s] 47%|████▋     | 474/1000 [00:04<00:04, 116.44it/s] 49%|████▊     | 486/1000 [00:04<00:04, 116.40it/s] 50%|████▉     | 498/1000 [00:04<00:04, 113.84it/s] 51%|█████     | 510/1000 [00:04<00:04, 114.93it/s] 52%|█████▏    | 522/1000 [00:04<00:04, 112.18it/s] 54%|█████▎    | 535/1000 [00:04<00:04, 115.21it/s] 55%|█████▍    | 549/1000 [00:04<00:03, 121.06it/s] 56%|█████▌    | 562/1000 [00:04<00:03, 119.16it/s] 57%|█████▋    | 574/1000 [00:04<00:03, 117.05it/s] 59%|█████▊    | 586/1000 [00:05<00:03, 113.21it/s] 60%|█████▉    | 598/1000 [00:05<00:03, 113.15it/s] 61%|██████    | 610/1000 [00:05<00:03, 112.85it/s] 62%|██████▏   | 623/1000 [00:05<00:03, 116.12it/s] 64%|██████▎   | 635/1000 [00:05<00:03, 116.36it/s] 65%|██████▍   | 647/1000 [00:05<00:03, 114.31it/s] 66%|██████▌   | 659/1000 [00:05<00:03, 111.36it/s] 67%|██████▋   | 671/1000 [00:05<00:02, 109.93it/s] 68%|██████▊   | 684/1000 [00:05<00:02, 113.95it/s] 70%|██████▉   | 697/1000 [00:06<00:02, 116.01it/s] 71%|███████   | 711/1000 [00:06<00:02, 121.80it/s] 72%|███████▏  | 724/1000 [00:06<00:02, 116.92it/s] 74%|███████▎  | 736/1000 [00:06<00:02, 114.58it/s] 75%|███████▍  | 748/1000 [00:06<00:02, 113.42it/s] 76%|███████▌  | 760/1000 [00:06<00:02, 110.06it/s] 77%|███████▋  | 773/1000 [00:06<00:02, 113.46it/s] 78%|███████▊  | 785/1000 [00:06<00:01, 112.39it/s] 80%|███████▉  | 798/1000 [00:06<00:01, 114.63it/s] 81%|████████  | 811/1000 [00:07<00:01, 116.10it/s] 82%|████████▏ | 824/1000 [00:07<00:01, 119.27it/s] 84%|████████▎ | 836/1000 [00:07<00:01, 116.58it/s] 85%|████████▍ | 848/1000 [00:07<00:01, 114.07it/s] 86%|████████▌ | 860/1000 [00:07<00:01, 112.79it/s] 87%|████████▋ | 872/1000 [00:07<00:01, 113.31it/s] 88%|████████▊ | 885/1000 [00:07<00:01, 114.66it/s] 90%|████████▉ | 897/1000 [00:07<00:00, 112.84it/s] 91%|█████████ | 911/1000 [00:07<00:00, 117.76it/s] 92%|█████████▏| 923/1000 [00:08<00:00, 115.44it/s] 94%|█████████▎| 936/1000 [00:08<00:00, 119.46it/s] 95%|█████████▍| 948/1000 [00:08<00:00, 116.44it/s] 96%|█████████▌| 961/1000 [00:08<00:00, 118.88it/s] 97%|█████████▋| 973/1000 [00:08<00:00, 115.32it/s] 98%|█████████▊| 985/1000 [00:08<00:00, 116.62it/s]100%|█████████▉| 997/1000 [00:08<00:00, 116.05it/s]100%|██████████| 1000/1000 [00:08<00:00, 114.95it/s]

Clustering Summary (n_clusters=100):
  Mean within-cluster distance: 0.3484
  Mean between-cluster distance: 0.3839
  Separation ratio: 1.1021
  Cluster size distribution: min=1, max=105, mean=41.0

--- Analyzing with 500 clusters ---
Computing metrics for 500 clusters...
Computing within-cluster distances:   0%|          | 0/500 [00:00<?, ?it/s]Computing within-cluster distances:   9%|▊         | 43/500 [00:00<00:01, 426.66it/s]Computing within-cluster distances:  17%|█▋        | 87/500 [00:00<00:00, 432.96it/s]Computing within-cluster distances:  27%|██▋       | 137/500 [00:00<00:00, 461.66it/s]Computing within-cluster distances:  37%|███▋      | 184/500 [00:00<00:00, 459.41it/s]Computing within-cluster distances:  46%|████▋     | 232/500 [00:00<00:00, 466.06it/s]Computing within-cluster distances:  56%|█████▌    | 279/500 [00:00<00:00, 439.42it/s]Computing within-cluster distances:  66%|██████▌   | 331/500 [00:00<00:00, 461.04it/s]Computing within-cluster distances:  77%|███████▋  | 386/500 [00:00<00:00, 485.68it/s]Computing within-cluster distances:  87%|████████▋ | 436/500 [00:00<00:00, 486.26it/s]Computing within-cluster distances:  97%|█████████▋| 485/500 [00:01<00:00, 474.01it/s]Computing within-cluster distances: 100%|██████████| 500/500 [00:01<00:00, 479.34it/s]
Computing between-cluster distances for 1000 cluster pairs...
  0%|          | 0/1000 [00:00<?, ?it/s]  3%|▎         | 30/1000 [00:00<00:03, 292.55it/s]  6%|▌         | 61/1000 [00:00<00:03, 301.31it/s]  9%|▉         | 92/1000 [00:00<00:03, 294.93it/s] 12%|█▏        | 123/1000 [00:00<00:02, 296.48it/s] 16%|█▌        | 155/1000 [00:00<00:02, 301.93it/s] 19%|█▊        | 186/1000 [00:00<00:02, 301.05it/s] 22%|██▏       | 217/1000 [00:00<00:02, 302.88it/s] 25%|██▍       | 248/1000 [00:00<00:02, 302.77it/s] 28%|██▊       | 279/1000 [00:00<00:02, 300.15it/s] 31%|███       | 310/1000 [00:01<00:02, 296.14it/s] 34%|███▍      | 343/1000 [00:01<00:02, 304.66it/s] 37%|███▋      | 374/1000 [00:01<00:02, 297.08it/s] 40%|████      | 404/1000 [00:01<00:02, 291.89it/s] 44%|████▎     | 436/1000 [00:01<00:01, 299.06it/s] 47%|████▋     | 466/1000 [00:01<00:01, 288.03it/s] 50%|████▉     | 497/1000 [00:01<00:01, 293.22it/s] 53%|█████▎    | 530/1000 [00:01<00:01, 302.83it/s] 56%|█████▌    | 561/1000 [00:01<00:01, 297.21it/s] 59%|█████▉    | 592/1000 [00:01<00:01, 297.64it/s] 62%|██████▏   | 622/1000 [00:02<00:01, 262.23it/s] 65%|██████▌   | 651/1000 [00:02<00:01, 268.95it/s] 68%|██████▊   | 680/1000 [00:02<00:01, 273.78it/s] 71%|███████   | 708/1000 [00:02<00:01, 272.23it/s] 74%|███████▍  | 739/1000 [00:02<00:00, 282.16it/s] 77%|███████▋  | 770/1000 [00:02<00:00, 289.72it/s] 80%|████████  | 802/1000 [00:02<00:00, 295.45it/s] 83%|████████▎ | 832/1000 [00:02<00:00, 296.04it/s] 86%|████████▋ | 863/1000 [00:02<00:00, 298.62it/s] 89%|████████▉ | 893/1000 [00:03<00:00, 295.59it/s] 92%|█████████▏| 924/1000 [00:03<00:00, 298.25it/s] 96%|█████████▌| 957/1000 [00:03<00:00, 306.47it/s] 99%|█████████▉| 988/1000 [00:03<00:00, 305.66it/s]100%|██████████| 1000/1000 [00:03<00:00, 294.20it/s]

Clustering Summary (n_clusters=500):
  Mean within-cluster distance: 0.3522
  Mean between-cluster distance: 0.3763
  Separation ratio: 1.0685
  Cluster size distribution: min=1, max=22, mean=8.2

--- Analyzing with 1000 clusters ---
Computing metrics for 1000 clusters...
Computing within-cluster distances:   0%|          | 0/1000 [00:00<?, ?it/s]Computing within-cluster distances:  13%|█▎        | 133/1000 [00:00<00:00, 1324.04it/s]Computing within-cluster distances:  28%|██▊       | 279/1000 [00:00<00:00, 1398.91it/s]Computing within-cluster distances:  42%|████▏     | 419/1000 [00:00<00:00, 1364.12it/s]Computing within-cluster distances:  56%|█████▌    | 556/1000 [00:00<00:00, 1313.21it/s]Computing within-cluster distances:  70%|███████   | 705/1000 [00:00<00:00, 1370.70it/s]Computing within-cluster distances:  85%|████████▌ | 854/1000 [00:00<00:00, 1408.23it/s]Computing within-cluster distances: 100%|██████████| 1000/1000 [00:00<00:00, 1403.56it/s]
Computing between-cluster distances for 1000 cluster pairs...
  0%|          | 0/1000 [00:00<?, ?it/s]  7%|▋         | 66/1000 [00:00<00:01, 643.40it/s] 14%|█▎        | 135/1000 [00:00<00:01, 668.64it/s] 20%|██        | 203/1000 [00:00<00:01, 670.81it/s] 27%|██▋       | 271/1000 [00:00<00:01, 667.02it/s] 34%|███▍      | 340/1000 [00:00<00:00, 673.95it/s] 41%|████      | 408/1000 [00:00<00:00, 664.76it/s] 48%|████▊     | 475/1000 [00:00<00:00, 650.49it/s] 54%|█████▍    | 541/1000 [00:00<00:00, 636.77it/s] 61%|██████    | 609/1000 [00:00<00:00, 649.53it/s] 68%|██████▊   | 675/1000 [00:01<00:00, 647.67it/s] 74%|███████▍  | 740/1000 [00:01<00:00, 638.17it/s] 80%|████████  | 804/1000 [00:01<00:00, 637.65it/s] 87%|████████▋ | 869/1000 [00:01<00:00, 640.95it/s] 93%|█████████▎| 934/1000 [00:01<00:00, 642.34it/s]100%|█████████▉| 999/1000 [00:01<00:00, 624.95it/s]100%|██████████| 1000/1000 [00:01<00:00, 644.88it/s]

Clustering Summary (n_clusters=1000):
  Mean within-cluster distance: 0.3261
  Mean between-cluster distance: 0.3750
  Separation ratio: 1.1502
  Cluster size distribution: min=1, max=14, mean=4.1

--- Analyzing with 2000 clusters ---
Computing metrics for 2000 clusters...
Computing within-cluster distances:   0%|          | 0/2000 [00:00<?, ?it/s]Computing within-cluster distances:  15%|█▍        | 293/2000 [00:00<00:00, 2924.87it/s]Computing within-cluster distances:  30%|███       | 606/2000 [00:00<00:00, 3038.73it/s]Computing within-cluster distances:  46%|████▌     | 910/2000 [00:00<00:00, 2957.25it/s]Computing within-cluster distances:  61%|██████    | 1211/2000 [00:00<00:00, 2975.28it/s]Computing within-cluster distances:  78%|███████▊  | 1555/2000 [00:00<00:00, 3137.95it/s]Computing within-cluster distances:  94%|█████████▍| 1888/2000 [00:00<00:00, 3199.23it/s]Computing within-cluster distances: 100%|██████████| 2000/2000 [00:00<00:00, 3140.54it/s]
Computing between-cluster distances for 1000 cluster pairs...
  0%|          | 0/1000 [00:00<?, ?it/s] 16%|█▌        | 156/1000 [00:00<00:00, 1557.16it/s] 32%|███▏      | 317/1000 [00:00<00:00, 1584.24it/s] 48%|████▊     | 476/1000 [00:00<00:00, 1489.54it/s] 63%|██████▎   | 633/1000 [00:00<00:00, 1519.87it/s] 79%|███████▉  | 789/1000 [00:00<00:00, 1533.39it/s] 95%|█████████▍| 946/1000 [00:00<00:00, 1542.13it/s]100%|██████████| 1000/1000 [00:00<00:00, 1537.67it/s]

Clustering Summary (n_clusters=2000):
  Mean within-cluster distance: 0.1701
  Mean between-cluster distance: 0.3752
  Separation ratio: 2.2053
  Cluster size distribution: min=1, max=6, mean=2.0

============================================================
Total computation time: 9.06 minutes
============================================================
✓ Intermediate results saved to: /home/datadi/burns/aws/workloads/results/metrics/agglomerative_clustering/wanda/agglomerative_clustering_up_proj_full_results.json

============================================================
✓ FULL Wanda up_proj analysis complete!
============================================================
