Found 31 up_proj matrices to analyze

============================================================
FULL ANALYSIS: /home/datadi/burns/aws/workloads/data/sparsegpt_unstructured/layer0-mlp.up_proj.pt
============================================================
Matrix shape: torch.Size([11008, 4096])
Computing pairwise Hamming distances for ALL 4096 features...
Distance matrix computed (shape: (8386560,))
Computing hierarchical clustering linkage with method='ward'...
Linkage matrix computed

--- Analyzing with 10 clusters ---
Computing metrics for 10 clusters...
Computing within-cluster distances:   0%|          | 0/10 [00:00<?, ?it/s]Computing within-cluster distances:  40%|████      | 4/10 [00:00<00:00, 32.56it/s]Computing within-cluster distances:  90%|█████████ | 9/10 [00:00<00:00, 39.36it/s]Computing within-cluster distances: 100%|██████████| 10/10 [00:00<00:00, 38.64it/s]
Computing between-cluster distances for 45 cluster pairs...
  0%|          | 0/45 [00:00<?, ?it/s]  9%|▉         | 4/45 [00:00<00:01, 34.20it/s] 18%|█▊        | 8/45 [00:00<00:01, 35.52it/s] 27%|██▋       | 12/45 [00:00<00:00, 33.90it/s] 36%|███▌      | 16/45 [00:00<00:00, 34.88it/s] 44%|████▍     | 20/45 [00:00<00:00, 35.57it/s] 53%|█████▎    | 24/45 [00:00<00:00, 33.83it/s] 62%|██████▏   | 28/45 [00:00<00:00, 32.26it/s] 71%|███████   | 32/45 [00:00<00:00, 32.22it/s] 82%|████████▏ | 37/45 [00:01<00:00, 35.89it/s] 91%|█████████ | 41/45 [00:01<00:00, 33.54it/s]100%|██████████| 45/45 [00:01<00:00, 33.43it/s]100%|██████████| 45/45 [00:01<00:00, 33.86it/s]

Clustering Summary (n_clusters=10):
  Mean within-cluster distance: 0.3856
  Mean between-cluster distance: 0.3885
  Separation ratio: 1.0075
  Cluster size distribution: min=11, max=1024, mean=409.6

--- Analyzing with 50 clusters ---
Computing metrics for 50 clusters...
Computing within-cluster distances:   0%|          | 0/50 [00:00<?, ?it/s]Computing within-cluster distances:  10%|█         | 5/50 [00:00<00:00, 48.75it/s]Computing within-cluster distances:  26%|██▌       | 13/50 [00:00<00:00, 61.80it/s]Computing within-cluster distances:  42%|████▏     | 21/50 [00:00<00:00, 65.99it/s]Computing within-cluster distances:  58%|█████▊    | 29/50 [00:00<00:00, 67.81it/s]Computing within-cluster distances:  86%|████████▌ | 43/50 [00:00<00:00, 89.29it/s]Computing within-cluster distances: 100%|██████████| 50/50 [00:00<00:00, 78.86it/s]
Computing between-cluster distances for 1000 cluster pairs...
  0%|          | 0/1000 [00:00<?, ?it/s]  1%|          | 7/1000 [00:00<00:14, 67.40it/s]  2%|▏         | 15/1000 [00:00<00:13, 71.68it/s]  2%|▏         | 23/1000 [00:00<00:13, 70.36it/s]  3%|▎         | 31/1000 [00:00<00:14, 67.32it/s]  4%|▍         | 38/1000 [00:00<00:15, 61.16it/s]  4%|▍         | 45/1000 [00:00<00:16, 58.44it/s]  5%|▌         | 51/1000 [00:00<00:16, 58.74it/s]  6%|▌         | 58/1000 [00:00<00:16, 58.74it/s]  7%|▋         | 66/1000 [00:01<00:14, 63.53it/s]  7%|▋         | 73/1000 [00:01<00:15, 60.82it/s]  8%|▊         | 80/1000 [00:01<00:14, 61.64it/s]  9%|▊         | 87/1000 [00:01<00:14, 62.81it/s]  9%|▉         | 94/1000 [00:01<00:15, 59.81it/s] 10%|█         | 102/1000 [00:01<00:14, 63.90it/s] 11%|█         | 109/1000 [00:01<00:14, 60.53it/s] 12%|█▏        | 116/1000 [00:01<00:14, 61.62it/s] 12%|█▏        | 123/1000 [00:01<00:14, 61.69it/s] 13%|█▎        | 132/1000 [00:02<00:12, 68.14it/s] 14%|█▍        | 139/1000 [00:02<00:12, 68.03it/s] 15%|█▍        | 147/1000 [00:02<00:12, 68.30it/s] 15%|█▌        | 154/1000 [00:02<00:13, 64.08it/s] 16%|█▌        | 161/1000 [00:02<00:13, 63.35it/s] 17%|█▋        | 168/1000 [00:02<00:13, 63.54it/s] 18%|█▊        | 175/1000 [00:02<00:12, 64.14it/s] 18%|█▊        | 183/1000 [00:02<00:12, 64.59it/s] 19%|█▉        | 190/1000 [00:03<00:13, 60.35it/s] 20%|█▉        | 197/1000 [00:03<00:13, 61.24it/s] 20%|██        | 204/1000 [00:03<00:12, 63.25it/s] 21%|██        | 211/1000 [00:03<00:12, 64.53it/s] 22%|██▏       | 220/1000 [00:03<00:11, 68.88it/s] 23%|██▎       | 228/1000 [00:03<00:11, 69.32it/s] 24%|██▎       | 235/1000 [00:03<00:11, 65.96it/s] 24%|██▍       | 242/1000 [00:03<00:12, 63.14it/s] 25%|██▍       | 249/1000 [00:03<00:11, 62.62it/s] 26%|██▌       | 257/1000 [00:04<00:11, 66.93it/s] 26%|██▋       | 264/1000 [00:04<00:11, 66.04it/s] 27%|██▋       | 271/1000 [00:04<00:11, 62.40it/s] 28%|██▊       | 278/1000 [00:04<00:11, 64.13it/s] 28%|██▊       | 285/1000 [00:04<00:11, 63.74it/s] 29%|██▉       | 292/1000 [00:04<00:10, 64.82it/s] 30%|███       | 300/1000 [00:04<00:10, 68.01it/s] 31%|███       | 309/1000 [00:04<00:09, 74.04it/s] 32%|███▏      | 317/1000 [00:04<00:10, 66.42it/s] 32%|███▏      | 324/1000 [00:05<00:10, 64.49it/s] 33%|███▎      | 331/1000 [00:05<00:10, 64.82it/s] 34%|███▍      | 338/1000 [00:05<00:10, 64.03it/s] 35%|███▍      | 347/1000 [00:05<00:09, 67.55it/s] 35%|███▌      | 354/1000 [00:05<00:09, 67.96it/s] 36%|███▌      | 361/1000 [00:05<00:09, 64.30it/s] 37%|███▋      | 368/1000 [00:05<00:09, 65.48it/s] 38%|███▊      | 376/1000 [00:05<00:09, 67.53it/s] 38%|███▊      | 383/1000 [00:05<00:09, 65.65it/s] 39%|███▉      | 391/1000 [00:06<00:08, 69.56it/s] 40%|███▉      | 399/1000 [00:06<00:09, 66.00it/s] 41%|████      | 406/1000 [00:06<00:09, 64.04it/s] 41%|████▏     | 413/1000 [00:06<00:09, 64.19it/s] 42%|████▏     | 420/1000 [00:06<00:08, 64.72it/s] 43%|████▎     | 427/1000 [00:06<00:09, 60.67it/s] 43%|████▎     | 434/1000 [00:06<00:09, 61.56it/s] 44%|████▍     | 441/1000 [00:06<00:09, 60.75it/s] 45%|████▍     | 448/1000 [00:07<00:09, 57.78it/s] 45%|████▌     | 454/1000 [00:07<00:09, 56.31it/s] 46%|████▌     | 461/1000 [00:07<00:09, 57.51it/s] 47%|████▋     | 468/1000 [00:07<00:09, 58.82it/s] 48%|████▊     | 475/1000 [00:07<00:08, 60.07it/s] 48%|████▊     | 482/1000 [00:07<00:08, 59.29it/s] 49%|████▉     | 489/1000 [00:07<00:08, 58.67it/s] 50%|████▉     | 495/1000 [00:07<00:08, 56.68it/s] 50%|█████     | 503/1000 [00:07<00:07, 62.42it/s] 51%|█████     | 510/1000 [00:08<00:07, 61.26it/s] 52%|█████▏    | 517/1000 [00:08<00:07, 63.34it/s] 52%|█████▏    | 524/1000 [00:08<00:07, 59.91it/s] 53%|█████▎    | 531/1000 [00:08<00:07, 62.25it/s] 54%|█████▍    | 538/1000 [00:08<00:07, 62.39it/s] 55%|█████▍    | 545/1000 [00:08<00:07, 64.12it/s] 55%|█████▌    | 553/1000 [00:08<00:06, 66.81it/s] 56%|█████▌    | 560/1000 [00:08<00:06, 63.72it/s] 57%|█████▋    | 567/1000 [00:08<00:06, 62.50it/s] 57%|█████▋    | 574/1000 [00:09<00:07, 58.71it/s] 58%|█████▊    | 581/1000 [00:09<00:06, 60.28it/s] 59%|█████▉    | 588/1000 [00:09<00:06, 60.79it/s] 60%|█████▉    | 596/1000 [00:09<00:06, 63.64it/s] 60%|██████    | 603/1000 [00:09<00:06, 61.99it/s] 61%|██████    | 610/1000 [00:09<00:06, 63.13it/s] 62%|██████▏   | 617/1000 [00:09<00:06, 61.59it/s] 62%|██████▏   | 624/1000 [00:09<00:06, 59.68it/s] 63%|██████▎   | 630/1000 [00:09<00:06, 59.46it/s] 64%|██████▎   | 636/1000 [00:10<00:06, 57.49it/s] 64%|██████▍   | 643/1000 [00:10<00:06, 59.32it/s] 65%|██████▍   | 649/1000 [00:10<00:06, 58.25it/s] 66%|██████▌   | 656/1000 [00:10<00:05, 60.39it/s] 66%|██████▋   | 663/1000 [00:10<00:05, 62.25it/s] 67%|██████▋   | 670/1000 [00:10<00:05, 62.41it/s] 68%|██████▊   | 677/1000 [00:10<00:05, 60.43it/s] 68%|██████▊   | 684/1000 [00:10<00:05, 62.06it/s] 69%|██████▉   | 691/1000 [00:10<00:05, 61.08it/s] 70%|██████▉   | 699/1000 [00:11<00:04, 65.26it/s] 71%|███████   | 707/1000 [00:11<00:04, 66.71it/s] 72%|███████▏  | 715/1000 [00:11<00:04, 68.03it/s] 72%|███████▏  | 722/1000 [00:11<00:04, 63.81it/s] 73%|███████▎  | 729/1000 [00:11<00:04, 62.84it/s] 74%|███████▎  | 736/1000 [00:11<00:04, 63.64it/s] 74%|███████▍  | 743/1000 [00:11<00:03, 65.34it/s] 75%|███████▌  | 750/1000 [00:11<00:03, 62.59it/s] 76%|███████▌  | 757/1000 [00:11<00:03, 64.27it/s] 76%|███████▋  | 764/1000 [00:12<00:03, 65.01it/s] 77%|███████▋  | 771/1000 [00:12<00:03, 63.55it/s] 78%|███████▊  | 779/1000 [00:12<00:03, 67.73it/s] 79%|███████▊  | 787/1000 [00:12<00:02, 71.08it/s] 80%|███████▉  | 795/1000 [00:12<00:03, 66.67it/s] 80%|████████  | 802/1000 [00:12<00:03, 63.94it/s] 81%|████████  | 810/1000 [00:12<00:02, 68.12it/s] 82%|████████▏ | 817/1000 [00:12<00:02, 66.92it/s] 82%|████████▏ | 824/1000 [00:12<00:02, 67.23it/s] 83%|████████▎ | 831/1000 [00:13<00:02, 65.87it/s] 84%|████████▍ | 838/1000 [00:13<00:02, 63.08it/s] 84%|████████▍ | 845/1000 [00:13<00:02, 64.92it/s] 85%|████████▌ | 853/1000 [00:13<00:02, 68.43it/s] 86%|████████▌ | 862/1000 [00:13<00:01, 72.13it/s] 87%|████████▋ | 870/1000 [00:13<00:01, 73.07it/s] 88%|████████▊ | 878/1000 [00:13<00:01, 68.96it/s] 88%|████████▊ | 885/1000 [00:13<00:01, 66.27it/s] 89%|████████▉ | 892/1000 [00:13<00:01, 65.65it/s] 90%|████████▉ | 899/1000 [00:14<00:01, 64.76it/s] 91%|█████████ | 907/1000 [00:14<00:01, 68.20it/s] 92%|█████████▏| 915/1000 [00:14<00:01, 69.46it/s] 92%|█████████▏| 922/1000 [00:14<00:01, 65.63it/s] 93%|█████████▎| 930/1000 [00:14<00:01, 68.97it/s] 94%|█████████▎| 937/1000 [00:14<00:00, 66.52it/s] 94%|█████████▍| 945/1000 [00:14<00:00, 68.62it/s] 95%|█████████▌| 953/1000 [00:14<00:00, 70.10it/s] 96%|█████████▌| 961/1000 [00:15<00:00, 65.82it/s] 97%|█████████▋| 968/1000 [00:15<00:00, 65.37it/s] 98%|█████████▊| 976/1000 [00:15<00:00, 68.06it/s] 98%|█████████▊| 985/1000 [00:15<00:00, 71.10it/s] 99%|█████████▉| 993/1000 [00:15<00:00, 65.94it/s]100%|██████████| 1000/1000 [00:15<00:00, 66.57it/s]100%|██████████| 1000/1000 [00:15<00:00, 64.13it/s]

Clustering Summary (n_clusters=50):
  Mean within-cluster distance: 0.3777
  Mean between-cluster distance: 0.3934
  Separation ratio: 1.0415
  Cluster size distribution: min=1, max=385, mean=81.9

--- Analyzing with 100 clusters ---
Computing metrics for 100 clusters...
Computing within-cluster distances:   0%|          | 0/100 [00:00<?, ?it/s]Computing within-cluster distances:   7%|▋         | 7/100 [00:00<00:01, 68.02it/s]Computing within-cluster distances:  14%|█▍        | 14/100 [00:00<00:01, 67.97it/s]Computing within-cluster distances:  28%|██▊       | 28/100 [00:00<00:00, 97.45it/s]Computing within-cluster distances:  41%|████      | 41/100 [00:00<00:00, 108.25it/s]Computing within-cluster distances:  53%|█████▎    | 53/100 [00:00<00:00, 111.74it/s]Computing within-cluster distances:  68%|██████▊   | 68/100 [00:00<00:00, 121.83it/s]Computing within-cluster distances:  87%|████████▋ | 87/100 [00:00<00:00, 142.03it/s]Computing within-cluster distances: 100%|██████████| 100/100 [00:00<00:00, 120.54it/s]
Computing between-cluster distances for 1000 cluster pairs...
  0%|          | 0/1000 [00:00<?, ?it/s]  1%|          | 12/1000 [00:00<00:08, 117.01it/s]  2%|▏         | 24/1000 [00:00<00:09, 107.73it/s]  4%|▎         | 35/1000 [00:00<00:09, 101.97it/s]  5%|▍         | 46/1000 [00:00<00:09, 98.77it/s]   6%|▌         | 56/1000 [00:00<00:09, 97.24it/s]  7%|▋         | 67/1000 [00:00<00:09, 100.68it/s]  8%|▊         | 79/1000 [00:00<00:08, 105.25it/s]  9%|▉         | 90/1000 [00:00<00:08, 104.73it/s] 10%|█         | 101/1000 [00:00<00:09, 99.56it/s] 11%|█         | 112/1000 [00:01<00:08, 100.83it/s] 12%|█▏        | 124/1000 [00:01<00:08, 105.16it/s] 14%|█▎        | 135/1000 [00:01<00:08, 104.48it/s] 15%|█▍        | 147/1000 [00:01<00:07, 108.42it/s] 16%|█▌        | 158/1000 [00:01<00:07, 108.28it/s] 17%|█▋        | 169/1000 [00:01<00:07, 108.32it/s] 18%|█▊        | 181/1000 [00:01<00:07, 111.67it/s] 19%|█▉        | 194/1000 [00:01<00:06, 115.80it/s] 21%|██        | 206/1000 [00:01<00:07, 113.05it/s] 22%|██▏       | 219/1000 [00:02<00:06, 114.56it/s] 23%|██▎       | 231/1000 [00:02<00:06, 116.01it/s] 24%|██▍       | 243/1000 [00:02<00:06, 108.82it/s] 25%|██▌       | 254/1000 [00:02<00:07, 104.78it/s] 27%|██▋       | 267/1000 [00:02<00:06, 109.55it/s] 28%|██▊       | 279/1000 [00:02<00:06, 109.21it/s] 29%|██▉       | 292/1000 [00:02<00:06, 112.98it/s] 30%|███       | 304/1000 [00:02<00:06, 113.67it/s] 32%|███▏      | 316/1000 [00:02<00:06, 110.56it/s] 33%|███▎      | 328/1000 [00:03<00:06, 100.66it/s] 34%|███▍      | 342/1000 [00:03<00:06, 108.87it/s] 35%|███▌      | 354/1000 [00:03<00:06, 102.36it/s] 37%|███▋      | 366/1000 [00:03<00:06, 104.81it/s] 38%|███▊      | 377/1000 [00:03<00:05, 104.31it/s] 39%|███▉      | 389/1000 [00:03<00:05, 105.62it/s] 40%|████      | 400/1000 [00:03<00:05, 104.66it/s] 41%|████      | 411/1000 [00:03<00:05, 104.16it/s] 42%|████▏     | 422/1000 [00:03<00:05, 101.82it/s] 43%|████▎     | 433/1000 [00:04<00:05, 100.55it/s] 44%|████▍     | 444/1000 [00:04<00:05, 100.16it/s] 46%|████▌     | 455/1000 [00:04<00:05, 96.03it/s]  47%|████▋     | 466/1000 [00:04<00:05, 98.14it/s] 48%|████▊     | 477/1000 [00:04<00:05, 99.56it/s] 49%|████▉     | 489/1000 [00:04<00:04, 104.45it/s] 50%|█████     | 500/1000 [00:04<00:04, 101.80it/s] 51%|█████     | 511/1000 [00:04<00:04, 98.27it/s]  52%|█████▏    | 523/1000 [00:04<00:04, 101.76it/s] 54%|█████▎    | 536/1000 [00:05<00:04, 106.58it/s] 55%|█████▍    | 547/1000 [00:05<00:04, 105.33it/s] 56%|█████▌    | 559/1000 [00:05<00:04, 107.56it/s] 57%|█████▋    | 570/1000 [00:05<00:04, 103.31it/s] 58%|█████▊    | 581/1000 [00:05<00:04, 97.56it/s]  59%|█████▉    | 591/1000 [00:05<00:04, 96.43it/s] 60%|██████    | 602/1000 [00:05<00:04, 98.37it/s] 61%|██████▏   | 613/1000 [00:05<00:03, 97.79it/s] 62%|██████▏   | 623/1000 [00:05<00:03, 97.06it/s] 64%|██████▎   | 635/1000 [00:06<00:03, 101.77it/s] 65%|██████▍   | 647/1000 [00:06<00:03, 106.81it/s] 66%|██████▌   | 658/1000 [00:06<00:03, 107.56it/s] 67%|██████▋   | 669/1000 [00:06<00:03, 105.04it/s] 68%|██████▊   | 680/1000 [00:06<00:03, 103.53it/s] 69%|██████▉   | 691/1000 [00:06<00:02, 105.06it/s] 70%|███████   | 702/1000 [00:06<00:02, 104.84it/s] 71%|███████▏  | 714/1000 [00:06<00:02, 106.99it/s] 72%|███████▎  | 725/1000 [00:06<00:02, 107.29it/s] 74%|███████▎  | 737/1000 [00:07<00:02, 108.46it/s] 75%|███████▍  | 748/1000 [00:07<00:02, 104.70it/s] 76%|███████▌  | 759/1000 [00:07<00:02, 95.20it/s]  77%|███████▋  | 769/1000 [00:07<00:02, 92.67it/s] 78%|███████▊  | 779/1000 [00:07<00:02, 93.20it/s] 79%|███████▉  | 789/1000 [00:07<00:02, 91.96it/s] 80%|████████  | 800/1000 [00:07<00:02, 96.36it/s] 81%|████████  | 810/1000 [00:07<00:02, 92.31it/s] 82%|████████▏ | 821/1000 [00:07<00:01, 96.36it/s] 83%|████████▎ | 831/1000 [00:08<00:01, 94.25it/s] 84%|████████▍ | 841/1000 [00:08<00:01, 90.28it/s] 85%|████████▌ | 851/1000 [00:08<00:01, 89.56it/s] 86%|████████▌ | 861/1000 [00:08<00:01, 88.93it/s] 87%|████████▋ | 870/1000 [00:08<00:01, 86.22it/s] 88%|████████▊ | 880/1000 [00:08<00:01, 89.20it/s] 89%|████████▉ | 889/1000 [00:08<00:01, 84.99it/s] 90%|████████▉ | 899/1000 [00:08<00:01, 86.32it/s] 91%|█████████ | 909/1000 [00:08<00:01, 88.80it/s] 92%|█████████▏| 919/1000 [00:09<00:00, 91.15it/s] 93%|█████████▎| 929/1000 [00:09<00:00, 89.09it/s] 94%|█████████▍| 938/1000 [00:09<00:00, 87.79it/s] 95%|█████████▌| 950/1000 [00:09<00:00, 95.72it/s] 96%|█████████▌| 961/1000 [00:09<00:00, 94.67it/s] 97%|█████████▋| 971/1000 [00:09<00:00, 90.56it/s] 98%|█████████▊| 981/1000 [00:09<00:00, 91.25it/s] 99%|█████████▉| 993/1000 [00:09<00:00, 98.09it/s]100%|██████████| 1000/1000 [00:09<00:00, 100.93it/s]

Clustering Summary (n_clusters=100):
  Mean within-cluster distance: 0.3705
  Mean between-cluster distance: 0.3913
  Separation ratio: 1.0563
  Cluster size distribution: min=1, max=202, mean=41.0

--- Analyzing with 500 clusters ---
Computing metrics for 500 clusters...
Computing within-cluster distances:   0%|          | 0/500 [00:00<?, ?it/s]Computing within-cluster distances:   3%|▎         | 16/500 [00:00<00:03, 159.31it/s]Computing within-cluster distances:   8%|▊         | 40/500 [00:00<00:02, 203.36it/s]Computing within-cluster distances:  13%|█▎        | 64/500 [00:00<00:01, 219.81it/s]Computing within-cluster distances:  20%|██        | 101/500 [00:00<00:01, 278.55it/s]Computing within-cluster distances:  33%|███▎      | 164/500 [00:00<00:00, 400.11it/s]Computing within-cluster distances:  42%|████▏     | 209/500 [00:00<00:00, 414.65it/s]Computing within-cluster distances:  51%|█████     | 255/500 [00:00<00:00, 427.05it/s]Computing within-cluster distances:  63%|██████▎   | 317/500 [00:00<00:00, 486.23it/s]Computing within-cluster distances:  76%|███████▌  | 381/500 [00:00<00:00, 530.96it/s]Computing within-cluster distances:  95%|█████████▌| 475/500 [00:01<00:00, 653.76it/s]Computing within-cluster distances: 100%|██████████| 500/500 [00:01<00:00, 474.91it/s]
Computing between-cluster distances for 1000 cluster pairs...
  0%|          | 0/1000 [00:00<?, ?it/s]  3%|▎         | 30/1000 [00:00<00:03, 299.00it/s]  6%|▋         | 63/1000 [00:00<00:03, 310.31it/s] 10%|▉         | 96/1000 [00:00<00:02, 318.32it/s] 13%|█▎        | 128/1000 [00:00<00:02, 316.23it/s] 16%|█▌        | 160/1000 [00:00<00:02, 316.05it/s] 19%|█▉        | 192/1000 [00:00<00:02, 307.63it/s] 22%|██▏       | 223/1000 [00:00<00:02, 299.14it/s] 25%|██▌       | 253/1000 [00:00<00:02, 292.05it/s] 28%|██▊       | 283/1000 [00:00<00:02, 286.16it/s] 32%|███▏      | 316/1000 [00:01<00:02, 297.50it/s] 35%|███▍      | 349/1000 [00:01<00:02, 305.38it/s] 38%|███▊      | 382/1000 [00:01<00:01, 312.32it/s] 41%|████▏     | 414/1000 [00:01<00:01, 298.91it/s] 45%|████▍     | 446/1000 [00:01<00:01, 303.51it/s] 48%|████▊     | 477/1000 [00:01<00:01, 299.28it/s] 51%|█████     | 508/1000 [00:01<00:01, 299.74it/s] 54%|█████▍    | 539/1000 [00:01<00:01, 284.87it/s] 57%|█████▋    | 569/1000 [00:01<00:01, 289.11it/s] 60%|█████▉    | 599/1000 [00:02<00:01, 276.08it/s] 64%|██████▎   | 635/1000 [00:02<00:01, 297.28it/s] 67%|██████▋   | 667/1000 [00:02<00:01, 303.66it/s] 70%|██████▉   | 698/1000 [00:02<00:01, 290.01it/s] 73%|███████▎  | 729/1000 [00:02<00:00, 294.97it/s] 76%|███████▌  | 761/1000 [00:02<00:00, 301.09it/s] 79%|███████▉  | 793/1000 [00:02<00:00, 304.86it/s] 82%|████████▏ | 824/1000 [00:02<00:00, 301.27it/s] 86%|████████▌ | 855/1000 [00:02<00:00, 294.59it/s] 89%|████████▊ | 886/1000 [00:02<00:00, 297.90it/s] 92%|█████████▏| 916/1000 [00:03<00:00, 298.08it/s] 95%|█████████▍| 948/1000 [00:03<00:00, 300.77it/s] 98%|█████████▊| 979/1000 [00:03<00:00, 299.88it/s]100%|██████████| 1000/1000 [00:03<00:00, 298.94it/s]

Clustering Summary (n_clusters=500):
  Mean within-cluster distance: 0.3523
  Mean between-cluster distance: 0.3851
  Separation ratio: 1.0931
  Cluster size distribution: min=1, max=183, mean=8.2

--- Analyzing with 1000 clusters ---
Computing metrics for 1000 clusters...
Computing within-cluster distances:   0%|          | 0/1000 [00:00<?, ?it/s]Computing within-cluster distances:   2%|▏         | 23/1000 [00:00<00:04, 226.08it/s]Computing within-cluster distances:   8%|▊         | 83/1000 [00:00<00:02, 443.30it/s]Computing within-cluster distances:  14%|█▎        | 135/1000 [00:00<00:01, 475.83it/s]Computing within-cluster distances:  25%|██▍       | 248/1000 [00:00<00:01, 731.40it/s]Computing within-cluster distances:  37%|███▋      | 374/1000 [00:00<00:00, 918.79it/s]Computing within-cluster distances:  49%|████▉     | 491/1000 [00:00<00:00, 993.95it/s]Computing within-cluster distances:  65%|██████▌   | 650/1000 [00:00<00:00, 1184.99it/s]Computing within-cluster distances:  86%|████████▌ | 857/1000 [00:00<00:00, 1463.24it/s]Computing within-cluster distances: 100%|██████████| 1000/1000 [00:00<00:00, 1130.18it/s]
Computing between-cluster distances for 1000 cluster pairs...
  0%|          | 0/1000 [00:00<?, ?it/s]  6%|▌         | 62/1000 [00:00<00:01, 612.57it/s] 13%|█▎        | 129/1000 [00:00<00:01, 643.77it/s] 20%|█▉        | 199/1000 [00:00<00:01, 668.41it/s] 27%|██▋       | 266/1000 [00:00<00:01, 601.81it/s] 33%|███▎      | 328/1000 [00:00<00:01, 591.28it/s] 40%|████      | 403/1000 [00:00<00:00, 641.42it/s] 47%|████▋     | 468/1000 [00:00<00:00, 600.11it/s] 53%|█████▎    | 529/1000 [00:00<00:00, 599.36it/s] 60%|██████    | 601/1000 [00:00<00:00, 629.20it/s] 66%|██████▋   | 665/1000 [00:01<00:00, 626.59it/s] 73%|███████▎  | 729/1000 [00:01<00:00, 615.98it/s] 79%|███████▉  | 791/1000 [00:01<00:00, 611.33it/s] 85%|████████▌ | 853/1000 [00:01<00:00, 596.00it/s] 91%|█████████▏| 913/1000 [00:01<00:00, 589.12it/s] 98%|█████████▊| 979/1000 [00:01<00:00, 604.10it/s]100%|██████████| 1000/1000 [00:01<00:00, 613.21it/s]

Clustering Summary (n_clusters=1000):
  Mean within-cluster distance: 0.2705
  Mean between-cluster distance: 0.3813
  Separation ratio: 1.4098
  Cluster size distribution: min=1, max=150, mean=4.1

--- Analyzing with 2000 clusters ---
Computing metrics for 2000 clusters...
Computing within-cluster distances:   0%|          | 0/2000 [00:00<?, ?it/s]Computing within-cluster distances:   2%|▏         | 48/2000 [00:00<00:04, 478.46it/s]Computing within-cluster distances:  10%|▉         | 198/2000 [00:00<00:01, 1059.87it/s]Computing within-cluster distances:  16%|█▌        | 310/2000 [00:00<00:01, 1084.76it/s]Computing within-cluster distances:  34%|███▍      | 690/2000 [00:00<00:00, 2142.61it/s]Computing within-cluster distances:  49%|████▊     | 974/2000 [00:00<00:00, 2390.70it/s]Computing within-cluster distances:  66%|██████▋   | 1326/2000 [00:00<00:00, 2771.07it/s]Computing within-cluster distances:  87%|████████▋ | 1748/2000 [00:00<00:00, 3238.47it/s]Computing within-cluster distances: 100%|██████████| 2000/2000 [00:00<00:00, 2607.57it/s]
Computing between-cluster distances for 1000 cluster pairs...
  0%|          | 0/1000 [00:00<?, ?it/s] 14%|█▎        | 137/1000 [00:00<00:00, 1367.65it/s] 27%|██▋       | 274/1000 [00:00<00:00, 1332.23it/s] 41%|████      | 409/1000 [00:00<00:00, 1338.31it/s] 54%|█████▍    | 543/1000 [00:00<00:00, 1285.82it/s] 69%|██████▉   | 690/1000 [00:00<00:00, 1349.79it/s] 83%|████████▎ | 831/1000 [00:00<00:00, 1368.33it/s] 97%|█████████▋| 969/1000 [00:00<00:00, 1366.56it/s]100%|██████████| 1000/1000 [00:00<00:00, 1357.64it/s]

Clustering Summary (n_clusters=2000):
  Mean within-cluster distance: 0.1148
  Mean between-cluster distance: 0.3781
  Separation ratio: 3.2939
  Cluster size distribution: min=1, max=150, mean=2.0

============================================================
Total computation time: 8.54 minutes
============================================================
✓ Intermediate results saved to: /home/datadi/burns/aws/workloads/results/metrics/agglomerative_clustering/sparsegpt/agglomerative_clustering_up_proj_full_results.json

============================================================
FULL ANALYSIS: /home/datadi/burns/aws/workloads/data/sparsegpt_unstructured/layer2-mlp.up_proj.pt
============================================================
Matrix shape: torch.Size([11008, 4096])
Computing pairwise Hamming distances for ALL 4096 features...
Distance matrix computed (shape: (8386560,))
Computing hierarchical clustering linkage with method='ward'...
Linkage matrix computed

--- Analyzing with 10 clusters ---
Computing metrics for 10 clusters...
Computing within-cluster distances:   0%|          | 0/10 [00:00<?, ?it/s]Computing within-cluster distances:  70%|███████   | 7/10 [00:00<00:00, 55.47it/s]Computing within-cluster distances: 100%|██████████| 10/10 [00:00<00:00, 47.96it/s]
Computing between-cluster distances for 45 cluster pairs...
  0%|          | 0/45 [00:00<?, ?it/s]  9%|▉         | 4/45 [00:00<00:01, 33.87it/s] 18%|█▊        | 8/45 [00:00<00:01, 32.89it/s] 31%|███       | 14/45 [00:00<00:00, 40.57it/s] 42%|████▏     | 19/45 [00:00<00:00, 36.58it/s] 51%|█████     | 23/45 [00:00<00:00, 36.22it/s] 64%|██████▍   | 29/45 [00:00<00:00, 42.85it/s] 76%|███████▌  | 34/45 [00:00<00:00, 38.58it/s] 87%|████████▋ | 39/45 [00:01<00:00, 37.92it/s]100%|██████████| 45/45 [00:01<00:00, 40.26it/s]100%|██████████| 45/45 [00:01<00:00, 38.80it/s]

Clustering Summary (n_clusters=10):
  Mean within-cluster distance: 0.3421
  Mean between-cluster distance: 0.3904
  Separation ratio: 1.1412
  Cluster size distribution: min=2, max=735, mean=409.6

--- Analyzing with 50 clusters ---
Computing metrics for 50 clusters...
Computing within-cluster distances:   0%|          | 0/50 [00:00<?, ?it/s]Computing within-cluster distances:  22%|██▏       | 11/50 [00:00<00:00, 97.27it/s]Computing within-cluster distances:  42%|████▏     | 21/50 [00:00<00:00, 87.18it/s]Computing within-cluster distances:  60%|██████    | 30/50 [00:00<00:00, 85.17it/s]Computing within-cluster distances:  78%|███████▊  | 39/50 [00:00<00:00, 80.90it/s]Computing within-cluster distances:  96%|█████████▌| 48/50 [00:00<00:00, 77.27it/s]Computing within-cluster distances: 100%|██████████| 50/50 [00:00<00:00, 80.88it/s]
Computing between-cluster distances for 1000 cluster pairs...
  0%|          | 0/1000 [00:00<?, ?it/s]  1%|          | 6/1000 [00:00<00:18, 54.99it/s]  1%|          | 12/1000 [00:00<00:17, 56.88it/s]  2%|▏         | 18/1000 [00:00<00:17, 55.82it/s]  2%|▏         | 24/1000 [00:00<00:17, 57.33it/s]  3%|▎         | 32/1000 [00:00<00:15, 64.24it/s]  4%|▍         | 39/1000 [00:00<00:15, 61.49it/s]  5%|▍         | 46/1000 [00:00<00:15, 60.84it/s]  5%|▌         | 53/1000 [00:00<00:15, 62.11it/s]  6%|▌         | 61/1000 [00:00<00:14, 66.13it/s]  7%|▋         | 68/1000 [00:01<00:13, 66.77it/s]  8%|▊         | 75/1000 [00:01<00:14, 63.30it/s]  8%|▊         | 82/1000 [00:01<00:14, 61.30it/s]  9%|▉         | 89/1000 [00:01<00:14, 62.85it/s] 10%|▉         | 96/1000 [00:01<00:13, 64.80it/s] 10%|█         | 103/1000 [00:01<00:13, 66.05it/s] 11%|█         | 110/1000 [00:01<00:14, 63.28it/s] 12%|█▏        | 117/1000 [00:01<00:14, 60.54it/s] 12%|█▏        | 124/1000 [00:01<00:14, 61.99it/s] 13%|█▎        | 132/1000 [00:02<00:13, 65.22it/s] 14%|█▍        | 140/1000 [00:02<00:12, 66.75it/s] 15%|█▍        | 147/1000 [00:02<00:13, 63.59it/s] 15%|█▌        | 154/1000 [00:02<00:13, 62.11it/s] 16%|█▌        | 161/1000 [00:02<00:13, 60.28it/s] 17%|█▋        | 168/1000 [00:02<00:13, 60.77it/s] 18%|█▊        | 176/1000 [00:02<00:12, 64.38it/s] 18%|█▊        | 183/1000 [00:02<00:12, 63.30it/s] 19%|█▉        | 190/1000 [00:03<00:12, 64.54it/s] 20%|█▉        | 197/1000 [00:03<00:12, 62.91it/s] 20%|██        | 204/1000 [00:03<00:12, 61.71it/s] 21%|██        | 211/1000 [00:03<00:12, 62.38it/s] 22%|██▏       | 218/1000 [00:03<00:12, 62.34it/s] 22%|██▎       | 225/1000 [00:03<00:12, 63.91it/s] 23%|██▎       | 233/1000 [00:03<00:11, 65.99it/s] 24%|██▍       | 240/1000 [00:03<00:11, 64.02it/s] 25%|██▍       | 247/1000 [00:03<00:12, 61.37it/s] 25%|██▌       | 254/1000 [00:04<00:12, 60.58it/s] 26%|██▌       | 261/1000 [00:04<00:11, 61.61it/s] 27%|██▋       | 268/1000 [00:04<00:11, 62.35it/s] 28%|██▊       | 275/1000 [00:04<00:11, 62.77it/s] 28%|██▊       | 282/1000 [00:04<00:11, 61.96it/s] 29%|██▉       | 289/1000 [00:04<00:11, 60.57it/s] 30%|██▉       | 296/1000 [00:04<00:11, 59.38it/s] 30%|███       | 302/1000 [00:04<00:11, 59.24it/s] 31%|███       | 308/1000 [00:04<00:11, 59.45it/s] 32%|███▏      | 316/1000 [00:05<00:10, 62.51it/s] 32%|███▏      | 323/1000 [00:05<00:10, 61.78it/s] 33%|███▎      | 330/1000 [00:05<00:11, 59.68it/s] 34%|███▎      | 336/1000 [00:05<00:11, 57.53it/s] 34%|███▍      | 342/1000 [00:05<00:11, 56.86it/s] 35%|███▍      | 349/1000 [00:05<00:11, 58.06it/s] 36%|███▌      | 356/1000 [00:05<00:10, 60.25it/s] 36%|███▋      | 364/1000 [00:05<00:10, 63.26it/s] 37%|███▋      | 371/1000 [00:05<00:09, 62.90it/s] 38%|███▊      | 378/1000 [00:06<00:10, 61.10it/s] 38%|███▊      | 385/1000 [00:06<00:09, 61.84it/s] 39%|███▉      | 392/1000 [00:06<00:10, 60.64it/s] 40%|███▉      | 399/1000 [00:06<00:09, 60.33it/s] 41%|████      | 406/1000 [00:06<00:10, 58.60it/s] 41%|████      | 412/1000 [00:06<00:09, 58.80it/s] 42%|████▏     | 419/1000 [00:06<00:09, 59.15it/s] 42%|████▎     | 425/1000 [00:06<00:09, 58.57it/s] 43%|████▎     | 431/1000 [00:07<00:09, 58.03it/s] 44%|████▎     | 437/1000 [00:07<00:09, 56.31it/s] 44%|████▍     | 445/1000 [00:07<00:09, 60.46it/s] 45%|████▌     | 452/1000 [00:07<00:09, 60.20it/s] 46%|████▌     | 459/1000 [00:07<00:09, 58.32it/s] 47%|████▋     | 466/1000 [00:07<00:09, 58.27it/s] 47%|████▋     | 472/1000 [00:07<00:09, 56.27it/s] 48%|████▊     | 479/1000 [00:07<00:08, 59.72it/s] 49%|████▊     | 486/1000 [00:07<00:08, 62.05it/s] 49%|████▉     | 493/1000 [00:08<00:08, 59.76it/s] 50%|█████     | 500/1000 [00:08<00:08, 57.52it/s] 51%|█████     | 506/1000 [00:08<00:08, 57.27it/s] 51%|█████▏    | 513/1000 [00:08<00:08, 59.05it/s] 52%|█████▏    | 520/1000 [00:08<00:07, 61.88it/s] 53%|█████▎    | 527/1000 [00:08<00:07, 61.44it/s] 53%|█████▎    | 534/1000 [00:08<00:07, 60.08it/s] 54%|█████▍    | 541/1000 [00:08<00:07, 60.01it/s] 55%|█████▍    | 548/1000 [00:08<00:07, 61.12it/s] 56%|█████▌    | 557/1000 [00:09<00:06, 67.42it/s] 56%|█████▋    | 564/1000 [00:09<00:06, 64.15it/s] 57%|█████▋    | 571/1000 [00:09<00:06, 63.26it/s] 58%|█████▊    | 578/1000 [00:09<00:06, 61.64it/s] 58%|█████▊    | 585/1000 [00:09<00:06, 61.58it/s] 59%|█████▉    | 593/1000 [00:09<00:06, 65.96it/s] 60%|██████    | 600/1000 [00:09<00:05, 66.98it/s] 61%|██████    | 607/1000 [00:09<00:06, 63.91it/s] 61%|██████▏   | 614/1000 [00:09<00:06, 64.11it/s] 62%|██████▏   | 622/1000 [00:10<00:05, 66.90it/s] 63%|██████▎   | 629/1000 [00:10<00:05, 63.38it/s] 64%|██████▎   | 636/1000 [00:10<00:05, 63.84it/s] 64%|██████▍   | 643/1000 [00:10<00:05, 62.45it/s] 65%|██████▌   | 650/1000 [00:10<00:05, 60.98it/s] 66%|██████▌   | 657/1000 [00:10<00:05, 62.05it/s] 66%|██████▋   | 665/1000 [00:10<00:05, 63.63it/s] 67%|██████▋   | 672/1000 [00:10<00:05, 64.24it/s] 68%|██████▊   | 679/1000 [00:11<00:05, 63.65it/s] 69%|██████▊   | 686/1000 [00:11<00:04, 63.27it/s] 69%|██████▉   | 693/1000 [00:11<00:04, 61.61it/s] 70%|███████   | 700/1000 [00:11<00:04, 63.11it/s] 71%|███████   | 707/1000 [00:11<00:04, 63.99it/s] 71%|███████▏  | 714/1000 [00:11<00:04, 63.62it/s] 72%|███████▏  | 721/1000 [00:11<00:04, 60.06it/s] 73%|███████▎  | 728/1000 [00:11<00:04, 58.17it/s] 73%|███████▎  | 734/1000 [00:11<00:04, 56.74it/s] 74%|███████▍  | 741/1000 [00:12<00:04, 59.00it/s] 75%|███████▍  | 749/1000 [00:12<00:04, 62.61it/s] 76%|███████▌  | 756/1000 [00:12<00:03, 63.20it/s] 76%|███████▋  | 763/1000 [00:12<00:03, 62.82it/s] 77%|███████▋  | 770/1000 [00:12<00:03, 60.49it/s] 78%|███████▊  | 777/1000 [00:12<00:03, 59.44it/s] 78%|███████▊  | 784/1000 [00:12<00:03, 60.13it/s] 79%|███████▉  | 792/1000 [00:12<00:03, 64.29it/s] 80%|████████  | 800/1000 [00:12<00:03, 65.92it/s] 81%|████████  | 807/1000 [00:13<00:03, 63.07it/s] 81%|████████▏ | 814/1000 [00:13<00:03, 61.71it/s] 82%|████████▏ | 821/1000 [00:13<00:02, 61.89it/s] 83%|████████▎ | 828/1000 [00:13<00:02, 60.84it/s] 84%|████████▎ | 836/1000 [00:13<00:02, 64.43it/s] 84%|████████▍ | 844/1000 [00:13<00:02, 66.01it/s] 85%|████████▌ | 851/1000 [00:13<00:02, 61.54it/s] 86%|████████▌ | 858/1000 [00:13<00:02, 60.26it/s] 86%|████████▋ | 865/1000 [00:14<00:02, 61.65it/s] 87%|████████▋ | 872/1000 [00:14<00:02, 62.27it/s] 88%|████████▊ | 879/1000 [00:14<00:01, 64.20it/s] 89%|████████▊ | 886/1000 [00:14<00:01, 61.92it/s] 89%|████████▉ | 893/1000 [00:14<00:01, 61.12it/s] 90%|█████████ | 900/1000 [00:14<00:01, 61.18it/s] 91%|█████████ | 907/1000 [00:14<00:01, 59.63it/s] 91%|█████████▏| 914/1000 [00:14<00:01, 61.73it/s] 92%|█████████▏| 922/1000 [00:14<00:01, 65.48it/s] 93%|█████████▎| 929/1000 [00:15<00:01, 61.93it/s] 94%|█████████▎| 936/1000 [00:15<00:01, 61.06it/s] 94%|█████████▍| 943/1000 [00:15<00:00, 59.16it/s] 95%|█████████▍| 949/1000 [00:15<00:00, 57.26it/s] 96%|█████████▌| 956/1000 [00:15<00:00, 58.90it/s] 96%|█████████▋| 963/1000 [00:15<00:00, 61.37it/s] 97%|█████████▋| 970/1000 [00:15<00:00, 60.42it/s] 98%|█████████▊| 977/1000 [00:15<00:00, 60.99it/s] 98%|█████████▊| 984/1000 [00:15<00:00, 58.64it/s] 99%|█████████▉| 990/1000 [00:16<00:00, 57.74it/s]100%|█████████▉| 997/1000 [00:16<00:00, 60.45it/s]100%|██████████| 1000/1000 [00:16<00:00, 61.58it/s]

Clustering Summary (n_clusters=50):
  Mean within-cluster distance: 0.3500
  Mean between-cluster distance: 0.3794
  Separation ratio: 1.0839
  Cluster size distribution: min=1, max=145, mean=81.9

--- Analyzing with 100 clusters ---
Computing metrics for 100 clusters...
Computing within-cluster distances:   0%|          | 0/100 [00:00<?, ?it/s]Computing within-cluster distances:  14%|█▍        | 14/100 [00:00<00:00, 139.49it/s]Computing within-cluster distances:  28%|██▊       | 28/100 [00:00<00:00, 117.47it/s]Computing within-cluster distances:  40%|████      | 40/100 [00:00<00:00, 116.52it/s]Computing within-cluster distances:  52%|█████▏    | 52/100 [00:00<00:00, 115.20it/s]Computing within-cluster distances:  64%|██████▍   | 64/100 [00:00<00:00, 114.21it/s]Computing within-cluster distances:  76%|███████▌  | 76/100 [00:00<00:00, 113.74it/s]Computing within-cluster distances:  88%|████████▊ | 88/100 [00:00<00:00, 112.43it/s]Computing within-cluster distances: 100%|██████████| 100/100 [00:00<00:00, 112.90it/s]Computing within-cluster distances: 100%|██████████| 100/100 [00:00<00:00, 114.81it/s]
Computing between-cluster distances for 1000 cluster pairs...
  0%|          | 0/1000 [00:00<?, ?it/s]  1%|          | 10/1000 [00:00<00:10, 91.90it/s]  2%|▏         | 20/1000 [00:00<00:10, 93.39it/s]  3%|▎         | 30/1000 [00:00<00:10, 92.80it/s]  4%|▍         | 40/1000 [00:00<00:10, 92.54it/s]  5%|▌         | 50/1000 [00:00<00:10, 93.41it/s]  6%|▌         | 60/1000 [00:00<00:10, 92.01it/s]  7%|▋         | 70/1000 [00:00<00:10, 92.35it/s]  8%|▊         | 81/1000 [00:00<00:09, 95.73it/s]  9%|▉         | 91/1000 [00:00<00:09, 95.99it/s] 10%|█         | 101/1000 [00:01<00:09, 95.75it/s] 11%|█         | 111/1000 [00:01<00:09, 96.02it/s] 12%|█▏        | 121/1000 [00:01<00:09, 96.04it/s] 13%|█▎        | 131/1000 [00:01<00:09, 95.11it/s] 14%|█▍        | 141/1000 [00:01<00:09, 94.76it/s] 15%|█▌        | 152/1000 [00:01<00:08, 97.11it/s] 16%|█▌        | 162/1000 [00:01<00:08, 93.92it/s] 17%|█▋        | 172/1000 [00:01<00:08, 95.14it/s] 18%|█▊        | 183/1000 [00:01<00:08, 97.81it/s] 19%|█▉        | 194/1000 [00:02<00:08, 99.98it/s] 20%|██        | 205/1000 [00:02<00:08, 96.33it/s] 22%|██▏       | 215/1000 [00:02<00:08, 92.31it/s] 22%|██▎       | 225/1000 [00:02<00:08, 93.52it/s] 24%|██▎       | 235/1000 [00:02<00:08, 93.33it/s] 24%|██▍       | 245/1000 [00:02<00:08, 93.82it/s] 26%|██▌       | 255/1000 [00:02<00:07, 95.25it/s] 26%|██▋       | 265/1000 [00:02<00:07, 95.96it/s] 28%|██▊       | 275/1000 [00:02<00:07, 95.48it/s] 28%|██▊       | 285/1000 [00:03<00:07, 93.94it/s] 30%|██▉       | 295/1000 [00:03<00:07, 94.51it/s] 30%|███       | 305/1000 [00:03<00:07, 95.88it/s] 32%|███▏      | 315/1000 [00:03<00:07, 95.14it/s] 33%|███▎      | 326/1000 [00:03<00:06, 97.14it/s] 34%|███▎      | 337/1000 [00:03<00:06, 99.80it/s] 35%|███▍      | 347/1000 [00:03<00:06, 98.45it/s] 36%|███▌      | 357/1000 [00:03<00:06, 96.69it/s] 37%|███▋      | 368/1000 [00:03<00:06, 97.19it/s] 38%|███▊      | 379/1000 [00:03<00:06, 98.83it/s] 39%|███▉      | 389/1000 [00:04<00:06, 95.66it/s] 40%|███▉      | 399/1000 [00:04<00:06, 96.42it/s] 41%|████      | 410/1000 [00:04<00:06, 98.25it/s] 42%|████▏     | 420/1000 [00:04<00:05, 98.13it/s] 43%|████▎     | 430/1000 [00:04<00:05, 96.73it/s] 44%|████▍     | 440/1000 [00:04<00:05, 95.34it/s] 45%|████▌     | 450/1000 [00:04<00:05, 94.66it/s] 46%|████▌     | 461/1000 [00:04<00:05, 96.95it/s] 47%|████▋     | 471/1000 [00:04<00:05, 94.70it/s] 48%|████▊     | 481/1000 [00:05<00:05, 93.35it/s] 49%|████▉     | 491/1000 [00:05<00:05, 92.49it/s] 50%|█████     | 501/1000 [00:05<00:05, 92.58it/s] 51%|█████     | 511/1000 [00:05<00:05, 91.42it/s] 52%|█████▏    | 521/1000 [00:05<00:05, 93.34it/s] 53%|█████▎    | 532/1000 [00:05<00:04, 97.21it/s] 54%|█████▍    | 542/1000 [00:05<00:04, 98.00it/s] 55%|█████▌    | 552/1000 [00:05<00:04, 95.94it/s] 56%|█████▋    | 563/1000 [00:05<00:04, 99.56it/s] 57%|█████▋    | 573/1000 [00:05<00:04, 98.83it/s] 58%|█████▊    | 583/1000 [00:06<00:04, 98.87it/s] 59%|█████▉    | 593/1000 [00:06<00:04, 98.00it/s] 60%|██████    | 603/1000 [00:06<00:04, 97.14it/s] 61%|██████▏   | 613/1000 [00:06<00:04, 95.84it/s] 62%|██████▏   | 623/1000 [00:06<00:03, 95.84it/s] 63%|██████▎   | 633/1000 [00:06<00:03, 96.76it/s] 64%|██████▍   | 643/1000 [00:06<00:03, 95.27it/s] 65%|██████▌   | 654/1000 [00:06<00:03, 99.10it/s] 66%|██████▋   | 665/1000 [00:06<00:03, 101.30it/s] 68%|██████▊   | 676/1000 [00:07<00:03, 99.71it/s]  69%|██████▊   | 686/1000 [00:07<00:03, 97.86it/s] 70%|██████▉   | 696/1000 [00:07<00:03, 96.29it/s] 71%|███████   | 706/1000 [00:07<00:03, 96.74it/s] 72%|███████▏  | 716/1000 [00:07<00:02, 94.93it/s] 73%|███████▎  | 726/1000 [00:07<00:02, 94.83it/s] 74%|███████▎  | 737/1000 [00:07<00:02, 96.36it/s] 75%|███████▍  | 747/1000 [00:07<00:02, 96.40it/s] 76%|███████▌  | 757/1000 [00:07<00:02, 96.70it/s] 77%|███████▋  | 767/1000 [00:07<00:02, 96.30it/s] 78%|███████▊  | 778/1000 [00:08<00:02, 99.52it/s] 79%|███████▉  | 789/1000 [00:08<00:02, 99.93it/s] 80%|███████▉  | 799/1000 [00:08<00:02, 96.80it/s] 81%|████████  | 809/1000 [00:08<00:01, 97.70it/s] 82%|████████▏ | 819/1000 [00:08<00:01, 94.90it/s] 83%|████████▎ | 829/1000 [00:08<00:01, 95.39it/s] 84%|████████▍ | 840/1000 [00:08<00:01, 96.82it/s] 85%|████████▌ | 852/1000 [00:08<00:01, 101.46it/s] 86%|████████▋ | 863/1000 [00:08<00:01, 99.80it/s]  87%|████████▋ | 874/1000 [00:09<00:01, 101.56it/s] 88%|████████▊ | 885/1000 [00:09<00:01, 100.26it/s] 90%|████████▉ | 896/1000 [00:09<00:01, 99.94it/s]  91%|█████████ | 907/1000 [00:09<00:00, 97.99it/s] 92%|█████████▏| 917/1000 [00:09<00:00, 95.47it/s] 93%|█████████▎| 927/1000 [00:09<00:00, 92.35it/s] 94%|█████████▎| 937/1000 [00:09<00:00, 91.64it/s] 95%|█████████▍| 947/1000 [00:09<00:00, 89.36it/s] 96%|█████████▌| 956/1000 [00:09<00:00, 88.92it/s] 96%|█████████▋| 965/1000 [00:10<00:00, 88.32it/s] 98%|█████████▊| 975/1000 [00:10<00:00, 89.81it/s] 98%|█████████▊| 984/1000 [00:10<00:00, 89.28it/s] 99%|█████████▉| 993/1000 [00:10<00:00, 86.74it/s]100%|██████████| 1000/1000 [00:10<00:00, 95.50it/s]

Clustering Summary (n_clusters=100):
  Mean within-cluster distance: 0.3617
  Mean between-cluster distance: 0.3780
  Separation ratio: 1.0450
  Cluster size distribution: min=1, max=88, mean=41.0

--- Analyzing with 500 clusters ---
Computing metrics for 500 clusters...
Computing within-cluster distances:   0%|          | 0/500 [00:00<?, ?it/s]Computing within-cluster distances:  10%|▉         | 48/500 [00:00<00:00, 463.91it/s]Computing within-cluster distances:  19%|█▉        | 97/500 [00:00<00:00, 474.82it/s]Computing within-cluster distances:  29%|██▉       | 145/500 [00:00<00:00, 454.80it/s]Computing within-cluster distances:  39%|███▊      | 193/500 [00:00<00:00, 462.13it/s]Computing within-cluster distances:  48%|████▊     | 240/500 [00:00<00:00, 458.10it/s]Computing within-cluster distances:  58%|█████▊    | 289/500 [00:00<00:00, 467.98it/s]Computing within-cluster distances:  68%|██████▊   | 341/500 [00:00<00:00, 481.79it/s]Computing within-cluster distances:  78%|███████▊  | 390/500 [00:00<00:00, 450.33it/s]Computing within-cluster distances:  87%|████████▋ | 436/500 [00:00<00:00, 423.64it/s]Computing within-cluster distances:  96%|█████████▌| 479/500 [00:01<00:00, 410.84it/s]Computing within-cluster distances: 100%|██████████| 500/500 [00:01<00:00, 442.47it/s]
Computing between-cluster distances for 1000 cluster pairs...
  0%|          | 0/1000 [00:00<?, ?it/s]  3%|▎         | 26/1000 [00:00<00:03, 255.16it/s]  5%|▌         | 53/1000 [00:00<00:03, 262.76it/s]  8%|▊         | 80/1000 [00:00<00:03, 262.51it/s] 11%|█         | 107/1000 [00:00<00:03, 262.69it/s] 13%|█▎        | 134/1000 [00:00<00:03, 259.87it/s] 16%|█▌        | 160/1000 [00:00<00:03, 259.77it/s] 19%|█▊        | 186/1000 [00:00<00:03, 258.87it/s] 21%|██▏       | 213/1000 [00:00<00:03, 260.25it/s] 24%|██▍       | 240/1000 [00:00<00:02, 258.04it/s] 27%|██▋       | 268/1000 [00:01<00:02, 261.78it/s] 30%|██▉       | 295/1000 [00:01<00:02, 253.50it/s] 32%|███▏      | 322/1000 [00:01<00:02, 256.35it/s] 35%|███▍      | 348/1000 [00:01<00:02, 255.80it/s] 37%|███▋      | 374/1000 [00:01<00:02, 256.00it/s] 40%|████      | 400/1000 [00:01<00:02, 254.91it/s] 43%|████▎     | 428/1000 [00:01<00:02, 259.35it/s] 45%|████▌     | 454/1000 [00:01<00:02, 259.39it/s] 48%|████▊     | 481/1000 [00:01<00:01, 259.87it/s] 51%|█████     | 508/1000 [00:01<00:01, 260.58it/s] 54%|█████▎    | 535/1000 [00:02<00:01, 251.15it/s] 56%|█████▌    | 561/1000 [00:02<00:01, 251.04it/s] 59%|█████▉    | 589/1000 [00:02<00:01, 258.71it/s] 62%|██████▏   | 615/1000 [00:02<00:01, 257.63it/s] 64%|██████▍   | 642/1000 [00:02<00:01, 260.78it/s] 67%|██████▋   | 669/1000 [00:02<00:01, 261.12it/s] 70%|██████▉   | 696/1000 [00:02<00:01, 261.70it/s] 73%|███████▎  | 726/1000 [00:02<00:01, 271.20it/s] 75%|███████▌  | 754/1000 [00:02<00:00, 266.95it/s] 78%|███████▊  | 781/1000 [00:03<00:00, 266.85it/s] 81%|████████  | 810/1000 [00:03<00:00, 270.76it/s] 84%|████████▍ | 838/1000 [00:03<00:00, 269.62it/s] 86%|████████▋ | 865/1000 [00:03<00:00, 266.97it/s] 89%|████████▉ | 892/1000 [00:03<00:00, 266.88it/s] 92%|█████████▏| 920/1000 [00:03<00:00, 268.82it/s] 95%|█████████▍| 947/1000 [00:03<00:00, 258.80it/s] 97%|█████████▋| 973/1000 [00:03<00:00, 255.99it/s]100%|██████████| 1000/1000 [00:03<00:00, 260.97it/s]

Clustering Summary (n_clusters=500):
  Mean within-cluster distance: 0.3661
  Mean between-cluster distance: 0.3763
  Separation ratio: 1.0280
  Cluster size distribution: min=1, max=37, mean=8.2

--- Analyzing with 1000 clusters ---
Computing metrics for 1000 clusters...
Computing within-cluster distances:   0%|          | 0/1000 [00:00<?, ?it/s]Computing within-cluster distances:  13%|█▎        | 132/1000 [00:00<00:00, 1319.69it/s]Computing within-cluster distances:  26%|██▋       | 264/1000 [00:00<00:00, 1282.08it/s]Computing within-cluster distances:  40%|████      | 400/1000 [00:00<00:00, 1313.88it/s]Computing within-cluster distances:  53%|█████▎    | 532/1000 [00:00<00:00, 1290.08it/s]Computing within-cluster distances:  67%|██████▋   | 671/1000 [00:00<00:00, 1322.34it/s]Computing within-cluster distances:  80%|████████  | 804/1000 [00:00<00:00, 1220.10it/s]Computing within-cluster distances:  93%|█████████▎| 928/1000 [00:00<00:00, 1224.47it/s]Computing within-cluster distances: 100%|██████████| 1000/1000 [00:00<00:00, 1249.55it/s]
Computing between-cluster distances for 1000 cluster pairs...
  0%|          | 0/1000 [00:00<?, ?it/s]  6%|▌         | 62/1000 [00:00<00:01, 607.63it/s] 12%|█▏        | 123/1000 [00:00<00:01, 597.61it/s] 18%|█▊        | 185/1000 [00:00<00:01, 604.69it/s] 25%|██▍       | 246/1000 [00:00<00:01, 564.37it/s] 30%|███       | 304/1000 [00:00<00:01, 568.67it/s] 36%|███▌      | 362/1000 [00:00<00:01, 562.43it/s] 42%|████▏     | 422/1000 [00:00<00:01, 572.93it/s] 48%|████▊     | 480/1000 [00:00<00:00, 574.50it/s] 54%|█████▍    | 541/1000 [00:00<00:00, 584.69it/s] 60%|██████    | 602/1000 [00:01<00:00, 590.32it/s] 66%|██████▌   | 662/1000 [00:01<00:00, 588.73it/s] 72%|███████▏  | 721/1000 [00:01<00:00, 572.20it/s] 78%|███████▊  | 784/1000 [00:01<00:00, 588.32it/s] 84%|████████▍ | 843/1000 [00:01<00:00, 575.77it/s] 90%|█████████ | 902/1000 [00:01<00:00, 578.74it/s] 96%|█████████▌| 960/1000 [00:01<00:00, 573.55it/s]100%|██████████| 1000/1000 [00:01<00:00, 580.05it/s]

Clustering Summary (n_clusters=1000):
  Mean within-cluster distance: 0.3358
  Mean between-cluster distance: 0.3751
  Separation ratio: 1.1173
  Cluster size distribution: min=1, max=37, mean=4.1

--- Analyzing with 2000 clusters ---
Computing metrics for 2000 clusters...
Computing within-cluster distances:   0%|          | 0/2000 [00:00<?, ?it/s]Computing within-cluster distances:  15%|█▍        | 291/2000 [00:00<00:00, 2900.18it/s]Computing within-cluster distances:  29%|██▉       | 582/2000 [00:00<00:00, 2846.97it/s]Computing within-cluster distances:  44%|████▍     | 888/2000 [00:00<00:00, 2942.08it/s]Computing within-cluster distances:  59%|█████▉    | 1183/2000 [00:00<00:00, 2912.89it/s]Computing within-cluster distances:  74%|███████▍  | 1479/2000 [00:00<00:00, 2929.49it/s]Computing within-cluster distances:  89%|████████▊ | 1773/2000 [00:00<00:00, 2793.58it/s]Computing within-cluster distances: 100%|██████████| 2000/2000 [00:00<00:00, 2847.93it/s]
Computing between-cluster distances for 1000 cluster pairs...
  0%|          | 0/1000 [00:00<?, ?it/s] 13%|█▎        | 133/1000 [00:00<00:00, 1319.76it/s] 26%|██▋       | 265/1000 [00:00<00:00, 1292.09it/s] 40%|███▉      | 399/1000 [00:00<00:00, 1309.09it/s] 53%|█████▎    | 530/1000 [00:00<00:00, 1276.86it/s] 67%|██████▋   | 666/1000 [00:00<00:00, 1305.91it/s] 81%|████████  | 806/1000 [00:00<00:00, 1333.39it/s] 94%|█████████▍| 940/1000 [00:00<00:00, 1303.88it/s]100%|██████████| 1000/1000 [00:00<00:00, 1304.91it/s]

Clustering Summary (n_clusters=2000):
  Mean within-cluster distance: 0.1769
  Mean between-cluster distance: 0.3741
  Separation ratio: 2.1153
  Cluster size distribution: min=1, max=37, mean=2.0

============================================================
Total computation time: 9.50 minutes
============================================================
✓ Intermediate results saved to: /home/datadi/burns/aws/workloads/results/metrics/agglomerative_clustering/sparsegpt/agglomerative_clustering_up_proj_full_results.json

============================================================
FULL ANALYSIS: /home/datadi/burns/aws/workloads/data/sparsegpt_unstructured/layer3-mlp.up_proj.pt
============================================================
Matrix shape: torch.Size([11008, 4096])
Computing pairwise Hamming distances for ALL 4096 features...
Distance matrix computed (shape: (8386560,))
Computing hierarchical clustering linkage with method='ward'...
Linkage matrix computed

--- Analyzing with 10 clusters ---
Computing metrics for 10 clusters...
Computing within-cluster distances:   0%|          | 0/10 [00:00<?, ?it/s]Computing within-cluster distances:  60%|██████    | 6/10 [00:00<00:00, 48.96it/s]Computing within-cluster distances: 100%|██████████| 10/10 [00:00<00:00, 48.92it/s]
Computing between-cluster distances for 45 cluster pairs...
  0%|          | 0/45 [00:00<?, ?it/s]  7%|▋         | 3/45 [00:00<00:01, 28.51it/s] 18%|█▊        | 8/45 [00:00<00:01, 35.14it/s] 29%|██▉       | 13/45 [00:00<00:00, 38.27it/s] 38%|███▊      | 17/45 [00:00<00:00, 37.10it/s] 47%|████▋     | 21/45 [00:00<00:00, 35.61it/s] 56%|█████▌    | 25/45 [00:00<00:00, 35.27it/s] 67%|██████▋   | 30/45 [00:00<00:00, 38.55it/s] 76%|███████▌  | 34/45 [00:00<00:00, 38.71it/s] 87%|████████▋ | 39/45 [00:01<00:00, 39.92it/s] 98%|█████████▊| 44/45 [00:01<00:00, 39.35it/s]100%|██████████| 45/45 [00:01<00:00, 37.63it/s]

Clustering Summary (n_clusters=10):
  Mean within-cluster distance: 0.2943
  Mean between-cluster distance: 0.3970
  Separation ratio: 1.3490
  Cluster size distribution: min=1, max=945, mean=409.6

--- Analyzing with 50 clusters ---
Computing metrics for 50 clusters...
Computing within-cluster distances:   0%|          | 0/50 [00:00<?, ?it/s]Computing within-cluster distances:  16%|█▌        | 8/50 [00:00<00:00, 79.68it/s]Computing within-cluster distances:  32%|███▏      | 16/50 [00:00<00:00, 77.76it/s]Computing within-cluster distances:  48%|████▊     | 24/50 [00:00<00:00, 77.02it/s]Computing within-cluster distances:  64%|██████▍   | 32/50 [00:00<00:00, 78.12it/s]Computing within-cluster distances:  80%|████████  | 40/50 [00:00<00:00, 77.50it/s]Computing within-cluster distances:  96%|█████████▌| 48/50 [00:00<00:00, 76.52it/s]Computing within-cluster distances: 100%|██████████| 50/50 [00:00<00:00, 78.56it/s]
Computing between-cluster distances for 1000 cluster pairs...
  0%|          | 0/1000 [00:00<?, ?it/s]  1%|          | 7/1000 [00:00<00:15, 63.88it/s]  1%|▏         | 14/1000 [00:00<00:16, 60.68it/s]  2%|▏         | 21/1000 [00:00<00:15, 63.75it/s]  3%|▎         | 28/1000 [00:00<00:15, 61.69it/s]  4%|▎         | 35/1000 [00:00<00:15, 61.55it/s]  4%|▍         | 42/1000 [00:00<00:15, 62.64it/s]  5%|▍         | 49/1000 [00:00<00:14, 63.75it/s]  6%|▌         | 56/1000 [00:00<00:14, 64.13it/s]  6%|▋         | 64/1000 [00:01<00:14, 66.02it/s]  7%|▋         | 71/1000 [00:01<00:14, 64.03it/s]  8%|▊         | 78/1000 [00:01<00:14, 61.62it/s]  9%|▊         | 86/1000 [00:01<00:14, 64.38it/s]  9%|▉         | 93/1000 [00:01<00:13, 64.89it/s] 10%|█         | 100/1000 [00:01<00:13, 65.05it/s] 11%|█         | 107/1000 [00:01<00:14, 63.08it/s] 11%|█▏        | 114/1000 [00:01<00:13, 63.61it/s] 12%|█▏        | 121/1000 [00:01<00:13, 63.87it/s] 13%|█▎        | 129/1000 [00:02<00:13, 66.11it/s] 14%|█▎        | 136/1000 [00:02<00:12, 66.70it/s] 14%|█▍        | 143/1000 [00:02<00:13, 65.20it/s] 15%|█▌        | 150/1000 [00:02<00:13, 62.95it/s] 16%|█▌        | 158/1000 [00:02<00:12, 66.20it/s] 16%|█▋        | 165/1000 [00:02<00:12, 64.97it/s] 17%|█▋        | 172/1000 [00:02<00:13, 63.19it/s] 18%|█▊        | 179/1000 [00:02<00:13, 63.11it/s] 19%|█▊        | 186/1000 [00:02<00:13, 61.73it/s] 19%|█▉        | 193/1000 [00:03<00:13, 60.65it/s] 20%|██        | 200/1000 [00:03<00:13, 59.16it/s] 21%|██        | 207/1000 [00:03<00:13, 60.55it/s] 21%|██▏       | 214/1000 [00:03<00:13, 58.66it/s] 22%|██▏       | 220/1000 [00:03<00:13, 58.93it/s] 23%|██▎       | 226/1000 [00:03<00:13, 58.82it/s] 23%|██▎       | 233/1000 [00:03<00:12, 59.20it/s] 24%|██▍       | 239/1000 [00:03<00:13, 57.68it/s] 25%|██▍       | 246/1000 [00:03<00:12, 58.26it/s] 25%|██▌       | 252/1000 [00:04<00:12, 57.83it/s] 26%|██▌       | 258/1000 [00:04<00:12, 57.11it/s] 26%|██▋       | 264/1000 [00:04<00:13, 55.21it/s] 27%|██▋       | 271/1000 [00:04<00:12, 58.14it/s] 28%|██▊       | 278/1000 [00:04<00:12, 59.46it/s] 28%|██▊       | 284/1000 [00:04<00:12, 59.18it/s] 29%|██▉       | 290/1000 [00:04<00:12, 57.22it/s] 30%|██▉       | 296/1000 [00:04<00:12, 54.65it/s] 30%|███       | 303/1000 [00:04<00:12, 57.85it/s] 31%|███       | 309/1000 [00:05<00:12, 57.57it/s] 32%|███▏      | 315/1000 [00:05<00:11, 57.45it/s] 32%|███▏      | 322/1000 [00:05<00:11, 59.32it/s] 33%|███▎      | 329/1000 [00:05<00:11, 59.65it/s] 34%|███▎      | 336/1000 [00:05<00:11, 60.07it/s] 34%|███▍      | 343/1000 [00:05<00:11, 58.71it/s] 35%|███▍      | 349/1000 [00:05<00:11, 58.72it/s] 36%|███▌      | 356/1000 [00:05<00:10, 59.97it/s] 36%|███▋      | 363/1000 [00:05<00:10, 58.84it/s] 37%|███▋      | 369/1000 [00:06<00:10, 58.33it/s] 38%|███▊      | 375/1000 [00:06<00:10, 57.38it/s] 38%|███▊      | 381/1000 [00:06<00:10, 57.54it/s] 39%|███▊      | 387/1000 [00:06<00:10, 57.09it/s] 39%|███▉      | 394/1000 [00:06<00:10, 59.41it/s] 40%|████      | 400/1000 [00:06<00:10, 59.29it/s] 41%|████      | 406/1000 [00:06<00:10, 58.83it/s] 41%|████      | 412/1000 [00:06<00:10, 57.41it/s] 42%|████▏     | 418/1000 [00:06<00:10, 56.24it/s] 42%|████▏     | 424/1000 [00:07<00:10, 56.27it/s] 43%|████▎     | 431/1000 [00:07<00:09, 57.86it/s] 44%|████▍     | 438/1000 [00:07<00:09, 59.73it/s] 44%|████▍     | 445/1000 [00:07<00:09, 60.83it/s] 45%|████▌     | 452/1000 [00:07<00:09, 60.77it/s] 46%|████▌     | 459/1000 [00:07<00:08, 62.50it/s] 47%|████▋     | 466/1000 [00:07<00:08, 60.49it/s] 47%|████▋     | 473/1000 [00:07<00:08, 60.92it/s] 48%|████▊     | 480/1000 [00:07<00:08, 60.93it/s] 49%|████▊     | 487/1000 [00:08<00:08, 60.19it/s] 49%|████▉     | 494/1000 [00:08<00:08, 62.38it/s] 50%|█████     | 501/1000 [00:08<00:07, 62.63it/s] 51%|█████     | 508/1000 [00:08<00:07, 64.35it/s] 52%|█████▏    | 515/1000 [00:08<00:07, 62.19it/s] 52%|█████▏    | 522/1000 [00:08<00:07, 61.55it/s] 53%|█████▎    | 529/1000 [00:08<00:07, 60.71it/s] 54%|█████▎    | 536/1000 [00:08<00:07, 60.80it/s] 54%|█████▍    | 543/1000 [00:08<00:07, 60.51it/s] 55%|█████▌    | 550/1000 [00:09<00:07, 61.03it/s] 56%|█████▌    | 557/1000 [00:09<00:07, 61.44it/s] 56%|█████▋    | 564/1000 [00:09<00:06, 63.61it/s] 57%|█████▋    | 571/1000 [00:09<00:06, 62.96it/s] 58%|█████▊    | 578/1000 [00:09<00:06, 63.26it/s] 58%|█████▊    | 585/1000 [00:09<00:06, 63.04it/s] 59%|█████▉    | 592/1000 [00:09<00:06, 62.04it/s] 60%|█████▉    | 599/1000 [00:09<00:06, 63.87it/s] 61%|██████    | 606/1000 [00:09<00:06, 64.90it/s] 61%|██████▏   | 613/1000 [00:10<00:06, 64.22it/s] 62%|██████▏   | 620/1000 [00:10<00:06, 63.13it/s] 63%|██████▎   | 627/1000 [00:10<00:05, 62.39it/s] 64%|██████▎   | 635/1000 [00:10<00:05, 64.21it/s] 64%|██████▍   | 642/1000 [00:10<00:05, 62.76it/s] 65%|██████▌   | 650/1000 [00:10<00:05, 66.08it/s] 66%|██████▌   | 657/1000 [00:10<00:05, 65.46it/s] 66%|██████▋   | 664/1000 [00:10<00:05, 61.94it/s] 67%|██████▋   | 671/1000 [00:10<00:05, 63.82it/s] 68%|██████▊   | 678/1000 [00:11<00:04, 64.84it/s] 68%|██████▊   | 685/1000 [00:11<00:04, 65.69it/s] 69%|██████▉   | 692/1000 [00:11<00:04, 64.32it/s] 70%|██████▉   | 699/1000 [00:11<00:04, 65.47it/s] 71%|███████   | 706/1000 [00:11<00:04, 65.05it/s] 71%|███████▏  | 713/1000 [00:11<00:04, 64.61it/s] 72%|███████▏  | 720/1000 [00:11<00:04, 62.33it/s] 73%|███████▎  | 727/1000 [00:11<00:04, 63.80it/s] 73%|███████▎  | 734/1000 [00:11<00:04, 64.14it/s] 74%|███████▍  | 741/1000 [00:12<00:04, 64.42it/s] 75%|███████▍  | 748/1000 [00:12<00:03, 65.64it/s] 76%|███████▌  | 755/1000 [00:12<00:03, 65.28it/s] 76%|███████▌  | 762/1000 [00:12<00:03, 66.12it/s] 77%|███████▋  | 769/1000 [00:12<00:03, 64.44it/s] 78%|███████▊  | 776/1000 [00:12<00:03, 62.15it/s] 78%|███████▊  | 783/1000 [00:12<00:03, 63.38it/s] 79%|███████▉  | 791/1000 [00:12<00:03, 65.11it/s] 80%|███████▉  | 798/1000 [00:12<00:03, 63.85it/s] 80%|████████  | 805/1000 [00:13<00:03, 64.02it/s] 81%|████████  | 812/1000 [00:13<00:03, 61.19it/s] 82%|████████▏ | 819/1000 [00:13<00:03, 59.12it/s] 83%|████████▎ | 826/1000 [00:13<00:02, 61.90it/s] 83%|████████▎ | 833/1000 [00:13<00:02, 61.47it/s] 84%|████████▍ | 841/1000 [00:13<00:02, 65.91it/s] 85%|████████▍ | 848/1000 [00:13<00:02, 65.54it/s] 86%|████████▌ | 855/1000 [00:13<00:02, 62.91it/s] 86%|████████▌ | 862/1000 [00:13<00:02, 59.78it/s] 87%|████████▋ | 869/1000 [00:14<00:02, 60.57it/s] 88%|████████▊ | 876/1000 [00:14<00:01, 62.52it/s] 88%|████████▊ | 884/1000 [00:14<00:01, 65.31it/s] 89%|████████▉ | 891/1000 [00:14<00:01, 66.09it/s] 90%|████████▉ | 898/1000 [00:14<00:01, 64.12it/s] 90%|█████████ | 905/1000 [00:14<00:01, 61.26it/s] 91%|█████████ | 912/1000 [00:14<00:01, 61.36it/s] 92%|█████████▏| 919/1000 [00:14<00:01, 63.63it/s] 93%|█████████▎| 926/1000 [00:14<00:01, 62.05it/s] 93%|█████████▎| 933/1000 [00:15<00:01, 62.46it/s] 94%|█████████▍| 940/1000 [00:15<00:01, 59.91it/s] 95%|█████████▍| 948/1000 [00:15<00:00, 62.84it/s] 96%|█████████▌| 955/1000 [00:15<00:00, 61.62it/s] 96%|█████████▌| 962/1000 [00:15<00:00, 61.24it/s] 97%|█████████▋| 969/1000 [00:15<00:00, 62.47it/s] 98%|█████████▊| 976/1000 [00:15<00:00, 63.19it/s] 98%|█████████▊| 983/1000 [00:15<00:00, 61.37it/s] 99%|█████████▉| 990/1000 [00:16<00:00, 58.55it/s]100%|█████████▉| 997/1000 [00:16<00:00, 58.68it/s]100%|██████████| 1000/1000 [00:16<00:00, 61.67it/s]

Clustering Summary (n_clusters=50):
  Mean within-cluster distance: 0.3671
  Mean between-cluster distance: 0.3798
  Separation ratio: 1.0344
  Cluster size distribution: min=1, max=136, mean=81.9

--- Analyzing with 100 clusters ---
Computing metrics for 100 clusters...
Computing within-cluster distances:   0%|          | 0/100 [00:00<?, ?it/s]Computing within-cluster distances:  12%|█▏        | 12/100 [00:00<00:00, 118.69it/s]Computing within-cluster distances:  24%|██▍       | 24/100 [00:00<00:00, 107.92it/s]Computing within-cluster distances:  35%|███▌      | 35/100 [00:00<00:00, 105.04it/s]Computing within-cluster distances:  47%|████▋     | 47/100 [00:00<00:00, 108.42it/s]Computing within-cluster distances:  58%|█████▊    | 58/100 [00:00<00:00, 107.07it/s]Computing within-cluster distances:  69%|██████▉   | 69/100 [00:00<00:00, 106.79it/s]Computing within-cluster distances:  81%|████████  | 81/100 [00:00<00:00, 109.92it/s]Computing within-cluster distances:  93%|█████████▎| 93/100 [00:00<00:00, 108.81it/s]Computing within-cluster distances: 100%|██████████| 100/100 [00:00<00:00, 109.70it/s]
Computing between-cluster distances for 1000 cluster pairs...
  0%|          | 0/1000 [00:00<?, ?it/s]  1%|          | 10/1000 [00:00<00:10, 94.52it/s]  2%|▏         | 20/1000 [00:00<00:11, 86.68it/s]  3%|▎         | 31/1000 [00:00<00:10, 91.52it/s]  4%|▍         | 41/1000 [00:00<00:10, 89.84it/s]  5%|▌         | 52/1000 [00:00<00:09, 94.96it/s]  6%|▌         | 62/1000 [00:00<00:09, 96.32it/s]  7%|▋         | 72/1000 [00:00<00:09, 93.13it/s]  8%|▊         | 82/1000 [00:00<00:09, 94.68it/s]  9%|▉         | 92/1000 [00:00<00:09, 91.31it/s] 10%|█         | 103/1000 [00:01<00:09, 95.68it/s] 11%|█▏        | 113/1000 [00:01<00:09, 91.89it/s] 12%|█▏        | 123/1000 [00:01<00:09, 91.49it/s] 13%|█▎        | 133/1000 [00:01<00:09, 89.77it/s] 14%|█▍        | 143/1000 [00:01<00:09, 91.41it/s] 15%|█▌        | 154/1000 [00:01<00:08, 94.39it/s] 16%|█▋        | 164/1000 [00:01<00:08, 95.60it/s] 17%|█▋        | 174/1000 [00:01<00:08, 93.55it/s] 18%|█▊        | 184/1000 [00:01<00:08, 92.04it/s] 19%|█▉        | 194/1000 [00:02<00:08, 92.75it/s] 20%|██        | 204/1000 [00:02<00:08, 91.30it/s] 21%|██▏       | 214/1000 [00:02<00:08, 92.95it/s] 22%|██▏       | 224/1000 [00:02<00:08, 88.28it/s] 23%|██▎       | 234/1000 [00:02<00:08, 89.27it/s] 24%|██▍       | 243/1000 [00:02<00:08, 86.83it/s] 25%|██▌       | 252/1000 [00:02<00:08, 86.81it/s] 26%|██▌       | 262/1000 [00:02<00:08, 87.84it/s] 27%|██▋       | 271/1000 [00:02<00:08, 88.00it/s] 28%|██▊       | 281/1000 [00:03<00:07, 90.22it/s] 29%|██▉       | 291/1000 [00:03<00:07, 90.88it/s] 30%|███       | 302/1000 [00:03<00:07, 94.38it/s] 31%|███▏      | 313/1000 [00:03<00:07, 96.84it/s] 32%|███▏      | 323/1000 [00:03<00:07, 96.50it/s] 33%|███▎      | 334/1000 [00:03<00:06, 98.47it/s] 34%|███▍      | 344/1000 [00:03<00:06, 97.03it/s] 35%|███▌      | 354/1000 [00:03<00:06, 97.22it/s] 36%|███▋      | 365/1000 [00:03<00:06, 100.34it/s] 38%|███▊      | 376/1000 [00:04<00:06, 99.38it/s]  39%|███▊      | 386/1000 [00:04<00:06, 97.48it/s] 40%|███▉      | 396/1000 [00:04<00:06, 93.68it/s] 41%|████      | 406/1000 [00:04<00:06, 95.11it/s] 42%|████▏     | 416/1000 [00:04<00:06, 95.94it/s] 43%|████▎     | 426/1000 [00:04<00:06, 93.16it/s] 44%|████▎     | 437/1000 [00:04<00:05, 96.52it/s] 45%|████▍     | 448/1000 [00:04<00:05, 97.95it/s] 46%|████▌     | 458/1000 [00:04<00:05, 96.10it/s] 47%|████▋     | 468/1000 [00:05<00:05, 95.19it/s] 48%|████▊     | 478/1000 [00:05<00:05, 93.34it/s] 49%|████▉     | 488/1000 [00:05<00:05, 91.63it/s] 50%|████▉     | 498/1000 [00:05<00:05, 90.19it/s] 51%|█████     | 508/1000 [00:05<00:05, 89.06it/s] 52%|█████▏    | 518/1000 [00:05<00:05, 89.69it/s] 53%|█████▎    | 528/1000 [00:05<00:05, 91.63it/s] 54%|█████▍    | 538/1000 [00:05<00:05, 90.91it/s] 55%|█████▍    | 548/1000 [00:05<00:04, 92.77it/s] 56%|█████▌    | 560/1000 [00:05<00:04, 99.51it/s] 57%|█████▋    | 570/1000 [00:06<00:04, 94.85it/s] 58%|█████▊    | 581/1000 [00:06<00:04, 96.24it/s] 59%|█████▉    | 591/1000 [00:06<00:04, 92.70it/s] 60%|██████    | 603/1000 [00:06<00:04, 98.19it/s] 61%|██████▏   | 614/1000 [00:06<00:03, 99.15it/s] 62%|██████▏   | 624/1000 [00:06<00:03, 96.82it/s] 64%|██████▎   | 636/1000 [00:06<00:03, 101.39it/s] 65%|██████▍   | 647/1000 [00:06<00:03, 97.54it/s]  66%|██████▌   | 658/1000 [00:07<00:03, 99.25it/s] 67%|██████▋   | 669/1000 [00:07<00:03, 100.94it/s] 68%|██████▊   | 680/1000 [00:07<00:03, 99.50it/s]  69%|██████▉   | 690/1000 [00:07<00:03, 98.78it/s] 70%|███████   | 700/1000 [00:07<00:03, 94.37it/s] 71%|███████   | 710/1000 [00:07<00:03, 93.80it/s] 72%|███████▏  | 720/1000 [00:07<00:02, 93.43it/s] 73%|███████▎  | 730/1000 [00:07<00:02, 91.58it/s] 74%|███████▍  | 740/1000 [00:07<00:02, 93.03it/s] 75%|███████▌  | 750/1000 [00:07<00:02, 90.43it/s] 76%|███████▌  | 760/1000 [00:08<00:02, 89.92it/s] 77%|███████▋  | 770/1000 [00:08<00:02, 91.69it/s] 78%|███████▊  | 780/1000 [00:08<00:02, 93.63it/s] 79%|███████▉  | 790/1000 [00:08<00:02, 92.37it/s] 80%|████████  | 800/1000 [00:08<00:02, 91.69it/s] 81%|████████  | 810/1000 [00:08<00:02, 89.61it/s] 82%|████████▏ | 819/1000 [00:08<00:02, 89.18it/s] 83%|████████▎ | 829/1000 [00:08<00:01, 89.93it/s] 84%|████████▍ | 840/1000 [00:08<00:01, 92.17it/s] 85%|████████▌ | 850/1000 [00:09<00:01, 92.03it/s] 86%|████████▌ | 860/1000 [00:09<00:01, 88.60it/s] 87%|████████▋ | 870/1000 [00:09<00:01, 90.88it/s] 88%|████████▊ | 880/1000 [00:09<00:01, 90.37it/s] 89%|████████▉ | 890/1000 [00:09<00:01, 92.16it/s] 90%|█████████ | 901/1000 [00:09<00:01, 94.88it/s] 91%|█████████ | 911/1000 [00:09<00:00, 93.81it/s] 92%|█████████▏| 922/1000 [00:09<00:00, 96.25it/s] 93%|█████████▎| 932/1000 [00:09<00:00, 96.64it/s] 94%|█████████▍| 942/1000 [00:10<00:00, 95.67it/s] 95%|█████████▌| 952/1000 [00:10<00:00, 94.81it/s] 96%|█████████▌| 962/1000 [00:10<00:00, 96.26it/s] 97%|█████████▋| 973/1000 [00:10<00:00, 96.90it/s] 98%|█████████▊| 983/1000 [00:10<00:00, 95.74it/s] 99%|█████████▉| 994/1000 [00:10<00:00, 98.08it/s]100%|██████████| 1000/1000 [00:10<00:00, 93.90it/s]

Clustering Summary (n_clusters=100):
  Mean within-cluster distance: 0.3615
  Mean between-cluster distance: 0.3787
  Separation ratio: 1.0474
  Cluster size distribution: min=1, max=77, mean=41.0

--- Analyzing with 500 clusters ---
Computing metrics for 500 clusters...
Computing within-cluster distances:   0%|          | 0/500 [00:00<?, ?it/s]Computing within-cluster distances:   9%|▉         | 46/500 [00:00<00:01, 447.25it/s]Computing within-cluster distances:  18%|█▊        | 91/500 [00:00<00:00, 444.63it/s]Computing within-cluster distances:  27%|██▋       | 136/500 [00:00<00:00, 432.67it/s]Computing within-cluster distances:  36%|███▌      | 181/500 [00:00<00:00, 437.00it/s]Computing within-cluster distances:  45%|████▌     | 227/500 [00:00<00:00, 442.03it/s]Computing within-cluster distances:  54%|█████▍    | 272/500 [00:00<00:00, 442.41it/s]Computing within-cluster distances:  64%|██████▎   | 318/500 [00:00<00:00, 447.70it/s]Computing within-cluster distances:  73%|███████▎  | 364/500 [00:00<00:00, 450.85it/s]Computing within-cluster distances:  83%|████████▎ | 414/500 [00:00<00:00, 465.25it/s]Computing within-cluster distances:  92%|█████████▏| 461/500 [00:01<00:00, 462.31it/s]Computing within-cluster distances: 100%|██████████| 500/500 [00:01<00:00, 455.57it/s]
Computing between-cluster distances for 1000 cluster pairs...
  0%|          | 0/1000 [00:00<?, ?it/s]  3%|▎         | 27/1000 [00:00<00:03, 268.72it/s]  5%|▌         | 54/1000 [00:00<00:03, 268.29it/s]  8%|▊         | 81/1000 [00:00<00:03, 259.45it/s] 11%|█         | 109/1000 [00:00<00:03, 264.80it/s] 14%|█▎        | 137/1000 [00:00<00:03, 268.46it/s] 16%|█▋        | 164/1000 [00:00<00:03, 264.62it/s] 19%|█▉        | 192/1000 [00:00<00:03, 268.20it/s] 22%|██▏       | 219/1000 [00:00<00:02, 265.51it/s] 25%|██▍       | 247/1000 [00:00<00:02, 267.30it/s] 27%|██▋       | 274/1000 [00:01<00:02, 264.56it/s] 30%|███       | 301/1000 [00:01<00:02, 263.68it/s] 33%|███▎      | 329/1000 [00:01<00:02, 264.72it/s] 36%|███▌      | 356/1000 [00:01<00:02, 265.12it/s] 38%|███▊      | 383/1000 [00:01<00:02, 258.60it/s] 41%|████      | 410/1000 [00:01<00:02, 259.25it/s] 44%|████▎     | 437/1000 [00:01<00:02, 261.90it/s] 46%|████▋     | 464/1000 [00:01<00:02, 260.54it/s] 49%|████▉     | 491/1000 [00:01<00:01, 262.60it/s] 52%|█████▏    | 518/1000 [00:01<00:01, 261.25it/s] 55%|█████▍    | 545/1000 [00:02<00:01, 257.67it/s] 57%|█████▋    | 571/1000 [00:02<00:01, 255.05it/s] 60%|█████▉    | 599/1000 [00:02<00:01, 261.19it/s] 63%|██████▎   | 628/1000 [00:02<00:01, 268.57it/s] 66%|██████▌   | 656/1000 [00:02<00:01, 268.76it/s] 68%|██████▊   | 684/1000 [00:02<00:01, 270.41it/s] 71%|███████   | 712/1000 [00:02<00:01, 264.72it/s] 74%|███████▍  | 739/1000 [00:02<00:00, 265.25it/s] 77%|███████▋  | 766/1000 [00:02<00:00, 257.88it/s] 79%|███████▉  | 792/1000 [00:03<00:00, 258.06it/s] 82%|████████▏ | 818/1000 [00:03<00:00, 253.66it/s] 85%|████████▍ | 846/1000 [00:03<00:00, 260.70it/s] 87%|████████▋ | 873/1000 [00:03<00:00, 261.09it/s] 90%|█████████ | 900/1000 [00:03<00:00, 260.51it/s] 93%|█████████▎| 927/1000 [00:03<00:00, 257.26it/s] 95%|█████████▌| 953/1000 [00:03<00:00, 256.79it/s] 98%|█████████▊| 980/1000 [00:03<00:00, 259.78it/s]100%|██████████| 1000/1000 [00:03<00:00, 262.18it/s]

Clustering Summary (n_clusters=500):
  Mean within-cluster distance: 0.3663
  Mean between-cluster distance: 0.3761
  Separation ratio: 1.0267
  Cluster size distribution: min=1, max=29, mean=8.2

--- Analyzing with 1000 clusters ---
Computing metrics for 1000 clusters...
Computing within-cluster distances:   0%|          | 0/1000 [00:00<?, ?it/s]Computing within-cluster distances:  13%|█▎        | 129/1000 [00:00<00:00, 1274.49it/s]Computing within-cluster distances:  26%|██▌       | 258/1000 [00:00<00:00, 1276.77it/s]Computing within-cluster distances:  39%|███▊      | 386/1000 [00:00<00:00, 1213.42it/s]Computing within-cluster distances:  51%|█████     | 508/1000 [00:00<00:00, 1167.29it/s]Computing within-cluster distances:  64%|██████▍   | 641/1000 [00:00<00:00, 1221.15it/s]Computing within-cluster distances:  78%|███████▊  | 776/1000 [00:00<00:00, 1260.12it/s]Computing within-cluster distances:  90%|█████████ | 905/1000 [00:00<00:00, 1266.93it/s]Computing within-cluster distances: 100%|██████████| 1000/1000 [00:00<00:00, 1261.48it/s]
Computing between-cluster distances for 1000 cluster pairs...
  0%|          | 0/1000 [00:00<?, ?it/s]  6%|▌         | 61/1000 [00:00<00:01, 597.26it/s] 12%|█▏        | 123/1000 [00:00<00:01, 606.03it/s] 18%|█▊        | 184/1000 [00:00<00:01, 579.97it/s] 24%|██▍       | 243/1000 [00:00<00:01, 571.89it/s] 31%|███       | 306/1000 [00:00<00:01, 589.59it/s] 37%|███▋      | 366/1000 [00:00<00:01, 579.51it/s] 43%|████▎     | 428/1000 [00:00<00:00, 590.56it/s] 49%|████▉     | 488/1000 [00:00<00:00, 581.15it/s] 55%|█████▍    | 549/1000 [00:00<00:00, 589.03it/s] 61%|██████    | 611/1000 [00:01<00:00, 596.54it/s] 67%|██████▋   | 671/1000 [00:01<00:00, 595.46it/s] 73%|███████▎  | 731/1000 [00:01<00:00, 581.33it/s] 79%|███████▉  | 790/1000 [00:01<00:00, 568.39it/s] 85%|████████▍ | 847/1000 [00:01<00:00, 568.02it/s] 90%|█████████ | 905/1000 [00:01<00:00, 569.44it/s] 96%|█████████▋| 964/1000 [00:01<00:00, 572.89it/s]100%|██████████| 1000/1000 [00:01<00:00, 577.70it/s]

Clustering Summary (n_clusters=1000):
  Mean within-cluster distance: 0.3444
  Mean between-cluster distance: 0.3753
  Separation ratio: 1.0899
  Cluster size distribution: min=1, max=29, mean=4.1

--- Analyzing with 2000 clusters ---
Computing metrics for 2000 clusters...
Computing within-cluster distances:   0%|          | 0/2000 [00:00<?, ?it/s]Computing within-cluster distances:  14%|█▍        | 289/2000 [00:00<00:00, 2884.54it/s]Computing within-cluster distances:  29%|██▉       | 583/2000 [00:00<00:00, 2914.89it/s]Computing within-cluster distances:  44%|████▍     | 875/2000 [00:00<00:00, 2789.41it/s]Computing within-cluster distances:  58%|█████▊    | 1170/2000 [00:00<00:00, 2847.41it/s]Computing within-cluster distances:  74%|███████▎  | 1472/2000 [00:00<00:00, 2906.12it/s]Computing within-cluster distances:  89%|████████▊ | 1771/2000 [00:00<00:00, 2932.38it/s]Computing within-cluster distances: 100%|██████████| 2000/2000 [00:00<00:00, 2918.42it/s]
Computing between-cluster distances for 1000 cluster pairs...
  0%|          | 0/1000 [00:00<?, ?it/s] 13%|█▎        | 134/1000 [00:00<00:00, 1332.51it/s] 27%|██▋       | 268/1000 [00:00<00:00, 1330.24it/s] 40%|████      | 402/1000 [00:00<00:00, 1333.30it/s] 54%|█████▎    | 536/1000 [00:00<00:00, 1316.98it/s] 67%|██████▋   | 668/1000 [00:00<00:00, 1310.46it/s] 80%|████████  | 803/1000 [00:00<00:00, 1321.42it/s] 94%|█████████▍| 938/1000 [00:00<00:00, 1329.25it/s]100%|██████████| 1000/1000 [00:00<00:00, 1331.91it/s]

Clustering Summary (n_clusters=2000):
  Mean within-cluster distance: 0.1820
  Mean between-cluster distance: 0.3748
  Separation ratio: 2.0591
  Cluster size distribution: min=1, max=29, mean=2.0

============================================================
Total computation time: 9.49 minutes
============================================================
✓ Intermediate results saved to: /home/datadi/burns/aws/workloads/results/metrics/agglomerative_clustering/sparsegpt/agglomerative_clustering_up_proj_full_results.json

============================================================
✓ FULL SparseGPT up_proj analysis complete!
============================================================
