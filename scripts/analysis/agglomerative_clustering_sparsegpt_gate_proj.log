Found 31 gate_proj matrices to analyze

============================================================
FULL ANALYSIS: /home/datadi/burns/aws/workloads/data/sparsegpt_unstructured/layer0-mlp.gate_proj.pt
============================================================
Matrix shape: torch.Size([11008, 4096])
Computing pairwise Hamming distances for ALL 4096 features...
Distance matrix computed (shape: (8386560,))
Computing hierarchical clustering linkage with method='ward'...
Linkage matrix computed

--- Analyzing with 10 clusters ---
Computing metrics for 10 clusters...
Computing within-cluster distances:   0%|          | 0/10 [00:00<?, ?it/s]Computing within-cluster distances:  60%|██████    | 6/10 [00:00<00:00, 48.12it/s]Computing within-cluster distances: 100%|██████████| 10/10 [00:00<00:00, 42.10it/s]
Computing between-cluster distances for 45 cluster pairs...
  0%|          | 0/45 [00:00<?, ?it/s]  9%|▉         | 4/45 [00:00<00:01, 32.96it/s] 18%|█▊        | 8/45 [00:00<00:01, 32.80it/s] 29%|██▉       | 13/45 [00:00<00:00, 38.84it/s] 38%|███▊      | 17/45 [00:00<00:00, 35.51it/s] 47%|████▋     | 21/45 [00:00<00:00, 34.58it/s] 56%|█████▌    | 25/45 [00:00<00:00, 35.95it/s] 67%|██████▋   | 30/45 [00:00<00:00, 35.99it/s] 76%|███████▌  | 34/45 [00:00<00:00, 34.41it/s] 84%|████████▍ | 38/45 [00:01<00:00, 34.72it/s] 93%|█████████▎| 42/45 [00:01<00:00, 35.63it/s]100%|██████████| 45/45 [00:01<00:00, 35.44it/s]

Clustering Summary (n_clusters=10):
  Mean within-cluster distance: 0.3927
  Mean between-cluster distance: 0.4052
  Separation ratio: 1.0318
  Cluster size distribution: min=8, max=1064, mean=409.6

--- Analyzing with 50 clusters ---
Computing metrics for 50 clusters...
Computing within-cluster distances:   0%|          | 0/50 [00:00<?, ?it/s]Computing within-cluster distances:  26%|██▌       | 13/50 [00:00<00:00, 119.43it/s]Computing within-cluster distances:  50%|█████     | 25/50 [00:00<00:00, 103.94it/s]Computing within-cluster distances:  72%|███████▏  | 36/50 [00:00<00:00, 75.62it/s] Computing within-cluster distances:  90%|█████████ | 45/50 [00:00<00:00, 73.13it/s]Computing within-cluster distances: 100%|██████████| 50/50 [00:00<00:00, 79.89it/s]
Computing between-cluster distances for 1000 cluster pairs...
  0%|          | 0/1000 [00:00<?, ?it/s]  1%|          | 7/1000 [00:00<00:15, 66.08it/s]  1%|▏         | 14/1000 [00:00<00:16, 58.67it/s]  2%|▏         | 20/1000 [00:00<00:16, 58.07it/s]  3%|▎         | 28/1000 [00:00<00:15, 64.00it/s]  4%|▎         | 35/1000 [00:00<00:15, 63.68it/s]  4%|▍         | 42/1000 [00:00<00:14, 64.74it/s]  5%|▍         | 49/1000 [00:00<00:15, 60.87it/s]  6%|▌         | 56/1000 [00:00<00:15, 61.94it/s]  6%|▋         | 63/1000 [00:01<00:15, 59.71it/s]  7%|▋         | 70/1000 [00:01<00:14, 62.15it/s]  8%|▊         | 77/1000 [00:01<00:15, 60.43it/s]  8%|▊         | 84/1000 [00:01<00:15, 59.39it/s]  9%|▉         | 90/1000 [00:01<00:15, 58.90it/s] 10%|▉         | 97/1000 [00:01<00:14, 61.37it/s] 10%|█         | 105/1000 [00:01<00:13, 65.92it/s] 11%|█         | 112/1000 [00:01<00:13, 64.71it/s] 12%|█▏        | 119/1000 [00:01<00:13, 64.28it/s] 13%|█▎        | 126/1000 [00:02<00:13, 64.77it/s] 13%|█▎        | 133/1000 [00:02<00:13, 65.98it/s] 14%|█▍        | 140/1000 [00:02<00:13, 63.05it/s] 15%|█▍        | 148/1000 [00:02<00:12, 67.21it/s] 16%|█▌        | 155/1000 [00:02<00:12, 66.64it/s] 16%|█▌        | 162/1000 [00:02<00:12, 66.87it/s] 17%|█▋        | 169/1000 [00:02<00:12, 65.97it/s] 18%|█▊        | 176/1000 [00:02<00:12, 66.92it/s] 18%|█▊        | 184/1000 [00:02<00:11, 70.58it/s] 19%|█▉        | 192/1000 [00:02<00:11, 68.96it/s] 20%|█▉        | 199/1000 [00:03<00:12, 65.97it/s] 21%|██        | 206/1000 [00:03<00:12, 64.82it/s] 21%|██▏       | 213/1000 [00:03<00:12, 61.55it/s] 22%|██▏       | 222/1000 [00:03<00:11, 66.44it/s] 23%|██▎       | 229/1000 [00:03<00:11, 64.88it/s] 24%|██▎       | 236/1000 [00:03<00:12, 63.00it/s] 24%|██▍       | 244/1000 [00:03<00:11, 67.11it/s] 25%|██▌       | 251/1000 [00:03<00:11, 65.98it/s] 26%|██▌       | 258/1000 [00:04<00:11, 62.83it/s] 26%|██▋       | 265/1000 [00:04<00:11, 62.85it/s] 28%|██▊       | 275/1000 [00:04<00:10, 71.95it/s] 28%|██▊       | 283/1000 [00:04<00:10, 69.07it/s] 29%|██▉       | 291/1000 [00:04<00:10, 70.73it/s] 30%|██▉       | 299/1000 [00:04<00:10, 68.37it/s] 31%|███       | 306/1000 [00:04<00:10, 65.20it/s] 31%|███▏      | 313/1000 [00:04<00:10, 64.63it/s] 32%|███▏      | 320/1000 [00:04<00:10, 65.91it/s] 33%|███▎      | 328/1000 [00:05<00:09, 68.63it/s] 34%|███▎      | 336/1000 [00:05<00:09, 69.98it/s] 34%|███▍      | 344/1000 [00:05<00:09, 69.83it/s] 35%|███▌      | 352/1000 [00:05<00:09, 66.65it/s] 36%|███▌      | 361/1000 [00:05<00:09, 70.05it/s] 37%|███▋      | 369/1000 [00:05<00:09, 69.50it/s] 38%|███▊      | 376/1000 [00:05<00:09, 68.34it/s] 38%|███▊      | 383/1000 [00:05<00:09, 66.86it/s] 39%|███▉      | 390/1000 [00:05<00:09, 64.90it/s] 40%|███▉      | 397/1000 [00:06<00:09, 66.27it/s] 40%|████      | 405/1000 [00:06<00:08, 67.08it/s] 41%|████▏     | 413/1000 [00:06<00:08, 68.92it/s] 42%|████▏     | 420/1000 [00:06<00:08, 68.75it/s] 43%|████▎     | 427/1000 [00:06<00:08, 66.70it/s] 44%|████▎     | 435/1000 [00:06<00:08, 67.63it/s] 44%|████▍     | 443/1000 [00:06<00:08, 67.93it/s] 45%|████▌     | 450/1000 [00:06<00:08, 65.40it/s] 46%|████▌     | 457/1000 [00:06<00:08, 63.84it/s] 46%|████▋     | 464/1000 [00:07<00:08, 63.01it/s] 47%|████▋     | 471/1000 [00:07<00:08, 64.16it/s] 48%|████▊     | 478/1000 [00:07<00:08, 64.09it/s] 48%|████▊     | 485/1000 [00:07<00:08, 63.86it/s] 49%|████▉     | 492/1000 [00:07<00:08, 63.28it/s] 50%|████▉     | 499/1000 [00:07<00:08, 58.50it/s] 51%|█████     | 506/1000 [00:07<00:08, 59.99it/s] 51%|█████▏    | 513/1000 [00:07<00:07, 62.21it/s] 52%|█████▏    | 520/1000 [00:07<00:07, 62.37it/s] 53%|█████▎    | 527/1000 [00:08<00:07, 60.99it/s] 53%|█████▎    | 534/1000 [00:08<00:07, 62.62it/s] 54%|█████▍    | 541/1000 [00:08<00:07, 61.63it/s] 55%|█████▍    | 549/1000 [00:08<00:06, 66.33it/s] 56%|█████▌    | 556/1000 [00:08<00:06, 65.30it/s] 56%|█████▋    | 563/1000 [00:08<00:06, 65.88it/s] 57%|█████▋    | 570/1000 [00:08<00:06, 62.75it/s] 58%|█████▊    | 577/1000 [00:08<00:07, 59.42it/s] 58%|█████▊    | 584/1000 [00:09<00:06, 62.14it/s] 59%|█████▉    | 591/1000 [00:09<00:06, 59.91it/s] 60%|█████▉    | 598/1000 [00:09<00:06, 57.81it/s] 60%|██████    | 605/1000 [00:09<00:06, 57.49it/s] 61%|██████    | 611/1000 [00:09<00:06, 57.81it/s] 62%|██████▏   | 619/1000 [00:09<00:06, 62.01it/s] 63%|██████▎   | 626/1000 [00:09<00:06, 58.76it/s] 63%|██████▎   | 633/1000 [00:09<00:06, 59.14it/s] 64%|██████▍   | 640/1000 [00:09<00:05, 61.91it/s] 65%|██████▍   | 647/1000 [00:10<00:05, 60.66it/s] 66%|██████▌   | 656/1000 [00:10<00:05, 66.33it/s] 66%|██████▋   | 663/1000 [00:10<00:05, 62.74it/s] 67%|██████▋   | 670/1000 [00:10<00:05, 63.77it/s] 68%|██████▊   | 678/1000 [00:10<00:04, 66.85it/s] 68%|██████▊   | 685/1000 [00:10<00:04, 63.15it/s] 69%|██████▉   | 693/1000 [00:10<00:04, 65.74it/s] 70%|███████   | 700/1000 [00:10<00:04, 64.46it/s] 71%|███████   | 707/1000 [00:10<00:04, 63.36it/s] 71%|███████▏  | 714/1000 [00:11<00:04, 61.49it/s] 72%|███████▏  | 721/1000 [00:11<00:04, 60.06it/s] 73%|███████▎  | 729/1000 [00:11<00:04, 63.19it/s] 74%|███████▎  | 736/1000 [00:11<00:04, 59.74it/s] 74%|███████▍  | 744/1000 [00:11<00:04, 62.69it/s] 75%|███████▌  | 751/1000 [00:11<00:04, 58.76it/s] 76%|███████▌  | 759/1000 [00:11<00:03, 61.25it/s] 77%|███████▋  | 767/1000 [00:11<00:03, 64.94it/s] 77%|███████▋  | 774/1000 [00:12<00:03, 63.17it/s] 78%|███████▊  | 783/1000 [00:12<00:03, 70.03it/s] 79%|███████▉  | 791/1000 [00:12<00:03, 69.31it/s] 80%|███████▉  | 799/1000 [00:12<00:02, 70.88it/s] 81%|████████  | 807/1000 [00:12<00:02, 68.64it/s] 82%|████████▏ | 815/1000 [00:12<00:02, 71.25it/s] 82%|████████▏ | 823/1000 [00:12<00:02, 72.40it/s] 83%|████████▎ | 831/1000 [00:12<00:02, 71.69it/s] 84%|████████▍ | 839/1000 [00:12<00:02, 71.86it/s] 85%|████████▍ | 847/1000 [00:13<00:02, 67.95it/s] 85%|████████▌ | 854/1000 [00:13<00:02, 67.72it/s] 86%|████████▌ | 862/1000 [00:13<00:01, 69.57it/s] 87%|████████▋ | 870/1000 [00:13<00:01, 71.58it/s] 88%|████████▊ | 878/1000 [00:13<00:01, 69.92it/s] 89%|████████▊ | 886/1000 [00:13<00:01, 69.37it/s] 89%|████████▉ | 893/1000 [00:13<00:01, 65.93it/s] 90%|█████████ | 901/1000 [00:13<00:01, 66.71it/s] 91%|█████████ | 908/1000 [00:13<00:01, 66.58it/s] 92%|█████████▏| 917/1000 [00:14<00:01, 72.76it/s] 92%|█████████▎| 925/1000 [00:14<00:01, 70.36it/s] 93%|█████████▎| 933/1000 [00:14<00:00, 67.02it/s] 94%|█████████▍| 940/1000 [00:14<00:00, 64.96it/s] 95%|█████████▍| 947/1000 [00:14<00:00, 65.80it/s] 96%|█████████▌| 955/1000 [00:14<00:00, 67.56it/s] 96%|█████████▋| 963/1000 [00:14<00:00, 68.64it/s] 97%|█████████▋| 970/1000 [00:14<00:00, 69.00it/s] 98%|█████████▊| 977/1000 [00:15<00:00, 67.72it/s] 98%|█████████▊| 984/1000 [00:15<00:00, 63.27it/s] 99%|█████████▉| 993/1000 [00:15<00:00, 68.09it/s]100%|██████████| 1000/1000 [00:15<00:00, 67.28it/s]100%|██████████| 1000/1000 [00:15<00:00, 65.13it/s]

Clustering Summary (n_clusters=50):
  Mean within-cluster distance: 0.3722
  Mean between-cluster distance: 0.4072
  Separation ratio: 1.0941
  Cluster size distribution: min=1, max=455, mean=81.9

--- Analyzing with 100 clusters ---
Computing metrics for 100 clusters...
Computing within-cluster distances:   0%|          | 0/100 [00:00<?, ?it/s]Computing within-cluster distances:  17%|█▋        | 17/100 [00:00<00:00, 165.04it/s]Computing within-cluster distances:  35%|███▌      | 35/100 [00:00<00:00, 171.18it/s]Computing within-cluster distances:  53%|█████▎    | 53/100 [00:00<00:00, 160.59it/s]Computing within-cluster distances:  70%|███████   | 70/100 [00:00<00:00, 116.62it/s]Computing within-cluster distances:  83%|████████▎ | 83/100 [00:00<00:00, 116.37it/s]Computing within-cluster distances:  96%|█████████▌| 96/100 [00:00<00:00, 113.03it/s]Computing within-cluster distances: 100%|██████████| 100/100 [00:00<00:00, 124.08it/s]
Computing between-cluster distances for 1000 cluster pairs...
  0%|          | 0/1000 [00:00<?, ?it/s]  1%|          | 9/1000 [00:00<00:11, 89.14it/s]  2%|▏         | 21/1000 [00:00<00:09, 106.17it/s]  3%|▎         | 32/1000 [00:00<00:09, 99.69it/s]   4%|▍         | 43/1000 [00:00<00:09, 101.67it/s]  5%|▌         | 54/1000 [00:00<00:10, 93.09it/s]   6%|▋         | 65/1000 [00:00<00:09, 97.61it/s]  8%|▊         | 75/1000 [00:00<00:10, 88.99it/s]  9%|▊         | 86/1000 [00:00<00:09, 93.19it/s] 10%|▉         | 96/1000 [00:01<00:09, 91.06it/s] 11%|█         | 106/1000 [00:01<00:09, 90.76it/s] 12%|█▏        | 116/1000 [00:01<00:10, 87.68it/s] 12%|█▎        | 125/1000 [00:01<00:09, 88.18it/s] 14%|█▎        | 135/1000 [00:01<00:09, 88.44it/s] 14%|█▍        | 145/1000 [00:01<00:09, 90.54it/s] 16%|█▌        | 156/1000 [00:01<00:08, 95.34it/s] 17%|█▋        | 166/1000 [00:01<00:08, 93.44it/s] 18%|█▊        | 176/1000 [00:01<00:09, 90.69it/s] 19%|█▊        | 186/1000 [00:02<00:09, 89.92it/s] 20%|█▉        | 197/1000 [00:02<00:08, 95.41it/s] 21%|██        | 207/1000 [00:02<00:08, 96.00it/s] 22%|██▏       | 220/1000 [00:02<00:07, 103.58it/s] 23%|██▎       | 232/1000 [00:02<00:07, 105.76it/s] 24%|██▍       | 243/1000 [00:02<00:07, 102.19it/s] 25%|██▌       | 254/1000 [00:02<00:07, 99.76it/s]  26%|██▋       | 265/1000 [00:02<00:07, 102.48it/s] 28%|██▊       | 276/1000 [00:02<00:07, 103.09it/s] 29%|██▊       | 287/1000 [00:02<00:06, 104.76it/s] 30%|██▉       | 298/1000 [00:03<00:06, 103.22it/s] 31%|███       | 311/1000 [00:03<00:06, 108.03it/s] 32%|███▏      | 322/1000 [00:03<00:06, 105.19it/s] 33%|███▎      | 334/1000 [00:03<00:06, 109.10it/s] 34%|███▍      | 345/1000 [00:03<00:06, 107.87it/s] 36%|███▌      | 356/1000 [00:03<00:06, 107.07it/s] 37%|███▋      | 367/1000 [00:03<00:06, 102.24it/s] 38%|███▊      | 379/1000 [00:03<00:05, 106.12it/s] 39%|███▉      | 390/1000 [00:03<00:05, 104.56it/s] 40%|████      | 401/1000 [00:04<00:05, 104.41it/s] 41%|████▏     | 413/1000 [00:04<00:05, 107.39it/s] 42%|████▏     | 424/1000 [00:04<00:05, 104.35it/s] 44%|████▎     | 435/1000 [00:04<00:05, 105.37it/s] 45%|████▍     | 446/1000 [00:04<00:05, 104.07it/s] 46%|████▌     | 457/1000 [00:04<00:05, 104.05it/s] 47%|████▋     | 468/1000 [00:04<00:05, 100.65it/s] 48%|████▊     | 479/1000 [00:04<00:05, 100.63it/s] 49%|████▉     | 490/1000 [00:04<00:05, 101.39it/s] 50%|█████     | 501/1000 [00:05<00:04, 102.08it/s] 51%|█████     | 512/1000 [00:05<00:04, 102.53it/s] 52%|█████▏    | 523/1000 [00:05<00:04, 95.96it/s]  53%|█████▎    | 533/1000 [00:05<00:04, 95.42it/s] 54%|█████▍    | 544/1000 [00:05<00:04, 97.77it/s] 55%|█████▌    | 554/1000 [00:05<00:04, 97.36it/s] 56%|█████▋    | 564/1000 [00:05<00:04, 95.80it/s] 57%|█████▋    | 574/1000 [00:05<00:04, 95.53it/s] 59%|█████▊    | 586/1000 [00:05<00:04, 99.96it/s] 60%|█████▉    | 597/1000 [00:06<00:03, 101.63it/s] 61%|██████    | 608/1000 [00:06<00:03, 100.58it/s] 62%|██████▏   | 619/1000 [00:06<00:03, 97.25it/s]  63%|██████▎   | 630/1000 [00:06<00:03, 100.21it/s] 64%|██████▍   | 641/1000 [00:06<00:03, 100.12it/s] 65%|██████▌   | 652/1000 [00:06<00:03, 99.62it/s]  66%|██████▋   | 664/1000 [00:06<00:03, 105.01it/s] 68%|██████▊   | 675/1000 [00:06<00:03, 105.68it/s] 69%|██████▊   | 686/1000 [00:06<00:02, 104.98it/s] 70%|██████▉   | 697/1000 [00:06<00:02, 101.87it/s] 71%|███████   | 709/1000 [00:07<00:02, 105.79it/s] 72%|███████▏  | 720/1000 [00:07<00:02, 106.73it/s] 73%|███████▎  | 731/1000 [00:07<00:02, 104.09it/s] 74%|███████▍  | 743/1000 [00:07<00:02, 105.96it/s] 76%|███████▌  | 756/1000 [00:07<00:02, 110.32it/s] 77%|███████▋  | 768/1000 [00:07<00:02, 103.07it/s] 78%|███████▊  | 779/1000 [00:07<00:02, 101.32it/s] 79%|███████▉  | 790/1000 [00:07<00:02, 101.46it/s] 80%|████████  | 801/1000 [00:07<00:01, 100.79it/s] 81%|████████▏ | 813/1000 [00:08<00:01, 105.87it/s] 82%|████████▎ | 825/1000 [00:08<00:01, 107.35it/s] 84%|████████▎ | 837/1000 [00:08<00:01, 106.37it/s] 85%|████████▍ | 848/1000 [00:08<00:01, 102.32it/s] 86%|████████▌ | 859/1000 [00:08<00:01, 100.39it/s] 87%|████████▋ | 872/1000 [00:08<00:01, 104.69it/s] 88%|████████▊ | 883/1000 [00:08<00:01, 102.42it/s] 89%|████████▉ | 894/1000 [00:08<00:01, 99.80it/s]  90%|█████████ | 905/1000 [00:08<00:00, 100.86it/s] 92%|█████████▏| 916/1000 [00:09<00:00, 102.45it/s] 93%|█████████▎| 927/1000 [00:09<00:00, 103.07it/s] 94%|█████████▍| 938/1000 [00:09<00:00, 99.71it/s]  95%|█████████▍| 949/1000 [00:09<00:00, 102.38it/s] 96%|█████████▌| 960/1000 [00:09<00:00, 100.25it/s] 97%|█████████▋| 971/1000 [00:09<00:00, 98.85it/s]  98%|█████████▊| 982/1000 [00:09<00:00, 99.97it/s] 99%|█████████▉| 993/1000 [00:09<00:00, 102.59it/s]100%|██████████| 1000/1000 [00:09<00:00, 100.73it/s]

Clustering Summary (n_clusters=100):
  Mean within-cluster distance: 0.3718
  Mean between-cluster distance: 0.4022
  Separation ratio: 1.0817
  Cluster size distribution: min=1, max=239, mean=41.0

--- Analyzing with 500 clusters ---
Computing metrics for 500 clusters...
Computing within-cluster distances:   0%|          | 0/500 [00:00<?, ?it/s]Computing within-cluster distances:  13%|█▎        | 64/500 [00:00<00:00, 611.43it/s]Computing within-cluster distances:  38%|███▊      | 188/500 [00:00<00:00, 972.98it/s]Computing within-cluster distances:  57%|█████▋    | 286/500 [00:00<00:00, 828.61it/s]Computing within-cluster distances:  74%|███████▍  | 372/500 [00:00<00:00, 398.68it/s]Computing within-cluster distances:  86%|████████▋ | 432/500 [00:00<00:00, 384.58it/s]Computing within-cluster distances: 100%|██████████| 500/500 [00:01<00:00, 486.52it/s]
Computing between-cluster distances for 1000 cluster pairs...
  0%|          | 0/1000 [00:00<?, ?it/s]  3%|▎         | 29/1000 [00:00<00:03, 284.80it/s]  6%|▌         | 58/1000 [00:00<00:03, 287.05it/s] 10%|▉         | 98/1000 [00:00<00:02, 333.16it/s] 13%|█▎        | 134/1000 [00:00<00:02, 343.36it/s] 17%|█▋        | 169/1000 [00:00<00:02, 332.16it/s] 20%|██        | 203/1000 [00:00<00:02, 333.54it/s] 24%|██▎       | 237/1000 [00:00<00:02, 329.37it/s] 27%|██▋       | 270/1000 [00:00<00:02, 325.41it/s] 30%|███       | 303/1000 [00:00<00:02, 323.78it/s] 34%|███▎      | 336/1000 [00:01<00:02, 322.24it/s] 37%|███▋      | 369/1000 [00:01<00:02, 302.18it/s] 40%|████      | 400/1000 [00:01<00:02, 293.06it/s] 43%|████▎     | 432/1000 [00:01<00:01, 299.34it/s] 47%|████▋     | 472/1000 [00:01<00:01, 327.20it/s] 51%|█████     | 507/1000 [00:01<00:01, 328.84it/s] 54%|█████▍    | 541/1000 [00:01<00:01, 328.02it/s] 57%|█████▊    | 575/1000 [00:01<00:01, 325.58it/s] 61%|██████    | 612/1000 [00:01<00:01, 338.07it/s] 65%|██████▍   | 646/1000 [00:01<00:01, 331.12it/s] 68%|██████▊   | 680/1000 [00:02<00:00, 330.26it/s] 71%|███████▏  | 714/1000 [00:02<00:00, 327.28it/s] 75%|███████▍  | 749/1000 [00:02<00:00, 332.85it/s] 78%|███████▊  | 783/1000 [00:02<00:00, 307.94it/s] 82%|████████▏ | 815/1000 [00:02<00:00, 307.78it/s] 85%|████████▍ | 847/1000 [00:02<00:00, 307.40it/s] 88%|████████▊ | 878/1000 [00:02<00:00, 296.68it/s] 91%|█████████▏| 913/1000 [00:02<00:00, 308.83it/s] 95%|█████████▌| 950/1000 [00:02<00:00, 323.48it/s] 98%|█████████▊| 983/1000 [00:03<00:00, 293.56it/s]100%|██████████| 1000/1000 [00:03<00:00, 316.69it/s]

Clustering Summary (n_clusters=500):
  Mean within-cluster distance: 0.3153
  Mean between-cluster distance: 0.3908
  Separation ratio: 1.2396
  Cluster size distribution: min=1, max=239, mean=8.2

--- Analyzing with 1000 clusters ---
Computing metrics for 1000 clusters...
Computing within-cluster distances:   0%|          | 0/1000 [00:00<?, ?it/s]Computing within-cluster distances:  15%|█▍        | 148/1000 [00:00<00:00, 1467.43it/s]Computing within-cluster distances:  41%|████      | 409/1000 [00:00<00:00, 2133.19it/s]Computing within-cluster distances:  62%|██████▏   | 623/1000 [00:00<00:00, 1035.03it/s]Computing within-cluster distances:  77%|███████▋  | 769/1000 [00:00<00:00, 852.35it/s] Computing within-cluster distances:  88%|████████▊ | 882/1000 [00:00<00:00, 805.95it/s]Computing within-cluster distances: 100%|██████████| 1000/1000 [00:00<00:00, 1002.82it/s]
Computing between-cluster distances for 1000 cluster pairs...
  0%|          | 0/1000 [00:00<?, ?it/s]  6%|▌         | 61/1000 [00:00<00:01, 597.07it/s] 14%|█▎        | 135/1000 [00:00<00:01, 679.70it/s] 20%|██        | 204/1000 [00:00<00:01, 606.70it/s] 27%|██▋       | 266/1000 [00:00<00:01, 586.65it/s] 33%|███▎      | 326/1000 [00:00<00:01, 585.94it/s] 40%|███▉      | 397/1000 [00:00<00:00, 623.47it/s] 46%|████▌     | 462/1000 [00:00<00:00, 631.71it/s] 53%|█████▎    | 526/1000 [00:00<00:00, 624.04it/s] 60%|█████▉    | 597/1000 [00:00<00:00, 646.94it/s] 67%|██████▋   | 668/1000 [00:01<00:00, 665.82it/s] 74%|███████▍  | 744/1000 [00:01<00:00, 688.31it/s] 81%|████████▏ | 813/1000 [00:01<00:00, 650.35it/s] 88%|████████▊ | 881/1000 [00:01<00:00, 657.91it/s] 96%|█████████▌| 960/1000 [00:01<00:00, 694.63it/s]100%|██████████| 1000/1000 [00:01<00:00, 651.25it/s]

Clustering Summary (n_clusters=1000):
  Mean within-cluster distance: 0.2205
  Mean between-cluster distance: 0.3866
  Separation ratio: 1.7531
  Cluster size distribution: min=1, max=193, mean=4.1

--- Analyzing with 2000 clusters ---
Computing metrics for 2000 clusters...
Computing within-cluster distances:   0%|          | 0/2000 [00:00<?, ?it/s]Computing within-cluster distances:  18%|█▊        | 353/2000 [00:00<00:00, 3526.04it/s]Computing within-cluster distances:  41%|████▏     | 827/2000 [00:00<00:00, 4236.39it/s]Computing within-cluster distances:  63%|██████▎   | 1251/2000 [00:00<00:00, 1887.75it/s]Computing within-cluster distances:  77%|███████▋  | 1534/2000 [00:00<00:00, 2057.23it/s]Computing within-cluster distances:  90%|█████████ | 1808/2000 [00:00<00:00, 2109.46it/s]Computing within-cluster distances: 100%|██████████| 2000/2000 [00:00<00:00, 2366.06it/s]
Computing between-cluster distances for 1000 cluster pairs...
  0%|          | 0/1000 [00:00<?, ?it/s] 13%|█▎        | 134/1000 [00:00<00:00, 1323.08it/s] 27%|██▋       | 267/1000 [00:00<00:00, 1175.55it/s] 39%|███▉      | 394/1000 [00:00<00:00, 1214.99it/s] 53%|█████▎    | 533/1000 [00:00<00:00, 1278.65it/s] 66%|██████▌   | 662/1000 [00:00<00:00, 1236.79it/s] 80%|███████▉  | 795/1000 [00:00<00:00, 1266.51it/s] 92%|█████████▏| 923/1000 [00:00<00:00, 1240.77it/s]100%|██████████| 1000/1000 [00:00<00:00, 1228.84it/s]

Clustering Summary (n_clusters=2000):
  Mean within-cluster distance: 0.1056
  Mean between-cluster distance: 0.3774
  Separation ratio: 3.5729
  Cluster size distribution: min=1, max=162, mean=2.0

============================================================
Total computation time: 9.03 minutes
============================================================
✓ Intermediate results saved to: /home/datadi/burns/aws/workloads/results/metrics/agglomerative_clustering/sparsegpt/agglomerative_clustering_gate_proj_full_results.json

============================================================
FULL ANALYSIS: /home/datadi/burns/aws/workloads/data/sparsegpt_unstructured/layer2-mlp.gate_proj.pt
============================================================
Matrix shape: torch.Size([11008, 4096])
Computing pairwise Hamming distances for ALL 4096 features...
Distance matrix computed (shape: (8386560,))
Computing hierarchical clustering linkage with method='ward'...
Linkage matrix computed

--- Analyzing with 10 clusters ---
Computing metrics for 10 clusters...
Computing within-cluster distances:   0%|          | 0/10 [00:00<?, ?it/s]Computing within-cluster distances:  40%|████      | 4/10 [00:00<00:00, 33.55it/s]Computing within-cluster distances: 100%|██████████| 10/10 [00:00<00:00, 46.02it/s]
Computing between-cluster distances for 45 cluster pairs...
  0%|          | 0/45 [00:00<?, ?it/s]  9%|▉         | 4/45 [00:00<00:01, 35.91it/s] 20%|██        | 9/45 [00:00<00:00, 42.22it/s] 31%|███       | 14/45 [00:00<00:00, 39.31it/s] 42%|████▏     | 19/45 [00:00<00:00, 41.10it/s] 53%|█████▎    | 24/45 [00:00<00:00, 40.40it/s] 64%|██████▍   | 29/45 [00:00<00:00, 37.42it/s] 73%|███████▎  | 33/45 [00:00<00:00, 37.00it/s] 84%|████████▍ | 38/45 [00:00<00:00, 37.09it/s] 93%|█████████▎| 42/45 [00:01<00:00, 36.04it/s]100%|██████████| 45/45 [00:01<00:00, 37.60it/s]

Clustering Summary (n_clusters=10):
  Mean within-cluster distance: 0.3056
  Mean between-cluster distance: 0.4407
  Separation ratio: 1.4421
  Cluster size distribution: min=2, max=994, mean=409.6

--- Analyzing with 50 clusters ---
Computing metrics for 50 clusters...
Computing within-cluster distances:   0%|          | 0/50 [00:00<?, ?it/s]Computing within-cluster distances:  12%|█▏        | 6/50 [00:00<00:00, 55.67it/s]Computing within-cluster distances:  26%|██▌       | 13/50 [00:00<00:00, 60.87it/s]Computing within-cluster distances:  42%|████▏     | 21/50 [00:00<00:00, 65.48it/s]Computing within-cluster distances:  62%|██████▏   | 31/50 [00:00<00:00, 77.11it/s]Computing within-cluster distances:  80%|████████  | 40/50 [00:00<00:00, 81.48it/s]Computing within-cluster distances: 100%|██████████| 50/50 [00:00<00:00, 81.90it/s]
Computing between-cluster distances for 1000 cluster pairs...
  0%|          | 0/1000 [00:00<?, ?it/s]  1%|          | 6/1000 [00:00<00:17, 58.45it/s]  1%|          | 12/1000 [00:00<00:17, 57.05it/s]  2%|▏         | 19/1000 [00:00<00:16, 58.26it/s]  3%|▎         | 26/1000 [00:00<00:16, 58.35it/s]  3%|▎         | 33/1000 [00:00<00:15, 61.52it/s]  4%|▍         | 40/1000 [00:00<00:14, 64.05it/s]  5%|▍         | 47/1000 [00:00<00:15, 62.27it/s]  5%|▌         | 54/1000 [00:00<00:14, 63.20it/s]  6%|▌         | 61/1000 [00:00<00:15, 62.15it/s]  7%|▋         | 68/1000 [00:01<00:16, 57.99it/s]  8%|▊         | 76/1000 [00:01<00:14, 62.40it/s]  8%|▊         | 84/1000 [00:01<00:14, 65.02it/s]  9%|▉         | 91/1000 [00:01<00:14, 64.05it/s] 10%|▉         | 99/1000 [00:01<00:13, 66.85it/s] 11%|█         | 107/1000 [00:01<00:12, 69.34it/s] 12%|█▏        | 115/1000 [00:01<00:12, 69.19it/s] 12%|█▏        | 122/1000 [00:01<00:13, 64.04it/s] 13%|█▎        | 129/1000 [00:02<00:13, 62.87it/s] 14%|█▎        | 137/1000 [00:02<00:13, 64.39it/s] 14%|█▍        | 145/1000 [00:02<00:12, 66.27it/s] 15%|█▌        | 152/1000 [00:02<00:12, 65.66it/s] 16%|█▌        | 159/1000 [00:02<00:12, 65.22it/s] 17%|█▋        | 168/1000 [00:02<00:11, 69.90it/s] 18%|█▊        | 176/1000 [00:02<00:11, 69.48it/s] 18%|█▊        | 184/1000 [00:02<00:11, 69.68it/s] 19%|█▉        | 192/1000 [00:02<00:11, 68.91it/s] 20%|██        | 200/1000 [00:03<00:11, 71.90it/s] 21%|██        | 208/1000 [00:03<00:11, 69.92it/s] 22%|██▏       | 217/1000 [00:03<00:10, 72.30it/s] 22%|██▎       | 225/1000 [00:03<00:11, 68.46it/s] 23%|██▎       | 234/1000 [00:03<00:10, 73.13it/s] 24%|██▍       | 244/1000 [00:03<00:09, 79.05it/s] 25%|██▌       | 252/1000 [00:03<00:09, 75.17it/s] 26%|██▌       | 260/1000 [00:03<00:09, 75.82it/s] 27%|██▋       | 268/1000 [00:03<00:10, 72.90it/s] 28%|██▊       | 276/1000 [00:04<00:10, 69.90it/s] 28%|██▊       | 285/1000 [00:04<00:09, 74.49it/s] 29%|██▉       | 293/1000 [00:04<00:09, 75.88it/s] 30%|███       | 301/1000 [00:04<00:10, 68.47it/s] 31%|███       | 310/1000 [00:04<00:09, 72.75it/s] 32%|███▏      | 318/1000 [00:04<00:09, 74.14it/s] 33%|███▎      | 326/1000 [00:04<00:08, 74.97it/s] 33%|███▎      | 334/1000 [00:04<00:08, 74.33it/s] 34%|███▍      | 342/1000 [00:04<00:09, 72.43it/s] 35%|███▌      | 350/1000 [00:05<00:08, 73.56it/s] 36%|███▌      | 358/1000 [00:05<00:09, 70.06it/s] 37%|███▋      | 366/1000 [00:05<00:08, 72.32it/s] 37%|███▋      | 374/1000 [00:05<00:08, 74.14it/s] 38%|███▊      | 382/1000 [00:05<00:08, 74.45it/s] 39%|███▉      | 390/1000 [00:05<00:08, 73.62it/s] 40%|███▉      | 398/1000 [00:05<00:08, 74.37it/s] 41%|████      | 406/1000 [00:05<00:08, 72.72it/s] 41%|████▏     | 414/1000 [00:05<00:07, 73.25it/s] 42%|████▏     | 422/1000 [00:06<00:07, 72.72it/s] 43%|████▎     | 430/1000 [00:06<00:07, 73.45it/s] 44%|████▍     | 438/1000 [00:06<00:07, 72.38it/s] 45%|████▍     | 446/1000 [00:06<00:07, 69.73it/s] 46%|████▌     | 455/1000 [00:06<00:07, 72.04it/s] 46%|████▋     | 463/1000 [00:06<00:07, 72.94it/s] 47%|████▋     | 471/1000 [00:06<00:07, 72.37it/s] 48%|████▊     | 479/1000 [00:06<00:07, 69.37it/s] 49%|████▊     | 487/1000 [00:06<00:07, 71.88it/s] 50%|████▉     | 495/1000 [00:07<00:07, 70.79it/s] 50%|█████     | 503/1000 [00:07<00:07, 65.77it/s] 51%|█████     | 510/1000 [00:07<00:07, 63.64it/s] 52%|█████▏    | 518/1000 [00:07<00:07, 66.36it/s] 52%|█████▎    | 525/1000 [00:07<00:07, 66.92it/s] 53%|█████▎    | 532/1000 [00:07<00:06, 67.55it/s] 54%|█████▍    | 539/1000 [00:07<00:07, 65.06it/s] 55%|█████▍    | 546/1000 [00:07<00:06, 65.20it/s] 55%|█████▌    | 554/1000 [00:08<00:06, 65.76it/s] 56%|█████▌    | 562/1000 [00:08<00:06, 69.36it/s] 57%|█████▋    | 569/1000 [00:08<00:06, 66.49it/s] 58%|█████▊    | 576/1000 [00:08<00:06, 65.20it/s] 58%|█████▊    | 583/1000 [00:08<00:06, 62.96it/s] 59%|█████▉    | 590/1000 [00:08<00:06, 59.99it/s] 60%|█████▉    | 597/1000 [00:08<00:06, 58.10it/s] 60%|██████    | 604/1000 [00:08<00:06, 60.20it/s] 61%|██████    | 611/1000 [00:08<00:06, 58.50it/s] 62%|██████▏   | 619/1000 [00:09<00:06, 61.38it/s] 63%|██████▎   | 626/1000 [00:09<00:06, 60.61it/s] 63%|██████▎   | 633/1000 [00:09<00:06, 61.06it/s] 64%|██████▍   | 640/1000 [00:09<00:05, 60.69it/s] 65%|██████▍   | 648/1000 [00:09<00:05, 62.98it/s] 66%|██████▌   | 655/1000 [00:09<00:05, 63.99it/s] 66%|██████▌   | 662/1000 [00:09<00:05, 64.24it/s] 67%|██████▋   | 669/1000 [00:09<00:05, 65.66it/s] 68%|██████▊   | 676/1000 [00:09<00:04, 65.37it/s] 68%|██████▊   | 683/1000 [00:10<00:04, 65.25it/s] 69%|██████▉   | 690/1000 [00:10<00:04, 66.13it/s] 70%|██████▉   | 698/1000 [00:10<00:04, 67.69it/s] 70%|███████   | 705/1000 [00:10<00:04, 65.02it/s] 71%|███████▏  | 714/1000 [00:10<00:04, 70.37it/s] 72%|███████▏  | 722/1000 [00:10<00:03, 71.40it/s] 73%|███████▎  | 730/1000 [00:10<00:03, 71.90it/s] 74%|███████▍  | 738/1000 [00:10<00:03, 71.78it/s] 75%|███████▍  | 746/1000 [00:10<00:03, 69.29it/s] 75%|███████▌  | 754/1000 [00:11<00:03, 68.62it/s] 76%|███████▋  | 764/1000 [00:11<00:03, 74.63it/s] 77%|███████▋  | 773/1000 [00:11<00:02, 78.71it/s] 78%|███████▊  | 781/1000 [00:11<00:02, 75.80it/s] 79%|███████▉  | 789/1000 [00:11<00:03, 70.25it/s] 80%|███████▉  | 797/1000 [00:11<00:02, 71.10it/s] 80%|████████  | 805/1000 [00:11<00:02, 69.56it/s] 81%|████████▏ | 814/1000 [00:11<00:02, 74.69it/s] 82%|████████▏ | 823/1000 [00:12<00:02, 74.85it/s] 83%|████████▎ | 831/1000 [00:12<00:02, 76.20it/s] 84%|████████▍ | 839/1000 [00:12<00:02, 75.48it/s] 85%|████████▍ | 847/1000 [00:12<00:02, 75.28it/s] 86%|████████▌ | 855/1000 [00:12<00:02, 72.36it/s] 86%|████████▋ | 864/1000 [00:12<00:01, 75.32it/s] 87%|████████▋ | 872/1000 [00:12<00:01, 71.45it/s] 88%|████████▊ | 880/1000 [00:12<00:01, 72.41it/s] 89%|████████▉ | 888/1000 [00:12<00:01, 68.94it/s] 90%|████████▉ | 895/1000 [00:13<00:01, 67.93it/s] 90%|█████████ | 902/1000 [00:13<00:01, 65.73it/s] 91%|█████████ | 909/1000 [00:13<00:01, 65.68it/s] 92%|█████████▏| 917/1000 [00:13<00:01, 66.66it/s] 92%|█████████▏| 924/1000 [00:13<00:01, 66.63it/s] 93%|█████████▎| 931/1000 [00:13<00:01, 66.37it/s] 94%|█████████▍| 938/1000 [00:13<00:00, 66.84it/s] 94%|█████████▍| 945/1000 [00:13<00:00, 66.34it/s] 95%|█████████▌| 953/1000 [00:13<00:00, 69.47it/s] 96%|█████████▌| 960/1000 [00:14<00:00, 68.19it/s] 97%|█████████▋| 967/1000 [00:14<00:00, 65.08it/s] 98%|█████████▊| 975/1000 [00:14<00:00, 68.23it/s] 98%|█████████▊| 982/1000 [00:14<00:00, 67.09it/s] 99%|█████████▉| 989/1000 [00:14<00:00, 67.78it/s]100%|█████████▉| 997/1000 [00:14<00:00, 69.47it/s]100%|██████████| 1000/1000 [00:14<00:00, 68.49it/s]

Clustering Summary (n_clusters=50):
  Mean within-cluster distance: 0.3714
  Mean between-cluster distance: 0.4017
  Separation ratio: 1.0818
  Cluster size distribution: min=1, max=501, mean=81.9

--- Analyzing with 100 clusters ---
Computing metrics for 100 clusters...
Computing within-cluster distances:   0%|          | 0/100 [00:00<?, ?it/s]Computing within-cluster distances:   5%|▌         | 5/100 [00:00<00:01, 47.71it/s]Computing within-cluster distances:  16%|█▌        | 16/100 [00:00<00:01, 79.19it/s]Computing within-cluster distances:  25%|██▌       | 25/100 [00:00<00:00, 83.65it/s]Computing within-cluster distances:  36%|███▌      | 36/100 [00:00<00:00, 91.18it/s]Computing within-cluster distances:  51%|█████     | 51/100 [00:00<00:00, 109.48it/s]Computing within-cluster distances:  66%|██████▌   | 66/100 [00:00<00:00, 120.98it/s]Computing within-cluster distances:  90%|█████████ | 90/100 [00:00<00:00, 158.08it/s]Computing within-cluster distances: 100%|██████████| 100/100 [00:00<00:00, 129.23it/s]
Computing between-cluster distances for 1000 cluster pairs...
  0%|          | 0/1000 [00:00<?, ?it/s]  1%|          | 10/1000 [00:00<00:10, 93.58it/s]  2%|▏         | 22/1000 [00:00<00:09, 107.57it/s]  3%|▎         | 33/1000 [00:00<00:09, 105.62it/s]  4%|▍         | 44/1000 [00:00<00:09, 97.76it/s]   5%|▌         | 54/1000 [00:00<00:10, 92.32it/s]  7%|▋         | 67/1000 [00:00<00:09, 103.36it/s]  8%|▊         | 78/1000 [00:00<00:09, 101.72it/s]  9%|▉         | 90/1000 [00:00<00:08, 106.17it/s] 10%|█         | 101/1000 [00:00<00:08, 107.05it/s] 11%|█▏        | 113/1000 [00:01<00:08, 110.70it/s] 12%|█▎        | 125/1000 [00:01<00:08, 104.32it/s] 14%|█▍        | 138/1000 [00:01<00:07, 110.94it/s] 15%|█▌        | 150/1000 [00:01<00:07, 112.14it/s] 16%|█▌        | 162/1000 [00:01<00:07, 107.33it/s] 17%|█▋        | 174/1000 [00:01<00:07, 110.75it/s] 19%|█▊        | 186/1000 [00:01<00:07, 108.45it/s] 20%|█▉        | 199/1000 [00:01<00:07, 110.72it/s] 21%|██        | 211/1000 [00:01<00:06, 113.09it/s] 22%|██▏       | 223/1000 [00:02<00:07, 107.26it/s] 24%|██▍       | 238/1000 [00:02<00:06, 116.81it/s] 25%|██▌       | 250/1000 [00:02<00:06, 114.11it/s] 26%|██▋       | 263/1000 [00:02<00:06, 116.47it/s] 28%|██▊       | 275/1000 [00:02<00:06, 117.08it/s] 29%|██▊       | 287/1000 [00:02<00:06, 110.95it/s] 30%|██▉       | 299/1000 [00:02<00:06, 113.20it/s] 31%|███       | 311/1000 [00:02<00:06, 111.54it/s] 32%|███▏      | 323/1000 [00:02<00:06, 111.82it/s] 34%|███▎      | 337/1000 [00:03<00:05, 115.74it/s] 35%|███▍      | 349/1000 [00:03<00:05, 116.81it/s] 36%|███▌      | 362/1000 [00:03<00:05, 119.66it/s] 37%|███▋      | 374/1000 [00:03<00:05, 118.66it/s] 39%|███▊      | 386/1000 [00:03<00:05, 114.81it/s] 40%|███▉      | 399/1000 [00:03<00:05, 113.37it/s] 41%|████      | 411/1000 [00:03<00:05, 108.70it/s] 42%|████▏     | 422/1000 [00:03<00:05, 107.83it/s] 43%|████▎     | 433/1000 [00:03<00:05, 106.66it/s] 44%|████▍     | 445/1000 [00:04<00:05, 107.80it/s] 46%|████▌     | 457/1000 [00:04<00:05, 108.52it/s] 47%|████▋     | 468/1000 [00:04<00:05, 103.83it/s] 48%|████▊     | 479/1000 [00:04<00:05, 102.48it/s] 49%|████▉     | 491/1000 [00:04<00:04, 105.08it/s] 50%|█████     | 502/1000 [00:04<00:04, 101.41it/s] 51%|█████▏    | 514/1000 [00:04<00:04, 103.78it/s] 53%|█████▎    | 526/1000 [00:04<00:04, 106.47it/s] 54%|█████▍    | 540/1000 [00:04<00:04, 113.69it/s] 55%|█████▌    | 552/1000 [00:05<00:04, 108.71it/s] 56%|█████▋    | 563/1000 [00:05<00:04, 102.70it/s] 57%|█████▊    | 575/1000 [00:05<00:04, 103.41it/s] 59%|█████▊    | 587/1000 [00:05<00:03, 106.23it/s] 60%|█████▉    | 598/1000 [00:05<00:03, 106.24it/s] 61%|██████    | 610/1000 [00:05<00:03, 108.01it/s] 62%|██████▏   | 622/1000 [00:05<00:03, 109.84it/s] 64%|██████▎   | 635/1000 [00:05<00:03, 115.50it/s] 65%|██████▍   | 647/1000 [00:05<00:03, 109.70it/s] 66%|██████▌   | 660/1000 [00:06<00:03, 111.58it/s] 67%|██████▋   | 672/1000 [00:06<00:02, 110.30it/s] 68%|██████▊   | 685/1000 [00:06<00:02, 114.84it/s] 70%|██████▉   | 697/1000 [00:06<00:02, 108.74it/s] 71%|███████   | 708/1000 [00:06<00:02, 105.60it/s] 72%|███████▏  | 719/1000 [00:06<00:02, 104.12it/s] 73%|███████▎  | 730/1000 [00:06<00:02, 104.78it/s] 74%|███████▍  | 742/1000 [00:06<00:02, 107.72it/s] 75%|███████▌  | 753/1000 [00:06<00:02, 102.06it/s] 76%|███████▋  | 765/1000 [00:07<00:02, 106.87it/s] 78%|███████▊  | 776/1000 [00:07<00:02, 103.27it/s] 79%|███████▉  | 788/1000 [00:07<00:01, 107.61it/s] 80%|███████▉  | 799/1000 [00:07<00:01, 103.29it/s] 81%|████████  | 810/1000 [00:07<00:01, 103.33it/s] 82%|████████▏ | 821/1000 [00:07<00:01, 99.47it/s]  83%|████████▎ | 832/1000 [00:07<00:01, 99.41it/s] 84%|████████▍ | 844/1000 [00:07<00:01, 104.91it/s] 86%|████████▌ | 855/1000 [00:07<00:01, 105.06it/s] 87%|████████▋ | 866/1000 [00:08<00:01, 98.93it/s]  88%|████████▊ | 877/1000 [00:08<00:01, 100.15it/s] 89%|████████▉ | 888/1000 [00:08<00:01, 95.67it/s]  90%|█████████ | 900/1000 [00:08<00:01, 98.84it/s] 91%|█████████ | 910/1000 [00:08<00:00, 95.93it/s] 92%|█████████▏| 921/1000 [00:08<00:00, 98.65it/s] 93%|█████████▎| 931/1000 [00:08<00:00, 93.97it/s] 94%|█████████▍| 942/1000 [00:08<00:00, 96.77it/s] 95%|█████████▌| 953/1000 [00:08<00:00, 98.43it/s] 96%|█████████▋| 963/1000 [00:09<00:00, 98.08it/s] 98%|█████████▊| 975/1000 [00:09<00:00, 100.19it/s] 99%|█████████▊| 987/1000 [00:09<00:00, 104.75it/s]100%|█████████▉| 998/1000 [00:09<00:00, 104.35it/s]100%|██████████| 1000/1000 [00:09<00:00, 106.58it/s]

Clustering Summary (n_clusters=100):
  Mean within-cluster distance: 0.3671
  Mean between-cluster distance: 0.3997
  Separation ratio: 1.0890
  Cluster size distribution: min=1, max=355, mean=41.0

--- Analyzing with 500 clusters ---
Computing metrics for 500 clusters...
Computing within-cluster distances:   0%|          | 0/500 [00:00<?, ?it/s]Computing within-cluster distances:   3%|▎         | 14/500 [00:00<00:03, 128.15it/s]Computing within-cluster distances:   7%|▋         | 33/500 [00:00<00:02, 159.83it/s]Computing within-cluster distances:  13%|█▎        | 63/500 [00:00<00:02, 217.59it/s]Computing within-cluster distances:  17%|█▋        | 85/500 [00:00<00:01, 211.70it/s]Computing within-cluster distances:  25%|██▍       | 124/500 [00:00<00:01, 273.03it/s]Computing within-cluster distances:  30%|███       | 152/500 [00:00<00:01, 264.56it/s]Computing within-cluster distances:  38%|███▊      | 188/500 [00:00<00:01, 292.42it/s]Computing within-cluster distances:  55%|█████▌    | 276/500 [00:00<00:00, 470.28it/s]Computing within-cluster distances:  75%|███████▌  | 375/500 [00:00<00:00, 628.03it/s]Computing within-cluster distances: 100%|██████████| 500/500 [00:01<00:00, 491.03it/s]
Computing between-cluster distances for 1000 cluster pairs...
  0%|          | 0/1000 [00:00<?, ?it/s]  4%|▎         | 37/1000 [00:00<00:02, 364.22it/s]  7%|▋         | 74/1000 [00:00<00:02, 341.37it/s] 11%|█         | 111/1000 [00:00<00:02, 353.44it/s] 15%|█▍        | 147/1000 [00:00<00:02, 350.29it/s] 18%|█▊        | 183/1000 [00:00<00:02, 321.84it/s] 22%|██▏       | 216/1000 [00:00<00:02, 319.14it/s] 25%|██▌       | 253/1000 [00:00<00:02, 330.99it/s] 29%|██▊       | 287/1000 [00:00<00:02, 316.03it/s] 32%|███▏      | 319/1000 [00:00<00:02, 304.84it/s] 35%|███▌      | 351/1000 [00:01<00:02, 304.28it/s] 38%|███▊      | 383/1000 [00:01<00:02, 307.70it/s] 41%|████▏     | 414/1000 [00:01<00:01, 299.88it/s] 44%|████▍     | 445/1000 [00:01<00:01, 297.99it/s] 48%|████▊     | 477/1000 [00:01<00:01, 301.02it/s] 51%|█████     | 512/1000 [00:01<00:01, 314.36it/s] 54%|█████▍    | 544/1000 [00:01<00:01, 310.17it/s] 58%|█████▊    | 576/1000 [00:01<00:01, 310.86it/s] 61%|██████    | 608/1000 [00:01<00:01, 309.05it/s] 64%|██████▍   | 644/1000 [00:02<00:01, 320.19it/s] 68%|██████▊   | 683/1000 [00:02<00:00, 337.53it/s] 72%|███████▏  | 717/1000 [00:02<00:00, 300.13it/s] 75%|███████▍  | 748/1000 [00:02<00:00, 291.72it/s] 78%|███████▊  | 779/1000 [00:02<00:00, 295.93it/s] 81%|████████  | 809/1000 [00:02<00:00, 296.88it/s] 84%|████████▍ | 844/1000 [00:02<00:00, 310.59it/s] 88%|████████▊ | 876/1000 [00:02<00:00, 307.64it/s] 91%|█████████ | 907/1000 [00:02<00:00, 302.43it/s] 94%|█████████▍| 938/1000 [00:03<00:00, 299.39it/s] 97%|█████████▋| 969/1000 [00:03<00:00, 297.61it/s]100%|██████████| 1000/1000 [00:03<00:00, 311.15it/s]

Clustering Summary (n_clusters=500):
  Mean within-cluster distance: 0.3092
  Mean between-cluster distance: 0.3869
  Separation ratio: 1.2515
  Cluster size distribution: min=1, max=224, mean=8.2

--- Analyzing with 1000 clusters ---
Computing metrics for 1000 clusters...
Computing within-cluster distances:   0%|          | 0/1000 [00:00<?, ?it/s]Computing within-cluster distances:   2%|▏         | 15/1000 [00:00<00:06, 149.30it/s]Computing within-cluster distances:   4%|▎         | 37/1000 [00:00<00:05, 183.78it/s]Computing within-cluster distances:   8%|▊         | 85/1000 [00:00<00:02, 316.10it/s]Computing within-cluster distances:  17%|█▋        | 169/1000 [00:00<00:01, 519.10it/s]Computing within-cluster distances:  22%|██▏       | 222/1000 [00:00<00:01, 501.33it/s]Computing within-cluster distances:  32%|███▏      | 323/1000 [00:00<00:01, 663.46it/s]Computing within-cluster distances:  39%|███▉      | 390/1000 [00:00<00:01, 606.66it/s]Computing within-cluster distances:  58%|█████▊    | 579/1000 [00:00<00:00, 982.14it/s]Computing within-cluster distances:  82%|████████▏ | 817/1000 [00:00<00:00, 1393.38it/s]Computing within-cluster distances: 100%|██████████| 1000/1000 [00:01<00:00, 992.65it/s]
Computing between-cluster distances for 1000 cluster pairs...
  0%|          | 0/1000 [00:00<?, ?it/s]  7%|▋         | 71/1000 [00:00<00:01, 699.20it/s] 14%|█▍        | 141/1000 [00:00<00:01, 615.10it/s] 21%|██        | 212/1000 [00:00<00:01, 638.40it/s] 28%|██▊       | 277/1000 [00:00<00:01, 622.95it/s] 34%|███▍      | 340/1000 [00:00<00:01, 619.10it/s] 40%|████      | 403/1000 [00:00<00:01, 576.61it/s] 48%|████▊     | 475/1000 [00:00<00:00, 618.50it/s] 54%|█████▍    | 542/1000 [00:00<00:00, 632.74it/s] 61%|██████    | 611/1000 [00:00<00:00, 648.58it/s] 68%|██████▊   | 677/1000 [00:01<00:00, 605.68it/s] 74%|███████▍  | 742/1000 [00:01<00:00, 616.56it/s] 80%|████████  | 805/1000 [00:01<00:00, 617.21it/s] 87%|████████▋ | 868/1000 [00:01<00:00, 595.72it/s] 93%|█████████▎| 930/1000 [00:01<00:00, 602.02it/s] 99%|█████████▉| 994/1000 [00:01<00:00, 612.04it/s]100%|██████████| 1000/1000 [00:01<00:00, 617.13it/s]

Clustering Summary (n_clusters=1000):
  Mean within-cluster distance: 0.2227
  Mean between-cluster distance: 0.3819
  Separation ratio: 1.7150
  Cluster size distribution: min=1, max=173, mean=4.1

--- Analyzing with 2000 clusters ---
Computing metrics for 2000 clusters...
Computing within-cluster distances:   0%|          | 0/2000 [00:00<?, ?it/s]Computing within-cluster distances:   1%|          | 23/2000 [00:00<00:08, 219.84it/s]Computing within-cluster distances:   5%|▌         | 102/2000 [00:00<00:03, 545.38it/s]Computing within-cluster distances:  12%|█▎        | 250/2000 [00:00<00:01, 965.50it/s]Computing within-cluster distances:  23%|██▎       | 467/2000 [00:00<00:01, 1436.75it/s]Computing within-cluster distances:  37%|███▋      | 735/2000 [00:00<00:00, 1881.51it/s]Computing within-cluster distances:  47%|████▋     | 934/2000 [00:00<00:00, 1915.89it/s]Computing within-cluster distances:  69%|██████▊   | 1372/2000 [00:00<00:00, 2717.50it/s]Computing within-cluster distances:  91%|█████████▏| 1827/2000 [00:00<00:00, 3298.30it/s]Computing within-cluster distances: 100%|██████████| 2000/2000 [00:00<00:00, 2393.08it/s]
Computing between-cluster distances for 1000 cluster pairs...
  0%|          | 0/1000 [00:00<?, ?it/s] 11%|█         | 109/1000 [00:00<00:00, 1081.11it/s] 24%|██▍       | 238/1000 [00:00<00:00, 1194.94it/s] 36%|███▌      | 358/1000 [00:00<00:00, 1180.08it/s] 48%|████▊     | 477/1000 [00:00<00:00, 1154.81it/s] 62%|██████▏   | 615/1000 [00:00<00:00, 1233.03it/s] 74%|███████▍  | 745/1000 [00:00<00:00, 1250.35it/s] 87%|████████▋ | 871/1000 [00:00<00:00, 1231.94it/s]100%|██████████| 1000/1000 [00:00<00:00, 1222.92it/s]

Clustering Summary (n_clusters=2000):
  Mean within-cluster distance: 0.1065
  Mean between-cluster distance: 0.3762
  Separation ratio: 3.5312
  Cluster size distribution: min=1, max=110, mean=2.0

============================================================
Total computation time: 9.49 minutes
============================================================
✓ Intermediate results saved to: /home/datadi/burns/aws/workloads/results/metrics/agglomerative_clustering/sparsegpt/agglomerative_clustering_gate_proj_full_results.json

============================================================
FULL ANALYSIS: /home/datadi/burns/aws/workloads/data/sparsegpt_unstructured/layer3-mlp.gate_proj.pt
============================================================
Matrix shape: torch.Size([11008, 4096])
Computing pairwise Hamming distances for ALL 4096 features...
Distance matrix computed (shape: (8386560,))
Computing hierarchical clustering linkage with method='ward'...
Linkage matrix computed

--- Analyzing with 10 clusters ---
Computing metrics for 10 clusters...
Computing within-cluster distances:   0%|          | 0/10 [00:00<?, ?it/s]Computing within-cluster distances:  50%|█████     | 5/10 [00:00<00:00, 46.71it/s]Computing within-cluster distances: 100%|██████████| 10/10 [00:00<00:00, 54.08it/s]
Computing between-cluster distances for 45 cluster pairs...
  0%|          | 0/45 [00:00<?, ?it/s] 11%|█         | 5/45 [00:00<00:00, 43.42it/s] 22%|██▏       | 10/45 [00:00<00:00, 39.35it/s] 31%|███       | 14/45 [00:00<00:00, 37.66it/s] 44%|████▍     | 20/45 [00:00<00:00, 43.27it/s] 56%|█████▌    | 25/45 [00:00<00:00, 40.83it/s] 67%|██████▋   | 30/45 [00:00<00:00, 38.86it/s] 78%|███████▊  | 35/45 [00:00<00:00, 39.90it/s] 89%|████████▉ | 40/45 [00:00<00:00, 41.14it/s]100%|██████████| 45/45 [00:01<00:00, 39.87it/s]100%|██████████| 45/45 [00:01<00:00, 40.18it/s]

Clustering Summary (n_clusters=10):
  Mean within-cluster distance: 0.3479
  Mean between-cluster distance: 0.4333
  Separation ratio: 1.2453
  Cluster size distribution: min=2, max=926, mean=409.6

--- Analyzing with 50 clusters ---
Computing metrics for 50 clusters...
Computing within-cluster distances:   0%|          | 0/50 [00:00<?, ?it/s]Computing within-cluster distances:  14%|█▍        | 7/50 [00:00<00:00, 61.28it/s]Computing within-cluster distances:  30%|███       | 15/50 [00:00<00:00, 63.05it/s]Computing within-cluster distances:  50%|█████     | 25/50 [00:00<00:00, 78.10it/s]Computing within-cluster distances:  74%|███████▍  | 37/50 [00:00<00:00, 93.47it/s]Computing within-cluster distances:  94%|█████████▍| 47/50 [00:00<00:00, 92.23it/s]Computing within-cluster distances: 100%|██████████| 50/50 [00:00<00:00, 85.93it/s]
Computing between-cluster distances for 1000 cluster pairs...
  0%|          | 0/1000 [00:00<?, ?it/s]  0%|          | 5/1000 [00:00<00:20, 49.26it/s]  2%|▏         | 15/1000 [00:00<00:12, 77.40it/s]  2%|▏         | 23/1000 [00:00<00:13, 74.07it/s]  3%|▎         | 31/1000 [00:00<00:13, 73.22it/s]  4%|▍         | 39/1000 [00:00<00:13, 70.29it/s]  5%|▍         | 48/1000 [00:00<00:12, 76.00it/s]  6%|▌         | 57/1000 [00:00<00:11, 79.64it/s]  7%|▋         | 66/1000 [00:00<00:11, 79.45it/s]  7%|▋         | 74/1000 [00:00<00:11, 77.98it/s]  8%|▊         | 82/1000 [00:01<00:11, 77.28it/s]  9%|▉         | 91/1000 [00:01<00:11, 76.68it/s] 10%|▉         | 99/1000 [00:01<00:12, 74.47it/s] 11%|█         | 107/1000 [00:01<00:11, 75.58it/s] 12%|█▏        | 115/1000 [00:01<00:11, 74.71it/s] 12%|█▏        | 124/1000 [00:01<00:11, 76.01it/s] 13%|█▎        | 134/1000 [00:01<00:10, 81.72it/s] 14%|█▍        | 143/1000 [00:01<00:10, 78.10it/s] 15%|█▌        | 151/1000 [00:01<00:10, 77.77it/s] 16%|█▌        | 159/1000 [00:02<00:11, 75.50it/s] 17%|█▋        | 168/1000 [00:02<00:11, 74.79it/s] 18%|█▊        | 176/1000 [00:02<00:11, 73.03it/s] 18%|█▊        | 184/1000 [00:02<00:11, 71.18it/s] 19%|█▉        | 192/1000 [00:02<00:11, 71.72it/s] 20%|██        | 200/1000 [00:02<00:11, 70.58it/s] 21%|██        | 208/1000 [00:02<00:11, 71.81it/s] 22%|██▏       | 216/1000 [00:02<00:11, 69.12it/s] 22%|██▏       | 223/1000 [00:03<00:11, 69.25it/s] 23%|██▎       | 231/1000 [00:03<00:11, 69.50it/s] 24%|██▍       | 238/1000 [00:03<00:11, 69.01it/s] 25%|██▍       | 246/1000 [00:03<00:10, 69.86it/s] 25%|██▌       | 253/1000 [00:03<00:11, 65.57it/s] 26%|██▌       | 260/1000 [00:03<00:11, 66.30it/s] 27%|██▋       | 267/1000 [00:03<00:11, 64.25it/s] 28%|██▊       | 275/1000 [00:03<00:10, 67.19it/s] 28%|██▊       | 284/1000 [00:03<00:09, 73.33it/s] 29%|██▉       | 292/1000 [00:03<00:09, 74.60it/s] 30%|███       | 300/1000 [00:04<00:09, 71.32it/s] 31%|███       | 308/1000 [00:04<00:10, 66.96it/s] 32%|███▏      | 315/1000 [00:04<00:10, 64.47it/s] 32%|███▏      | 322/1000 [00:04<00:10, 63.79it/s] 33%|███▎      | 332/1000 [00:04<00:09, 73.44it/s] 34%|███▍      | 340/1000 [00:04<00:09, 70.23it/s] 35%|███▍      | 348/1000 [00:04<00:09, 70.79it/s] 36%|███▌      | 356/1000 [00:04<00:09, 71.35it/s] 36%|███▋      | 364/1000 [00:05<00:08, 73.15it/s] 37%|███▋      | 373/1000 [00:05<00:08, 74.48it/s] 38%|███▊      | 382/1000 [00:05<00:08, 77.09it/s] 39%|███▉      | 390/1000 [00:05<00:08, 74.17it/s] 40%|███▉      | 399/1000 [00:05<00:07, 75.16it/s] 41%|████      | 408/1000 [00:05<00:07, 77.12it/s] 42%|████▏     | 416/1000 [00:05<00:07, 76.51it/s] 42%|████▏     | 424/1000 [00:05<00:07, 75.25it/s] 43%|████▎     | 432/1000 [00:05<00:07, 72.70it/s] 44%|████▍     | 440/1000 [00:06<00:07, 74.29it/s] 45%|████▍     | 449/1000 [00:06<00:07, 76.43it/s] 46%|████▌     | 457/1000 [00:06<00:07, 76.98it/s] 46%|████▋     | 465/1000 [00:06<00:07, 75.86it/s] 47%|████▋     | 473/1000 [00:06<00:07, 75.22it/s] 48%|████▊     | 482/1000 [00:06<00:06, 76.66it/s] 49%|████▉     | 491/1000 [00:06<00:06, 79.39it/s] 50%|████▉     | 499/1000 [00:06<00:06, 75.95it/s] 51%|█████     | 507/1000 [00:06<00:06, 73.75it/s] 52%|█████▏    | 517/1000 [00:07<00:06, 80.14it/s] 53%|█████▎    | 526/1000 [00:07<00:06, 75.20it/s] 54%|█████▎    | 535/1000 [00:07<00:05, 78.08it/s] 54%|█████▍    | 543/1000 [00:07<00:06, 74.58it/s] 55%|█████▌    | 552/1000 [00:07<00:06, 74.03it/s] 56%|█████▌    | 560/1000 [00:07<00:06, 72.36it/s] 57%|█████▋    | 569/1000 [00:07<00:05, 76.70it/s] 58%|█████▊    | 577/1000 [00:07<00:05, 75.43it/s] 58%|█████▊    | 585/1000 [00:07<00:05, 75.83it/s] 59%|█████▉    | 593/1000 [00:08<00:05, 75.95it/s] 60%|██████    | 601/1000 [00:08<00:05, 72.24it/s] 61%|██████    | 609/1000 [00:08<00:05, 70.86it/s] 62%|██████▏   | 617/1000 [00:08<00:05, 72.80it/s] 63%|██████▎   | 626/1000 [00:08<00:05, 74.52it/s] 63%|██████▎   | 634/1000 [00:08<00:04, 74.46it/s] 64%|██████▍   | 642/1000 [00:08<00:05, 69.39it/s] 65%|██████▌   | 652/1000 [00:08<00:04, 75.35it/s] 66%|██████▌   | 660/1000 [00:08<00:04, 71.65it/s] 67%|██████▋   | 668/1000 [00:09<00:04, 72.32it/s] 68%|██████▊   | 676/1000 [00:09<00:04, 68.17it/s] 68%|██████▊   | 684/1000 [00:09<00:04, 70.07it/s] 69%|██████▉   | 693/1000 [00:09<00:04, 72.90it/s] 70%|███████   | 701/1000 [00:09<00:04, 71.27it/s] 71%|███████   | 709/1000 [00:09<00:04, 67.98it/s] 72%|███████▏  | 718/1000 [00:09<00:03, 72.55it/s] 73%|███████▎  | 726/1000 [00:09<00:03, 68.65it/s] 73%|███████▎  | 734/1000 [00:10<00:03, 69.59it/s] 74%|███████▍  | 742/1000 [00:10<00:03, 70.09it/s] 75%|███████▌  | 750/1000 [00:10<00:03, 69.50it/s] 76%|███████▌  | 758/1000 [00:10<00:03, 70.73it/s] 77%|███████▋  | 766/1000 [00:10<00:03, 71.61it/s] 77%|███████▋  | 774/1000 [00:10<00:03, 69.88it/s] 78%|███████▊  | 782/1000 [00:10<00:03, 64.73it/s] 79%|███████▉  | 789/1000 [00:10<00:03, 64.29it/s] 80%|███████▉  | 799/1000 [00:10<00:02, 72.64it/s] 81%|████████  | 807/1000 [00:11<00:02, 73.75it/s] 82%|████████▏ | 815/1000 [00:11<00:02, 71.05it/s] 82%|████████▏ | 823/1000 [00:11<00:02, 69.03it/s] 83%|████████▎ | 830/1000 [00:11<00:02, 65.23it/s] 84%|████████▎ | 837/1000 [00:11<00:02, 65.20it/s] 85%|████████▍ | 846/1000 [00:11<00:02, 71.29it/s] 85%|████████▌ | 854/1000 [00:11<00:02, 68.82it/s] 86%|████████▌ | 861/1000 [00:11<00:02, 66.24it/s] 87%|████████▋ | 869/1000 [00:12<00:01, 68.29it/s] 88%|████████▊ | 876/1000 [00:12<00:01, 67.94it/s] 88%|████████▊ | 884/1000 [00:12<00:01, 68.63it/s] 89%|████████▉ | 893/1000 [00:12<00:01, 71.65it/s] 90%|█████████ | 901/1000 [00:12<00:01, 70.24it/s] 91%|█████████ | 910/1000 [00:12<00:01, 72.60it/s] 92%|█████████▏| 918/1000 [00:12<00:01, 73.35it/s] 93%|█████████▎| 926/1000 [00:12<00:01, 68.79it/s] 93%|█████████▎| 934/1000 [00:12<00:00, 70.91it/s] 94%|█████████▍| 942/1000 [00:13<00:00, 72.44it/s] 95%|█████████▌| 950/1000 [00:13<00:00, 73.12it/s] 96%|█████████▌| 958/1000 [00:13<00:00, 72.72it/s] 97%|█████████▋| 966/1000 [00:13<00:00, 69.72it/s] 98%|█████████▊| 976/1000 [00:13<00:00, 76.04it/s] 98%|█████████▊| 985/1000 [00:13<00:00, 77.96it/s]100%|█████████▉| 995/1000 [00:13<00:00, 81.81it/s]100%|██████████| 1000/1000 [00:13<00:00, 72.63it/s]

Clustering Summary (n_clusters=50):
  Mean within-cluster distance: 0.3529
  Mean between-cluster distance: 0.4070
  Separation ratio: 1.1534
  Cluster size distribution: min=1, max=408, mean=81.9

--- Analyzing with 100 clusters ---
Computing metrics for 100 clusters...
Computing within-cluster distances:   0%|          | 0/100 [00:00<?, ?it/s]Computing within-cluster distances:   9%|▉         | 9/100 [00:00<00:01, 86.73it/s]Computing within-cluster distances:  20%|██        | 20/100 [00:00<00:00, 95.67it/s]Computing within-cluster distances:  32%|███▏      | 32/100 [00:00<00:00, 104.00it/s]Computing within-cluster distances:  49%|████▉     | 49/100 [00:00<00:00, 127.82it/s]Computing within-cluster distances:  62%|██████▏   | 62/100 [00:00<00:00, 124.41it/s]Computing within-cluster distances:  87%|████████▋ | 87/100 [00:00<00:00, 164.50it/s]Computing within-cluster distances: 100%|██████████| 100/100 [00:00<00:00, 139.79it/s]
Computing between-cluster distances for 1000 cluster pairs...
  0%|          | 0/1000 [00:00<?, ?it/s]  1%|          | 11/1000 [00:00<00:09, 108.59it/s]  2%|▏         | 23/1000 [00:00<00:08, 113.02it/s]  4%|▎         | 35/1000 [00:00<00:08, 108.55it/s]  5%|▍         | 48/1000 [00:00<00:08, 115.62it/s]  6%|▌         | 61/1000 [00:00<00:08, 116.71it/s]  7%|▋         | 73/1000 [00:00<00:08, 105.17it/s]  8%|▊         | 84/1000 [00:00<00:08, 102.88it/s] 10%|▉         | 97/1000 [00:00<00:08, 108.40it/s] 11%|█         | 108/1000 [00:00<00:08, 107.82it/s] 12%|█▏        | 122/1000 [00:01<00:07, 113.68it/s] 14%|█▎        | 136/1000 [00:01<00:07, 120.13it/s] 15%|█▍        | 149/1000 [00:01<00:07, 116.28it/s] 16%|█▌        | 161/1000 [00:01<00:07, 114.60it/s] 17%|█▋        | 174/1000 [00:01<00:07, 113.75it/s] 19%|█▊        | 186/1000 [00:01<00:07, 115.40it/s] 20%|█▉        | 198/1000 [00:01<00:07, 113.13it/s] 21%|██        | 211/1000 [00:01<00:06, 116.49it/s] 23%|██▎       | 227/1000 [00:01<00:06, 125.83it/s] 24%|██▍       | 240/1000 [00:02<00:06, 114.61it/s] 25%|██▌       | 253/1000 [00:02<00:06, 118.21it/s] 26%|██▋       | 265/1000 [00:02<00:06, 116.94it/s] 28%|██▊       | 277/1000 [00:02<00:06, 109.96it/s] 29%|██▉       | 289/1000 [00:02<00:06, 106.06it/s] 30%|███       | 304/1000 [00:02<00:06, 115.58it/s] 32%|███▏      | 316/1000 [00:02<00:06, 112.88it/s] 33%|███▎      | 328/1000 [00:02<00:05, 112.86it/s] 34%|███▍      | 341/1000 [00:02<00:05, 116.32it/s] 35%|███▌      | 353/1000 [00:03<00:05, 109.60it/s] 36%|███▋      | 365/1000 [00:03<00:05, 107.30it/s] 38%|███▊      | 377/1000 [00:03<00:05, 107.68it/s] 39%|███▉      | 392/1000 [00:03<00:05, 116.87it/s] 40%|████      | 404/1000 [00:03<00:05, 115.19it/s] 42%|████▏     | 416/1000 [00:03<00:05, 110.99it/s] 43%|████▎     | 429/1000 [00:03<00:04, 115.67it/s] 44%|████▍     | 441/1000 [00:03<00:05, 109.21it/s] 45%|████▌     | 453/1000 [00:04<00:04, 110.85it/s] 46%|████▋     | 465/1000 [00:04<00:04, 113.08it/s] 48%|████▊     | 477/1000 [00:04<00:04, 106.20it/s] 49%|████▉     | 488/1000 [00:04<00:04, 107.22it/s] 50%|█████     | 500/1000 [00:04<00:04, 108.25it/s] 51%|█████▏    | 514/1000 [00:04<00:04, 114.37it/s] 53%|█████▎    | 528/1000 [00:04<00:03, 119.60it/s] 54%|█████▍    | 541/1000 [00:04<00:03, 121.53it/s] 55%|█████▌    | 554/1000 [00:04<00:03, 122.30it/s] 57%|█████▋    | 567/1000 [00:05<00:03, 114.90it/s] 58%|█████▊    | 579/1000 [00:05<00:03, 114.91it/s] 59%|█████▉    | 591/1000 [00:05<00:03, 115.55it/s] 60%|██████    | 604/1000 [00:05<00:03, 116.18it/s] 62%|██████▏   | 619/1000 [00:05<00:03, 122.71it/s] 63%|██████▎   | 632/1000 [00:05<00:03, 122.36it/s] 64%|██████▍   | 645/1000 [00:05<00:02, 121.03it/s] 66%|██████▌   | 658/1000 [00:05<00:02, 119.95it/s] 67%|██████▋   | 671/1000 [00:05<00:02, 115.36it/s] 68%|██████▊   | 683/1000 [00:05<00:02, 111.79it/s] 70%|██████▉   | 697/1000 [00:06<00:02, 117.68it/s] 71%|███████   | 709/1000 [00:06<00:02, 117.28it/s] 72%|███████▏  | 721/1000 [00:06<00:02, 117.39it/s] 73%|███████▎  | 733/1000 [00:06<00:02, 110.42it/s] 74%|███████▍  | 745/1000 [00:06<00:02, 110.09it/s] 76%|███████▌  | 757/1000 [00:06<00:02, 110.15it/s] 77%|███████▋  | 769/1000 [00:06<00:02, 104.10it/s] 78%|███████▊  | 782/1000 [00:06<00:01, 110.01it/s] 79%|███████▉  | 794/1000 [00:07<00:01, 106.40it/s] 80%|████████  | 805/1000 [00:07<00:01, 100.27it/s] 82%|████████▏ | 817/1000 [00:07<00:01, 105.13it/s] 83%|████████▎ | 830/1000 [00:07<00:01, 109.88it/s] 84%|████████▍ | 844/1000 [00:07<00:01, 115.01it/s] 86%|████████▌ | 856/1000 [00:07<00:01, 109.85it/s] 87%|████████▋ | 870/1000 [00:07<00:01, 114.84it/s] 88%|████████▊ | 882/1000 [00:07<00:01, 111.46it/s] 89%|████████▉ | 894/1000 [00:07<00:01, 104.48it/s] 90%|█████████ | 905/1000 [00:08<00:00, 104.07it/s] 92%|█████████▏| 916/1000 [00:08<00:00, 101.40it/s] 93%|█████████▎| 927/1000 [00:08<00:00, 101.03it/s] 94%|█████████▍| 938/1000 [00:08<00:00, 98.42it/s]  95%|█████████▌| 950/1000 [00:08<00:00, 103.00it/s] 96%|█████████▌| 961/1000 [00:08<00:00, 104.86it/s] 97%|█████████▋| 974/1000 [00:08<00:00, 110.47it/s] 99%|█████████▊| 986/1000 [00:08<00:00, 108.01it/s]100%|█████████▉| 998/1000 [00:08<00:00, 111.20it/s]100%|██████████| 1000/1000 [00:08<00:00, 112.02it/s]

Clustering Summary (n_clusters=100):
  Mean within-cluster distance: 0.3735
  Mean between-cluster distance: 0.3949
  Separation ratio: 1.0575
  Cluster size distribution: min=1, max=408, mean=41.0

--- Analyzing with 500 clusters ---
Computing metrics for 500 clusters...
Computing within-cluster distances:   0%|          | 0/500 [00:00<?, ?it/s]Computing within-cluster distances:   2%|▏         | 11/500 [00:00<00:04, 105.11it/s]Computing within-cluster distances:  10%|▉         | 48/500 [00:00<00:01, 256.71it/s]Computing within-cluster distances:  16%|█▌        | 79/500 [00:00<00:01, 280.01it/s]Computing within-cluster distances:  22%|██▏       | 112/500 [00:00<00:01, 296.28it/s]Computing within-cluster distances:  28%|██▊       | 142/500 [00:00<00:01, 264.67it/s]Computing within-cluster distances:  48%|████▊     | 241/500 [00:00<00:00, 482.14it/s]Computing within-cluster distances:  58%|█████▊    | 291/500 [00:00<00:00, 443.79it/s]Computing within-cluster distances:  81%|████████  | 406/500 [00:00<00:00, 641.58it/s]Computing within-cluster distances: 100%|██████████| 500/500 [00:00<00:00, 511.72it/s]
Computing between-cluster distances for 1000 cluster pairs...
  0%|          | 0/1000 [00:00<?, ?it/s]  3%|▎         | 28/1000 [00:00<00:03, 277.05it/s]  6%|▌         | 61/1000 [00:00<00:03, 301.05it/s]  9%|▉         | 93/1000 [00:00<00:02, 306.57it/s] 13%|█▎        | 129/1000 [00:00<00:02, 325.74it/s] 17%|█▋        | 167/1000 [00:00<00:02, 338.90it/s] 20%|██        | 204/1000 [00:00<00:02, 349.24it/s] 24%|██▍       | 241/1000 [00:00<00:02, 355.23it/s] 28%|██▊       | 278/1000 [00:00<00:02, 356.36it/s] 32%|███▏      | 323/1000 [00:00<00:01, 385.03it/s] 36%|███▋      | 365/1000 [00:01<00:01, 395.29it/s] 40%|████      | 405/1000 [00:01<00:01, 388.16it/s] 44%|████▍     | 444/1000 [00:01<00:01, 359.40it/s] 48%|████▊     | 481/1000 [00:01<00:01, 359.06it/s] 52%|█████▏    | 518/1000 [00:01<00:01, 361.01it/s] 56%|█████▌    | 555/1000 [00:01<00:01, 341.52it/s] 59%|█████▉    | 590/1000 [00:01<00:01, 339.38it/s] 63%|██████▎   | 626/1000 [00:01<00:01, 341.43it/s] 66%|██████▌   | 661/1000 [00:01<00:01, 337.53it/s] 70%|██████▉   | 696/1000 [00:01<00:00, 337.94it/s] 73%|███████▎  | 731/1000 [00:02<00:00, 339.08it/s] 77%|███████▋  | 770/1000 [00:02<00:00, 350.01it/s] 81%|████████  | 806/1000 [00:02<00:00, 350.17it/s] 85%|████████▍ | 849/1000 [00:02<00:00, 370.97it/s] 89%|████████▊ | 887/1000 [00:02<00:00, 360.13it/s] 92%|█████████▎| 925/1000 [00:02<00:00, 363.10it/s] 96%|█████████▌| 962/1000 [00:02<00:00, 357.78it/s]100%|█████████▉| 998/1000 [00:02<00:00, 357.43it/s]100%|██████████| 1000/1000 [00:02<00:00, 352.22it/s]

Clustering Summary (n_clusters=500):
  Mean within-cluster distance: 0.3104
  Mean between-cluster distance: 0.3853
  Separation ratio: 1.2411
  Cluster size distribution: min=1, max=150, mean=8.2

--- Analyzing with 1000 clusters ---
Computing metrics for 1000 clusters...
Computing within-cluster distances:   0%|          | 0/1000 [00:00<?, ?it/s]Computing within-cluster distances:   1%|▏         | 13/1000 [00:00<00:07, 125.22it/s]Computing within-cluster distances:   8%|▊         | 85/1000 [00:00<00:01, 468.84it/s]Computing within-cluster distances:  16%|█▋        | 165/1000 [00:00<00:01, 617.85it/s]Computing within-cluster distances:  25%|██▌       | 253/1000 [00:00<00:01, 719.75it/s]Computing within-cluster distances:  33%|███▎      | 326/1000 [00:00<00:01, 635.57it/s]Computing within-cluster distances:  54%|█████▍    | 544/1000 [00:00<00:00, 1112.95it/s]Computing within-cluster distances:  66%|██████▌   | 661/1000 [00:00<00:00, 1111.63it/s]Computing within-cluster distances:  97%|█████████▋| 969/1000 [00:00<00:00, 1703.81it/s]Computing within-cluster distances: 100%|██████████| 1000/1000 [00:00<00:00, 1157.62it/s]
Computing between-cluster distances for 1000 cluster pairs...
  0%|          | 0/1000 [00:00<?, ?it/s]  8%|▊         | 76/1000 [00:00<00:01, 755.69it/s] 15%|█▌        | 152/1000 [00:00<00:01, 710.31it/s] 22%|██▏       | 224/1000 [00:00<00:01, 670.80it/s] 30%|██▉       | 297/1000 [00:00<00:01, 690.04it/s] 38%|███▊      | 377/1000 [00:00<00:00, 713.38it/s] 45%|████▍     | 449/1000 [00:00<00:00, 662.97it/s] 52%|█████▏    | 516/1000 [00:00<00:00, 663.79it/s] 58%|█████▊    | 583/1000 [00:00<00:00, 639.89it/s] 66%|██████▌   | 657/1000 [00:00<00:00, 668.47it/s] 73%|███████▎  | 730/1000 [00:01<00:00, 683.49it/s] 80%|███████▉  | 799/1000 [00:01<00:00, 638.89it/s] 86%|████████▋ | 865/1000 [00:01<00:00, 639.85it/s] 94%|█████████▍| 939/1000 [00:01<00:00, 667.75it/s]100%|██████████| 1000/1000 [00:01<00:00, 670.10it/s]

Clustering Summary (n_clusters=1000):
  Mean within-cluster distance: 0.2298
  Mean between-cluster distance: 0.3788
  Separation ratio: 1.6484
  Cluster size distribution: min=1, max=110, mean=4.1

--- Analyzing with 2000 clusters ---
Computing metrics for 1998 clusters...
Computing within-cluster distances:   0%|          | 0/1998 [00:00<?, ?it/s]Computing within-cluster distances:   2%|▏         | 37/1998 [00:00<00:05, 349.71it/s]Computing within-cluster distances:  12%|█▏        | 244/1998 [00:00<00:01, 1335.11it/s]Computing within-cluster distances:  25%|██▍       | 491/1998 [00:00<00:00, 1843.35it/s]Computing within-cluster distances:  34%|███▍      | 685/1998 [00:00<00:00, 1874.41it/s]Computing within-cluster distances:  54%|█████▍    | 1074/1998 [00:00<00:00, 2594.32it/s]Computing within-cluster distances:  69%|██████▉   | 1385/1998 [00:00<00:00, 2767.61it/s]Computing within-cluster distances:  99%|█████████▉| 1988/1998 [00:00<00:00, 3827.69it/s]Computing within-cluster distances: 100%|██████████| 1998/1998 [00:00<00:00, 2815.11it/s]
Computing between-cluster distances for 1000 cluster pairs...
  0%|          | 0/1000 [00:00<?, ?it/s] 14%|█▍        | 138/1000 [00:00<00:00, 1339.45it/s] 29%|██▉       | 291/1000 [00:00<00:00, 1448.41it/s] 44%|████▎     | 436/1000 [00:00<00:00, 1350.83it/s] 61%|██████▏   | 613/1000 [00:00<00:00, 1505.06it/s] 76%|███████▋  | 765/1000 [00:00<00:00, 1406.85it/s] 92%|█████████▏| 924/1000 [00:00<00:00, 1462.30it/s]100%|██████████| 1000/1000 [00:00<00:00, 1448.06it/s]

Clustering Summary (n_clusters=2000):
  Mean within-cluster distance: 0.1093
  Mean between-cluster distance: 0.3749
  Separation ratio: 3.4302
  Cluster size distribution: min=1, max=88, mean=2.1

============================================================
Total computation time: 9.26 minutes
============================================================
✓ Intermediate results saved to: /home/datadi/burns/aws/workloads/results/metrics/agglomerative_clustering/sparsegpt/agglomerative_clustering_gate_proj_full_results.json

============================================================
✓ FULL SparseGPT gate_proj analysis complete!
============================================================
