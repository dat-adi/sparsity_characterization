Found 31 matrices to analyze

============================================================
FULL ANALYSIS: /home/datadi/burns/aws/workloads/data/sparsegpt_unstructured/layer0-mlp.down_proj.pt
============================================================
Matrix shape: torch.Size([4096, 11008])
Computing pairwise Hamming distances for ALL 11008 features...
WARNING: This may take a long time and use significant memory...
Distance matrix computed (shape: (60582528,))
Computing hierarchical clustering linkage with method='ward'...
Linkage matrix computed

--- Analyzing with 10 clusters ---
Computing metrics for 10 clusters...
Computing within-cluster distances:   0%|          | 0/10 [00:00<?, ?it/s]Computing within-cluster distances:  80%|████████  | 8/10 [00:00<00:00, 64.99it/s]Computing within-cluster distances: 100%|██████████| 10/10 [00:00<00:00, 61.28it/s]
Computing between-cluster distances for 45 cluster pairs...
  0%|          | 0/45 [00:00<?, ?it/s] 11%|█         | 5/45 [00:00<00:00, 43.93it/s] 22%|██▏       | 10/45 [00:00<00:00, 44.26it/s] 33%|███▎      | 15/45 [00:00<00:00, 43.76it/s] 44%|████▍     | 20/45 [00:00<00:00, 43.85it/s] 56%|█████▌    | 25/45 [00:00<00:00, 44.98it/s] 67%|██████▋   | 30/45 [00:00<00:00, 45.04it/s] 78%|███████▊  | 35/45 [00:00<00:00, 39.64it/s] 89%|████████▉ | 40/45 [00:00<00:00, 39.60it/s]100%|██████████| 45/45 [00:01<00:00, 39.67it/s]100%|██████████| 45/45 [00:01<00:00, 41.59it/s]

Clustering Summary (n_clusters=10):
  Mean within-cluster distance: 0.4133
  Mean between-cluster distance: 0.4256
  Separation ratio: 1.0298
  Cluster size distribution: min=75, max=3047, mean=1100.8

--- Analyzing with 50 clusters ---
Computing metrics for 50 clusters...
Computing within-cluster distances:   0%|          | 0/50 [00:00<?, ?it/s]Computing within-cluster distances:  58%|█████▊    | 29/50 [00:00<00:00, 282.62it/s]Computing within-cluster distances: 100%|██████████| 50/50 [00:00<00:00, 167.45it/s]
Computing between-cluster distances for 1000 cluster pairs...
  0%|          | 0/1000 [00:00<?, ?it/s]  1%|          | 12/1000 [00:00<00:09, 107.83it/s]  2%|▎         | 25/1000 [00:00<00:08, 118.24it/s]  4%|▍         | 39/1000 [00:00<00:07, 124.27it/s]  5%|▌         | 54/1000 [00:00<00:07, 128.42it/s]  7%|▋         | 71/1000 [00:00<00:06, 137.81it/s]  8%|▊         | 85/1000 [00:00<00:06, 133.40it/s] 10%|▉         | 99/1000 [00:00<00:06, 132.56it/s] 11%|█▏        | 114/1000 [00:00<00:06, 136.87it/s] 13%|█▎        | 128/1000 [00:00<00:06, 128.45it/s] 14%|█▍        | 142/1000 [00:01<00:06, 129.63it/s] 16%|█▌        | 156/1000 [00:01<00:06, 123.41it/s] 17%|█▋        | 170/1000 [00:01<00:06, 125.33it/s] 19%|█▉        | 188/1000 [00:01<00:05, 137.01it/s] 20%|██        | 202/1000 [00:01<00:05, 136.52it/s] 22%|██▏       | 216/1000 [00:01<00:06, 122.53it/s] 23%|██▎       | 229/1000 [00:01<00:06, 117.11it/s] 25%|██▍       | 247/1000 [00:01<00:05, 132.85it/s] 26%|██▌       | 261/1000 [00:02<00:05, 127.52it/s] 28%|██▊       | 275/1000 [00:02<00:05, 125.56it/s] 29%|██▉       | 290/1000 [00:02<00:05, 129.61it/s] 30%|███       | 304/1000 [00:02<00:05, 119.48it/s] 32%|███▏      | 317/1000 [00:02<00:05, 118.54it/s] 33%|███▎      | 332/1000 [00:02<00:05, 126.04it/s] 34%|███▍      | 345/1000 [00:02<00:05, 120.99it/s] 36%|███▌      | 360/1000 [00:02<00:05, 123.87it/s] 37%|███▋      | 373/1000 [00:02<00:05, 116.61it/s] 39%|███▉      | 388/1000 [00:03<00:04, 125.12it/s] 40%|████      | 401/1000 [00:03<00:04, 125.86it/s] 41%|████▏     | 414/1000 [00:03<00:04, 123.95it/s] 43%|████▎     | 427/1000 [00:03<00:04, 122.18it/s] 44%|████▍     | 443/1000 [00:03<00:04, 127.74it/s] 46%|████▌     | 456/1000 [00:03<00:04, 127.87it/s] 48%|████▊     | 476/1000 [00:03<00:03, 144.46it/s] 50%|████▉     | 497/1000 [00:03<00:03, 162.16it/s] 51%|█████▏    | 514/1000 [00:04<00:04, 120.61it/s] 53%|█████▎    | 531/1000 [00:04<00:03, 128.07it/s] 55%|█████▍    | 546/1000 [00:04<00:03, 123.58it/s] 56%|█████▌    | 561/1000 [00:04<00:03, 129.57it/s] 58%|█████▊    | 577/1000 [00:04<00:03, 137.32it/s] 59%|█████▉    | 593/1000 [00:04<00:02, 142.73it/s] 61%|██████▏   | 614/1000 [00:04<00:02, 154.69it/s] 63%|██████▎   | 630/1000 [00:04<00:02, 151.27it/s] 65%|██████▌   | 650/1000 [00:04<00:02, 162.02it/s] 67%|██████▋   | 667/1000 [00:05<00:02, 151.80it/s] 68%|██████▊   | 683/1000 [00:05<00:02, 138.78it/s] 70%|███████   | 700/1000 [00:05<00:02, 144.22it/s] 72%|███████▏  | 715/1000 [00:05<00:01, 143.66it/s] 73%|███████▎  | 730/1000 [00:05<00:01, 135.55it/s] 75%|███████▍  | 747/1000 [00:05<00:01, 144.55it/s] 76%|███████▋  | 764/1000 [00:05<00:01, 149.55it/s] 78%|███████▊  | 780/1000 [00:05<00:01, 147.71it/s] 80%|███████▉  | 798/1000 [00:05<00:01, 156.70it/s] 81%|████████▏ | 814/1000 [00:06<00:01, 143.28it/s] 83%|████████▎ | 834/1000 [00:06<00:01, 152.64it/s] 85%|████████▌ | 850/1000 [00:06<00:01, 142.16it/s] 87%|████████▋ | 867/1000 [00:06<00:00, 148.53it/s] 88%|████████▊ | 885/1000 [00:06<00:00, 153.58it/s] 90%|█████████ | 905/1000 [00:06<00:00, 164.49it/s] 92%|█████████▏| 922/1000 [00:06<00:00, 162.81it/s] 94%|█████████▍| 940/1000 [00:06<00:00, 165.34it/s] 96%|█████████▌| 957/1000 [00:06<00:00, 164.33it/s] 98%|█████████▊| 977/1000 [00:07<00:00, 173.22it/s]100%|█████████▉| 995/1000 [00:07<00:00, 171.70it/s]100%|██████████| 1000/1000 [00:07<00:00, 138.42it/s]

Clustering Summary (n_clusters=50):
  Mean within-cluster distance: 0.4254
  Mean between-cluster distance: 0.4522
  Separation ratio: 1.0630
  Cluster size distribution: min=3, max=3047, mean=220.2

--- Analyzing with 100 clusters ---
Computing metrics for 100 clusters...
Computing within-cluster distances:   0%|          | 0/100 [00:00<?, ?it/s]Computing within-cluster distances:  57%|█████▋    | 57/100 [00:00<00:00, 541.60it/s]Computing within-cluster distances: 100%|██████████| 100/100 [00:00<00:00, 313.36it/s]
Computing between-cluster distances for 1000 cluster pairs...
  0%|          | 0/1000 [00:00<?, ?it/s]  2%|▏         | 22/1000 [00:00<00:04, 216.52it/s]  6%|▌         | 55/1000 [00:00<00:03, 265.22it/s]  8%|▊         | 82/1000 [00:00<00:03, 266.49it/s] 11%|█         | 109/1000 [00:00<00:03, 240.40it/s] 13%|█▎        | 134/1000 [00:00<00:03, 228.34it/s] 16%|█▌        | 160/1000 [00:00<00:03, 231.88it/s] 19%|█▉        | 189/1000 [00:00<00:03, 244.69it/s] 22%|██▏       | 222/1000 [00:00<00:02, 267.27it/s] 25%|██▍       | 249/1000 [00:00<00:02, 258.19it/s] 28%|██▊       | 275/1000 [00:01<00:03, 240.29it/s] 30%|███       | 303/1000 [00:01<00:02, 250.57it/s] 33%|███▎      | 329/1000 [00:01<00:02, 232.58it/s] 35%|███▌      | 353/1000 [00:01<00:02, 227.56it/s] 38%|███▊      | 377/1000 [00:01<00:02, 227.50it/s] 41%|████      | 410/1000 [00:01<00:02, 254.97it/s] 44%|████▎     | 436/1000 [00:01<00:02, 250.01it/s] 46%|████▌     | 462/1000 [00:01<00:02, 247.95it/s] 49%|████▉     | 490/1000 [00:01<00:01, 257.01it/s] 52%|█████▏    | 516/1000 [00:02<00:01, 249.32it/s] 54%|█████▍    | 542/1000 [00:02<00:01, 249.01it/s] 57%|█████▋    | 568/1000 [00:02<00:01, 236.79it/s] 59%|█████▉    | 592/1000 [00:02<00:01, 235.91it/s] 62%|██████▏   | 616/1000 [00:02<00:01, 235.46it/s] 64%|██████▍   | 644/1000 [00:02<00:01, 241.66it/s] 67%|██████▋   | 669/1000 [00:02<00:01, 237.73it/s] 69%|██████▉   | 693/1000 [00:02<00:01, 237.22it/s] 72%|███████▏  | 723/1000 [00:02<00:01, 252.13it/s] 75%|███████▌  | 752/1000 [00:03<00:00, 262.06it/s] 78%|███████▊  | 779/1000 [00:03<00:00, 263.75it/s] 81%|████████  | 806/1000 [00:03<00:00, 242.93it/s] 83%|████████▎ | 833/1000 [00:03<00:00, 249.61it/s] 86%|████████▋ | 864/1000 [00:03<00:00, 264.20it/s] 90%|█████████ | 900/1000 [00:03<00:00, 290.17it/s] 94%|█████████▎| 937/1000 [00:03<00:00, 311.99it/s] 97%|█████████▋| 969/1000 [00:03<00:00, 289.44it/s]100%|██████████| 1000/1000 [00:03<00:00, 292.86it/s]100%|██████████| 1000/1000 [00:03<00:00, 254.35it/s]

Clustering Summary (n_clusters=100):
  Mean within-cluster distance: 0.4169
  Mean between-cluster distance: 0.4523
  Separation ratio: 1.0847
  Cluster size distribution: min=2, max=3047, mean=110.1

--- Analyzing with 500 clusters ---
Computing metrics for 500 clusters...
Computing within-cluster distances:   0%|          | 0/500 [00:00<?, ?it/s]Computing within-cluster distances:  48%|████▊     | 238/500 [00:00<00:00, 2364.02it/s]Computing within-cluster distances:  95%|█████████▌| 475/500 [00:00<00:00, 728.43it/s] Computing within-cluster distances: 100%|██████████| 500/500 [00:00<00:00, 810.71it/s]
Computing between-cluster distances for 1000 cluster pairs...
  0%|          | 0/1000 [00:00<?, ?it/s]  7%|▋         | 68/1000 [00:00<00:01, 677.27it/s] 14%|█▎        | 136/1000 [00:00<00:01, 533.81it/s] 21%|██        | 208/1000 [00:00<00:01, 600.38it/s] 27%|██▋       | 270/1000 [00:00<00:01, 591.02it/s] 33%|███▎      | 331/1000 [00:00<00:01, 557.55it/s] 40%|███▉      | 397/1000 [00:00<00:01, 588.04it/s] 46%|████▌     | 457/1000 [00:00<00:00, 571.72it/s] 52%|█████▏    | 515/1000 [00:00<00:00, 571.56it/s] 57%|█████▋    | 573/1000 [00:00<00:00, 567.47it/s] 65%|██████▍   | 647/1000 [00:01<00:00, 617.04it/s] 71%|███████   | 710/1000 [00:01<00:00, 601.52it/s] 78%|███████▊  | 776/1000 [00:01<00:00, 618.34it/s] 84%|████████▍ | 839/1000 [00:01<00:00, 566.60it/s] 90%|█████████ | 905/1000 [00:01<00:00, 590.21it/s] 96%|█████████▋| 965/1000 [00:01<00:00, 580.17it/s]100%|██████████| 1000/1000 [00:01<00:00, 584.67it/s]

Clustering Summary (n_clusters=500):
  Mean within-cluster distance: 0.3559
  Mean between-cluster distance: 0.4379
  Separation ratio: 1.2306
  Cluster size distribution: min=2, max=1979, mean=22.0

--- Analyzing with 1000 clusters ---
Computing metrics for 1000 clusters...
Computing within-cluster distances:   0%|          | 0/1000 [00:00<?, ?it/s]Computing within-cluster distances:  40%|████      | 401/1000 [00:00<00:00, 4002.98it/s]Computing within-cluster distances:  80%|████████  | 802/1000 [00:00<00:00, 962.67it/s] Computing within-cluster distances: 100%|██████████| 1000/1000 [00:00<00:00, 1184.14it/s]
Computing between-cluster distances for 1000 cluster pairs...
  0%|          | 0/1000 [00:00<?, ?it/s]  7%|▋         | 69/1000 [00:00<00:01, 687.32it/s] 15%|█▌        | 153/1000 [00:00<00:01, 775.86it/s] 23%|██▎       | 231/1000 [00:00<00:01, 715.92it/s] 32%|███▏      | 318/1000 [00:00<00:00, 772.83it/s] 41%|████      | 406/1000 [00:00<00:00, 809.11it/s] 49%|████▉     | 488/1000 [00:00<00:00, 780.07it/s] 58%|█████▊    | 577/1000 [00:00<00:00, 812.98it/s] 67%|██████▋   | 670/1000 [00:00<00:00, 848.66it/s] 76%|███████▌  | 756/1000 [00:00<00:00, 842.69it/s] 84%|████████▍ | 843/1000 [00:01<00:00, 850.58it/s] 93%|█████████▎| 929/1000 [00:01<00:00, 833.08it/s]100%|██████████| 1000/1000 [00:01<00:00, 815.82it/s]

Clustering Summary (n_clusters=1000):
  Mean within-cluster distance: 0.2968
  Mean between-cluster distance: 0.4240
  Separation ratio: 1.4284
  Cluster size distribution: min=1, max=1065, mean=11.0

--- Analyzing with 2000 clusters ---
Computing metrics for 2000 clusters...
Computing within-cluster distances:   0%|          | 0/2000 [00:00<?, ?it/s]Computing within-cluster distances:  37%|███▋      | 742/2000 [00:00<00:00, 7387.32it/s]Computing within-cluster distances:  74%|███████▍  | 1481/2000 [00:00<00:00, 1476.37it/s]Computing within-cluster distances:  92%|█████████▏| 1841/2000 [00:00<00:00, 1778.80it/s]Computing within-cluster distances: 100%|██████████| 2000/2000 [00:01<00:00, 1953.06it/s]
Computing between-cluster distances for 1000 cluster pairs...
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 100/1000 [00:00<00:00, 980.68it/s] 24%|██▍       | 238/1000 [00:00<00:00, 1212.12it/s] 38%|███▊      | 375/1000 [00:00<00:00, 1280.07it/s] 50%|█████     | 505/1000 [00:00<00:00, 1281.02it/s] 63%|██████▎   | 634/1000 [00:00<00:00, 1199.07it/s] 77%|███████▋  | 771/1000 [00:00<00:00, 1253.36it/s] 92%|█████████▏| 917/1000 [00:00<00:00, 1315.61it/s]100%|██████████| 1000/1000 [00:00<00:00, 1256.69it/s]

Clustering Summary (n_clusters=2000):
  Mean within-cluster distance: 0.2036
  Mean between-cluster distance: 0.4085
  Separation ratio: 2.0061
  Cluster size distribution: min=1, max=914, mean=5.5

============================================================
Total computation time: 21.07 minutes
============================================================
✓ Intermediate results saved to: /home/datadi/burns/aws/workloads/results/metrics/agglomerative_clustering/agglomerative_clustering_full_results.json

============================================================
FULL ANALYSIS: /home/datadi/burns/aws/workloads/data/sparsegpt_unstructured/layer2-mlp.down_proj.pt
============================================================
Matrix shape: torch.Size([4096, 11008])
Computing pairwise Hamming distances for ALL 11008 features...
WARNING: This may take a long time and use significant memory...
Distance matrix computed (shape: (60582528,))
Computing hierarchical clustering linkage with method='ward'...
Linkage matrix computed

--- Analyzing with 10 clusters ---
Computing metrics for 10 clusters...
Computing within-cluster distances:   0%|          | 0/10 [00:00<?, ?it/s]Computing within-cluster distances:  50%|█████     | 5/10 [00:00<00:00, 47.53it/s]Computing within-cluster distances: 100%|██████████| 10/10 [00:00<00:00, 80.78it/s]
Computing between-cluster distances for 45 cluster pairs...
  0%|          | 0/45 [00:00<?, ?it/s] 24%|██▍       | 11/45 [00:00<00:00, 85.37it/s] 44%|████▍     | 20/45 [00:00<00:00, 84.71it/s] 64%|██████▍   | 29/45 [00:00<00:00, 51.74it/s] 89%|████████▉ | 40/45 [00:00<00:00, 60.10it/s]100%|██████████| 45/45 [00:00<00:00, 59.62it/s]

Clustering Summary (n_clusters=10):
  Mean within-cluster distance: 0.3933
  Mean between-cluster distance: 0.4098
  Separation ratio: 1.0421
  Cluster size distribution: min=4, max=6862, mean=1100.8

--- Analyzing with 50 clusters ---
Computing metrics for 50 clusters...
Computing within-cluster distances:   0%|          | 0/50 [00:00<?, ?it/s]Computing within-cluster distances:  18%|█▊        | 9/50 [00:00<00:00, 81.50it/s]Computing within-cluster distances:  38%|███▊      | 19/50 [00:00<00:00, 87.42it/s]Computing within-cluster distances:  56%|█████▌    | 28/50 [00:00<00:00, 82.64it/s]Computing within-cluster distances: 100%|██████████| 50/50 [00:00<00:00, 121.38it/s]
Computing between-cluster distances for 1000 cluster pairs...
  0%|          | 0/1000 [00:00<?, ?it/s]  1%|          | 10/1000 [00:00<00:11, 88.32it/s]  2%|▏         | 22/1000 [00:00<00:09, 103.29it/s]  3%|▎         | 33/1000 [00:00<00:11, 82.07it/s]   4%|▍         | 44/1000 [00:00<00:10, 89.31it/s]  6%|▌         | 55/1000 [00:00<00:10, 93.79it/s]  6%|▋         | 65/1000 [00:00<00:10, 90.85it/s]  8%|▊         | 75/1000 [00:00<00:10, 92.15it/s]  8%|▊         | 85/1000 [00:00<00:10, 88.50it/s] 10%|▉         | 95/1000 [00:01<00:09, 91.58it/s] 10%|█         | 105/1000 [00:01<00:09, 93.46it/s] 12%|█▏        | 115/1000 [00:01<00:10, 86.76it/s] 12%|█▏        | 124/1000 [00:01<00:10, 85.80it/s] 13%|█▎        | 134/1000 [00:01<00:09, 89.34it/s] 14%|█▍        | 144/1000 [00:01<00:09, 91.20it/s] 15%|█▌        | 154/1000 [00:01<00:09, 85.61it/s] 16%|█▋        | 164/1000 [00:01<00:09, 88.21it/s] 17%|█▋        | 173/1000 [00:01<00:09, 87.09it/s] 18%|█▊        | 185/1000 [00:02<00:08, 92.17it/s] 20%|█▉        | 195/1000 [00:02<00:08, 90.36it/s] 21%|██        | 206/1000 [00:02<00:08, 94.09it/s] 22%|██▏       | 217/1000 [00:02<00:07, 98.17it/s] 23%|██▎       | 229/1000 [00:02<00:07, 103.67it/s] 24%|██▍       | 240/1000 [00:02<00:08, 89.10it/s]  25%|██▌       | 251/1000 [00:02<00:07, 94.18it/s] 26%|██▌       | 261/1000 [00:02<00:08, 91.70it/s] 28%|██▊       | 275/1000 [00:02<00:06, 104.29it/s] 29%|██▊       | 286/1000 [00:03<00:07, 93.54it/s]  30%|██▉       | 296/1000 [00:03<00:07, 93.56it/s] 31%|███       | 308/1000 [00:03<00:07, 97.39it/s] 32%|███▏      | 318/1000 [00:03<00:06, 97.60it/s] 33%|███▎      | 328/1000 [00:03<00:07, 95.15it/s] 34%|███▍      | 339/1000 [00:03<00:06, 98.41it/s] 35%|███▍      | 349/1000 [00:03<00:06, 95.61it/s] 36%|███▌      | 362/1000 [00:03<00:06, 102.08it/s] 37%|███▋      | 373/1000 [00:03<00:06, 101.54it/s] 38%|███▊      | 384/1000 [00:04<00:06, 101.52it/s] 40%|███▉      | 395/1000 [00:04<00:06, 88.97it/s]  40%|████      | 405/1000 [00:04<00:06, 90.33it/s] 42%|████▏     | 416/1000 [00:04<00:06, 95.09it/s] 43%|████▎     | 426/1000 [00:04<00:06, 87.74it/s] 44%|████▎     | 436/1000 [00:04<00:06, 86.42it/s] 45%|████▍     | 448/1000 [00:04<00:05, 93.30it/s] 46%|████▌     | 458/1000 [00:04<00:05, 93.87it/s] 47%|████▋     | 469/1000 [00:05<00:05, 94.46it/s] 48%|████▊     | 479/1000 [00:05<00:05, 95.74it/s] 49%|████▉     | 489/1000 [00:05<00:05, 85.70it/s] 50%|█████     | 500/1000 [00:05<00:05, 90.38it/s] 51%|█████     | 512/1000 [00:05<00:05, 95.40it/s] 52%|█████▏    | 522/1000 [00:05<00:05, 94.48it/s] 53%|█████▎    | 532/1000 [00:05<00:05, 92.91it/s] 54%|█████▍    | 542/1000 [00:05<00:05, 89.95it/s] 55%|█████▌    | 554/1000 [00:05<00:04, 97.50it/s] 56%|█████▋    | 564/1000 [00:06<00:04, 89.77it/s] 57%|█████▋    | 574/1000 [00:06<00:04, 89.88it/s] 58%|█████▊    | 584/1000 [00:06<00:04, 88.88it/s] 59%|█████▉    | 594/1000 [00:06<00:04, 88.76it/s] 60%|██████    | 604/1000 [00:06<00:04, 88.90it/s] 61%|██████▏   | 613/1000 [00:06<00:04, 80.54it/s] 62%|██████▏   | 624/1000 [00:06<00:04, 86.46it/s] 63%|██████▎   | 634/1000 [00:06<00:04, 88.59it/s] 64%|██████▍   | 644/1000 [00:07<00:04, 88.98it/s] 65%|██████▌   | 654/1000 [00:07<00:03, 88.25it/s] 66%|██████▋   | 665/1000 [00:07<00:03, 93.28it/s] 68%|██████▊   | 675/1000 [00:07<00:03, 93.13it/s] 68%|██████▊   | 685/1000 [00:07<00:03, 89.62it/s] 70%|██████▉   | 695/1000 [00:07<00:03, 87.17it/s] 70%|███████   | 704/1000 [00:07<00:03, 87.14it/s] 72%|███████▏  | 715/1000 [00:07<00:03, 91.43it/s] 72%|███████▎  | 725/1000 [00:07<00:03, 88.07it/s] 74%|███████▎  | 736/1000 [00:08<00:02, 93.55it/s] 75%|███████▍  | 746/1000 [00:08<00:02, 92.05it/s] 76%|███████▌  | 759/1000 [00:08<00:02, 100.70it/s] 77%|███████▋  | 770/1000 [00:08<00:02, 86.02it/s]  78%|███████▊  | 780/1000 [00:08<00:02, 89.49it/s] 79%|███████▉  | 790/1000 [00:08<00:02, 90.74it/s] 80%|████████  | 800/1000 [00:08<00:02, 89.56it/s] 81%|████████  | 810/1000 [00:08<00:02, 88.25it/s] 82%|████████▏ | 819/1000 [00:08<00:02, 84.88it/s] 83%|████████▎ | 828/1000 [00:09<00:01, 86.24it/s] 84%|████████▍ | 838/1000 [00:09<00:01, 88.29it/s] 85%|████████▍ | 849/1000 [00:09<00:01, 94.31it/s] 86%|████████▌ | 859/1000 [00:09<00:01, 88.73it/s] 87%|████████▋ | 868/1000 [00:09<00:01, 88.88it/s] 88%|████████▊ | 877/1000 [00:09<00:01, 85.48it/s] 89%|████████▉ | 888/1000 [00:09<00:01, 90.23it/s] 90%|████████▉ | 898/1000 [00:09<00:01, 87.10it/s] 91%|█████████ | 907/1000 [00:09<00:01, 85.81it/s] 92%|█████████▏| 916/1000 [00:10<00:01, 83.84it/s] 93%|█████████▎| 928/1000 [00:10<00:00, 91.71it/s] 94%|█████████▍| 939/1000 [00:10<00:00, 92.72it/s] 95%|█████████▍| 949/1000 [00:10<00:00, 92.40it/s] 96%|█████████▌| 960/1000 [00:10<00:00, 93.92it/s] 97%|█████████▋| 970/1000 [00:10<00:00, 91.03it/s] 98%|█████████▊| 981/1000 [00:10<00:00, 94.07it/s] 99%|█████████▉| 991/1000 [00:10<00:00, 89.31it/s]100%|██████████| 1000/1000 [00:10<00:00, 91.26it/s]

Clustering Summary (n_clusters=50):
  Mean within-cluster distance: 0.3651
  Mean between-cluster distance: 0.3897
  Separation ratio: 1.0674
  Cluster size distribution: min=2, max=676, mean=220.2

--- Analyzing with 100 clusters ---
Computing metrics for 100 clusters...
Computing within-cluster distances:   0%|          | 0/100 [00:00<?, ?it/s]Computing within-cluster distances:  12%|█▏        | 12/100 [00:00<00:00, 117.57it/s]Computing within-cluster distances:  26%|██▌       | 26/100 [00:00<00:00, 125.93it/s]Computing within-cluster distances:  39%|███▉      | 39/100 [00:00<00:00, 124.85it/s]Computing within-cluster distances:  52%|█████▏    | 52/100 [00:00<00:00, 126.45it/s]Computing within-cluster distances:  66%|██████▌   | 66/100 [00:00<00:00, 130.87it/s]Computing within-cluster distances: 100%|██████████| 100/100 [00:00<00:00, 166.89it/s]
Computing between-cluster distances for 1000 cluster pairs...
  0%|          | 0/1000 [00:00<?, ?it/s]  1%|          | 12/1000 [00:00<00:08, 119.23it/s]  3%|▎         | 27/1000 [00:00<00:07, 136.95it/s]  4%|▍         | 43/1000 [00:00<00:06, 144.82it/s]  6%|▌         | 58/1000 [00:00<00:06, 144.65it/s]  7%|▋         | 73/1000 [00:00<00:06, 135.15it/s]  9%|▊         | 87/1000 [00:00<00:06, 135.35it/s] 10%|█         | 101/1000 [00:00<00:06, 133.58it/s] 12%|█▏        | 116/1000 [00:00<00:06, 137.22it/s] 13%|█▎        | 130/1000 [00:00<00:06, 131.98it/s] 14%|█▍        | 145/1000 [00:01<00:06, 136.08it/s] 16%|█▌        | 159/1000 [00:01<00:06, 131.60it/s] 17%|█▋        | 173/1000 [00:01<00:06, 122.18it/s] 19%|█▊        | 186/1000 [00:01<00:06, 123.72it/s] 20%|██        | 200/1000 [00:01<00:06, 128.18it/s] 22%|██▏       | 215/1000 [00:01<00:05, 131.12it/s] 23%|██▎       | 229/1000 [00:01<00:05, 132.47it/s] 24%|██▍       | 243/1000 [00:01<00:05, 127.04it/s] 26%|██▌       | 257/1000 [00:01<00:05, 130.52it/s] 27%|██▋       | 273/1000 [00:02<00:05, 137.56it/s] 29%|██▊       | 287/1000 [00:02<00:05, 131.36it/s] 30%|███       | 302/1000 [00:02<00:05, 135.84it/s] 32%|███▏      | 316/1000 [00:02<00:05, 124.96it/s] 33%|███▎      | 329/1000 [00:02<00:05, 122.46it/s] 34%|███▍      | 345/1000 [00:02<00:05, 130.83it/s] 36%|███▌      | 361/1000 [00:02<00:04, 134.25it/s] 38%|███▊      | 375/1000 [00:02<00:04, 132.97it/s] 39%|███▉      | 389/1000 [00:02<00:04, 127.56it/s] 40%|████      | 403/1000 [00:03<00:04, 128.93it/s] 42%|████▏     | 416/1000 [00:03<00:04, 122.41it/s] 43%|████▎     | 429/1000 [00:03<00:04, 116.31it/s] 44%|████▍     | 444/1000 [00:03<00:04, 124.78it/s] 46%|████▌     | 460/1000 [00:03<00:04, 131.04it/s] 47%|████▋     | 474/1000 [00:03<00:04, 130.08it/s] 49%|████▉     | 488/1000 [00:03<00:03, 131.71it/s] 50%|█████     | 502/1000 [00:03<00:03, 132.81it/s] 52%|█████▏    | 516/1000 [00:03<00:03, 127.04it/s] 53%|█████▎    | 532/1000 [00:04<00:03, 134.08it/s] 55%|█████▍    | 546/1000 [00:04<00:03, 131.25it/s] 56%|█████▌    | 562/1000 [00:04<00:03, 136.49it/s] 58%|█████▊    | 579/1000 [00:04<00:02, 142.25it/s] 59%|█████▉    | 594/1000 [00:04<00:02, 142.07it/s] 61%|██████    | 609/1000 [00:04<00:02, 144.02it/s] 62%|██████▏   | 624/1000 [00:04<00:02, 140.82it/s] 64%|██████▍   | 640/1000 [00:04<00:02, 144.57it/s] 66%|██████▌   | 655/1000 [00:04<00:02, 138.85it/s] 67%|██████▋   | 669/1000 [00:05<00:02, 131.37it/s] 68%|██████▊   | 685/1000 [00:05<00:02, 136.91it/s] 70%|██████▉   | 699/1000 [00:05<00:02, 136.96it/s] 71%|███████▏  | 713/1000 [00:05<00:02, 130.65it/s] 73%|███████▎  | 728/1000 [00:05<00:02, 132.52it/s] 74%|███████▍  | 742/1000 [00:05<00:01, 132.26it/s] 76%|███████▌  | 756/1000 [00:05<00:01, 133.44it/s] 77%|███████▋  | 770/1000 [00:05<00:01, 132.18it/s] 78%|███████▊  | 784/1000 [00:05<00:01, 129.00it/s] 80%|███████▉  | 798/1000 [00:06<00:01, 131.11it/s] 81%|████████  | 812/1000 [00:06<00:01, 125.80it/s] 82%|████████▎ | 825/1000 [00:06<00:01, 126.28it/s] 84%|████████▍ | 838/1000 [00:06<00:01, 121.56it/s] 85%|████████▌ | 852/1000 [00:06<00:01, 126.49it/s] 87%|████████▋ | 869/1000 [00:06<00:00, 134.68it/s] 88%|████████▊ | 883/1000 [00:06<00:00, 131.55it/s] 90%|████████▉ | 897/1000 [00:06<00:00, 130.53it/s] 91%|█████████ | 911/1000 [00:06<00:00, 129.38it/s] 93%|█████████▎| 927/1000 [00:07<00:00, 135.23it/s] 94%|█████████▍| 941/1000 [00:07<00:00, 134.75it/s] 96%|█████████▌| 955/1000 [00:07<00:00, 130.79it/s] 97%|█████████▋| 969/1000 [00:07<00:00, 130.99it/s] 99%|█████████▊| 987/1000 [00:07<00:00, 143.83it/s]100%|██████████| 1000/1000 [00:07<00:00, 132.19it/s]

Clustering Summary (n_clusters=100):
  Mean within-cluster distance: 0.3753
  Mean between-cluster distance: 0.3877
  Separation ratio: 1.0330
  Cluster size distribution: min=2, max=326, mean=110.1

--- Analyzing with 500 clusters ---
Computing metrics for 500 clusters...
Computing within-cluster distances:   0%|          | 0/500 [00:00<?, ?it/s]Computing within-cluster distances:   5%|▌         | 27/500 [00:00<00:01, 262.72it/s]Computing within-cluster distances:  11%|█         | 54/500 [00:00<00:01, 224.09it/s]Computing within-cluster distances:  16%|█▌        | 78/500 [00:00<00:01, 228.10it/s]Computing within-cluster distances:  21%|██        | 104/500 [00:00<00:01, 234.72it/s]Computing within-cluster distances:  26%|██▌       | 128/500 [00:00<00:01, 234.13it/s]Computing within-cluster distances:  31%|███       | 154/500 [00:00<00:01, 238.75it/s]Computing within-cluster distances:  36%|███▌      | 178/500 [00:00<00:01, 229.87it/s]Computing within-cluster distances:  41%|████      | 203/500 [00:00<00:01, 232.87it/s]Computing within-cluster distances:  46%|████▌     | 228/500 [00:00<00:01, 234.15it/s]Computing within-cluster distances:  50%|█████     | 252/500 [00:01<00:01, 231.53it/s]Computing within-cluster distances:  55%|█████▌    | 276/500 [00:01<00:00, 232.81it/s]Computing within-cluster distances:  60%|██████    | 300/500 [00:01<00:00, 229.91it/s]Computing within-cluster distances:  65%|██████▍   | 324/500 [00:01<00:00, 230.01it/s]Computing within-cluster distances:  70%|██████▉   | 349/500 [00:01<00:00, 235.35it/s]Computing within-cluster distances:  75%|███████▍  | 373/500 [00:01<00:00, 230.36it/s]Computing within-cluster distances:  80%|███████▉  | 399/500 [00:01<00:00, 238.52it/s]Computing within-cluster distances:  93%|█████████▎| 465/500 [00:01<00:00, 361.56it/s]Computing within-cluster distances: 100%|██████████| 500/500 [00:01<00:00, 272.69it/s]
Computing between-cluster distances for 1000 cluster pairs...
  0%|          | 0/1000 [00:00<?, ?it/s]  3%|▎         | 32/1000 [00:00<00:03, 313.27it/s]  6%|▋         | 64/1000 [00:00<00:03, 305.80it/s] 10%|▉         | 95/1000 [00:00<00:02, 305.92it/s] 13%|█▎        | 127/1000 [00:00<00:02, 308.38it/s] 16%|█▌        | 158/1000 [00:00<00:02, 304.27it/s] 19%|█▉        | 189/1000 [00:00<00:02, 303.56it/s] 22%|██▏       | 220/1000 [00:00<00:02, 296.01it/s] 25%|██▌       | 251/1000 [00:00<00:02, 298.83it/s] 28%|██▊       | 283/1000 [00:00<00:02, 302.08it/s] 32%|███▏      | 315/1000 [00:01<00:02, 306.31it/s] 35%|███▍      | 347/1000 [00:01<00:02, 308.70it/s] 38%|███▊      | 378/1000 [00:01<00:02, 304.02it/s] 41%|████      | 410/1000 [00:01<00:01, 308.02it/s] 44%|████▍     | 441/1000 [00:01<00:01, 305.85it/s] 47%|████▋     | 473/1000 [00:01<00:01, 308.47it/s] 50%|█████     | 504/1000 [00:01<00:01, 300.80it/s] 54%|█████▎    | 535/1000 [00:01<00:01, 300.91it/s] 57%|█████▋    | 566/1000 [00:01<00:01, 302.38it/s] 60%|█████▉    | 597/1000 [00:01<00:01, 303.26it/s] 63%|██████▎   | 629/1000 [00:02<00:01, 305.61it/s] 66%|██████▌   | 660/1000 [00:02<00:01, 302.29it/s] 69%|██████▉   | 691/1000 [00:02<00:01, 300.51it/s] 72%|███████▏  | 722/1000 [00:02<00:00, 301.92it/s] 75%|███████▌  | 753/1000 [00:02<00:00, 297.36it/s] 78%|███████▊  | 784/1000 [00:02<00:00, 298.09it/s] 81%|████████▏ | 814/1000 [00:02<00:00, 295.36it/s] 85%|████████▍ | 846/1000 [00:02<00:00, 301.06it/s] 88%|████████▊ | 877/1000 [00:02<00:00, 295.39it/s] 91%|█████████ | 908/1000 [00:03<00:00, 296.89it/s] 94%|█████████▍| 938/1000 [00:03<00:00, 296.89it/s] 97%|█████████▋| 970/1000 [00:03<00:00, 302.13it/s]100%|██████████| 1000/1000 [00:03<00:00, 301.84it/s]

Clustering Summary (n_clusters=500):
  Mean within-cluster distance: 0.3621
  Mean between-cluster distance: 0.3805
  Separation ratio: 1.0509
  Cluster size distribution: min=1, max=59, mean=22.0

--- Analyzing with 1000 clusters ---
Computing metrics for 1000 clusters...
Computing within-cluster distances:   0%|          | 0/1000 [00:00<?, ?it/s]Computing within-cluster distances:   5%|▌         | 52/1000 [00:00<00:01, 518.93it/s]Computing within-cluster distances:  10%|█         | 104/1000 [00:00<00:02, 419.47it/s]Computing within-cluster distances:  15%|█▍        | 148/1000 [00:00<00:02, 377.47it/s]Computing within-cluster distances:  19%|█▊        | 187/1000 [00:00<00:02, 369.31it/s]Computing within-cluster distances:  23%|██▎       | 227/1000 [00:00<00:02, 377.52it/s]Computing within-cluster distances:  27%|██▋       | 266/1000 [00:00<00:01, 377.46it/s]Computing within-cluster distances:  31%|███       | 310/1000 [00:00<00:01, 394.71it/s]Computing within-cluster distances:  35%|███▌      | 350/1000 [00:00<00:01, 389.06it/s]Computing within-cluster distances:  39%|███▉      | 390/1000 [00:01<00:01, 373.64it/s]Computing within-cluster distances:  43%|████▎     | 428/1000 [00:01<00:01, 373.92it/s]Computing within-cluster distances:  47%|████▋     | 470/1000 [00:01<00:01, 386.18it/s]Computing within-cluster distances:  51%|█████     | 509/1000 [00:01<00:01, 378.88it/s]Computing within-cluster distances:  55%|█████▍    | 548/1000 [00:01<00:01, 375.92it/s]Computing within-cluster distances:  59%|█████▊    | 586/1000 [00:01<00:01, 374.01it/s]Computing within-cluster distances:  62%|██████▏   | 624/1000 [00:01<00:01, 373.92it/s]Computing within-cluster distances:  67%|██████▋   | 666/1000 [00:01<00:00, 384.42it/s]Computing within-cluster distances:  71%|███████   | 707/1000 [00:01<00:00, 391.39it/s]Computing within-cluster distances:  75%|███████▍  | 747/1000 [00:01<00:00, 393.01it/s]Computing within-cluster distances:  79%|███████▊  | 787/1000 [00:02<00:00, 373.88it/s]Computing within-cluster distances:  82%|████████▎ | 825/1000 [00:02<00:00, 365.97it/s]Computing within-cluster distances:  90%|████████▉ | 897/1000 [00:02<00:00, 466.03it/s]Computing within-cluster distances: 100%|██████████| 1000/1000 [00:02<00:00, 434.39it/s]
Computing between-cluster distances for 1000 cluster pairs...
  0%|          | 0/1000 [00:00<?, ?it/s]  4%|▍         | 41/1000 [00:00<00:02, 409.14it/s]  8%|▊         | 84/1000 [00:00<00:02, 418.85it/s] 13%|█▎        | 126/1000 [00:00<00:02, 398.93it/s] 17%|█▋        | 168/1000 [00:00<00:02, 403.43it/s] 21%|██▏       | 213/1000 [00:00<00:01, 417.05it/s] 26%|██▌       | 257/1000 [00:00<00:01, 423.36it/s] 30%|███       | 300/1000 [00:00<00:01, 425.07it/s] 35%|███▍      | 347/1000 [00:00<00:01, 436.71it/s] 39%|███▉      | 392/1000 [00:00<00:01, 438.49it/s] 44%|████▎     | 436/1000 [00:01<00:01, 432.60it/s] 48%|████▊     | 480/1000 [00:01<00:01, 432.52it/s] 52%|█████▎    | 525/1000 [00:01<00:01, 436.41it/s] 57%|█████▋    | 569/1000 [00:01<00:01, 420.42it/s] 61%|██████▏   | 614/1000 [00:01<00:00, 428.66it/s] 66%|██████▌   | 657/1000 [00:01<00:00, 418.14it/s] 70%|███████   | 700/1000 [00:01<00:00, 420.50it/s] 74%|███████▍  | 745/1000 [00:01<00:00, 425.46it/s] 79%|███████▉  | 788/1000 [00:01<00:00, 421.34it/s] 83%|████████▎ | 833/1000 [00:01<00:00, 428.12it/s] 88%|████████▊ | 876/1000 [00:02<00:00, 425.45it/s] 92%|█████████▏| 919/1000 [00:02<00:00, 420.55it/s] 96%|█████████▌| 962/1000 [00:02<00:00, 413.78it/s]100%|██████████| 1000/1000 [00:02<00:00, 422.54it/s]

Clustering Summary (n_clusters=1000):
  Mean within-cluster distance: 0.3524
  Mean between-cluster distance: 0.3781
  Separation ratio: 1.0728
  Cluster size distribution: min=1, max=41, mean=11.0

--- Analyzing with 2000 clusters ---
Computing metrics for 2000 clusters...
Computing within-cluster distances:   0%|          | 0/2000 [00:00<?, ?it/s]Computing within-cluster distances:   7%|▋         | 148/2000 [00:00<00:01, 1473.94it/s]Computing within-cluster distances:  15%|█▍        | 296/2000 [00:00<00:01, 1278.98it/s]Computing within-cluster distances:  21%|██▏       | 426/2000 [00:00<00:01, 1240.71it/s]Computing within-cluster distances:  28%|██▊       | 551/2000 [00:00<00:01, 1226.37it/s]Computing within-cluster distances:  34%|███▍      | 675/2000 [00:00<00:01, 1198.83it/s]Computing within-cluster distances:  40%|████      | 806/2000 [00:00<00:00, 1231.81it/s]Computing within-cluster distances:  46%|████▋     | 930/2000 [00:00<00:00, 1197.48it/s]Computing within-cluster distances:  53%|█████▎    | 1051/2000 [00:00<00:00, 1177.69it/s]Computing within-cluster distances:  59%|█████▉    | 1176/2000 [00:00<00:00, 1198.41it/s]Computing within-cluster distances:  65%|██████▍   | 1297/2000 [00:01<00:00, 1178.76it/s]Computing within-cluster distances:  72%|███████▏  | 1447/2000 [00:01<00:00, 1273.48it/s]Computing within-cluster distances:  79%|███████▉  | 1580/2000 [00:01<00:00, 1287.35it/s]Computing within-cluster distances:  86%|████████▌ | 1710/2000 [00:01<00:00, 1234.14it/s]Computing within-cluster distances:  98%|█████████▊| 1960/2000 [00:01<00:00, 1598.61it/s]Computing within-cluster distances: 100%|██████████| 2000/2000 [00:01<00:00, 1332.00it/s]
Computing between-cluster distances for 1000 cluster pairs...
  0%|          | 0/1000 [00:00<?, ?it/s]  6%|▌         | 62/1000 [00:00<00:01, 617.27it/s] 13%|█▎        | 134/1000 [00:00<00:01, 674.32it/s] 20%|██        | 203/1000 [00:00<00:01, 679.90it/s] 27%|██▋       | 272/1000 [00:00<00:01, 680.03it/s] 34%|███▍      | 341/1000 [00:00<00:00, 675.02it/s] 41%|████      | 409/1000 [00:00<00:00, 671.12it/s] 48%|████▊     | 477/1000 [00:00<00:00, 670.00it/s] 55%|█████▍    | 546/1000 [00:00<00:00, 674.40it/s] 61%|██████▏   | 614/1000 [00:00<00:00, 671.59it/s] 69%|██████▉   | 689/1000 [00:01<00:00, 695.22it/s] 76%|███████▌  | 759/1000 [00:01<00:00, 675.72it/s] 83%|████████▎ | 830/1000 [00:01<00:00, 685.84it/s] 90%|████████▉ | 899/1000 [00:01<00:00, 680.02it/s] 97%|█████████▋| 968/1000 [00:01<00:00, 679.08it/s]100%|██████████| 1000/1000 [00:01<00:00, 677.82it/s]

Clustering Summary (n_clusters=2000):
  Mean within-cluster distance: 0.3360
  Mean between-cluster distance: 0.3752
  Separation ratio: 1.1168
  Cluster size distribution: min=1, max=23, mean=5.5

============================================================
Total computation time: 19.25 minutes
============================================================
✓ Intermediate results saved to: /home/datadi/burns/aws/workloads/results/metrics/agglomerative_clustering/agglomerative_clustering_full_results.json

============================================================
FULL ANALYSIS: /home/datadi/burns/aws/workloads/data/sparsegpt_unstructured/layer3-mlp.down_proj.pt
============================================================
Matrix shape: torch.Size([4096, 11008])
Computing pairwise Hamming distances for ALL 11008 features...
WARNING: This may take a long time and use significant memory...
Distance matrix computed (shape: (60582528,))
Computing hierarchical clustering linkage with method='ward'...
Linkage matrix computed

--- Analyzing with 10 clusters ---
Computing metrics for 10 clusters...
Computing within-cluster distances:   0%|          | 0/10 [00:00<?, ?it/s]Computing within-cluster distances:  80%|████████  | 8/10 [00:00<00:00, 74.19it/s]Computing within-cluster distances: 100%|██████████| 10/10 [00:00<00:00, 82.15it/s]
Computing between-cluster distances for 45 cluster pairs...
  0%|          | 0/45 [00:00<?, ?it/s] 22%|██▏       | 10/45 [00:00<00:00, 80.72it/s] 42%|████▏     | 19/45 [00:00<00:00, 61.35it/s] 58%|█████▊    | 26/45 [00:00<00:00, 51.37it/s] 71%|███████   | 32/45 [00:00<00:00, 51.49it/s] 89%|████████▉ | 40/45 [00:00<00:00, 56.27it/s]100%|██████████| 45/45 [00:00<00:00, 53.52it/s]

Clustering Summary (n_clusters=10):
  Mean within-cluster distance: 0.4070
  Mean between-cluster distance: 0.4162
  Separation ratio: 1.0227
  Cluster size distribution: min=13, max=5179, mean=1100.8

--- Analyzing with 50 clusters ---
Computing metrics for 50 clusters...
Computing within-cluster distances:   0%|          | 0/50 [00:00<?, ?it/s]Computing within-cluster distances:  28%|██▊       | 14/50 [00:00<00:00, 138.04it/s]Computing within-cluster distances:  66%|██████▌   | 33/50 [00:00<00:00, 165.15it/s]Computing within-cluster distances: 100%|██████████| 50/50 [00:00<00:00, 199.92it/s]
Computing between-cluster distances for 1000 cluster pairs...
  0%|          | 0/1000 [00:00<?, ?it/s]  2%|▎         | 25/1000 [00:00<00:04, 232.83it/s]  5%|▍         | 49/1000 [00:00<00:04, 202.35it/s]  7%|▋         | 70/1000 [00:00<00:04, 191.96it/s]  9%|▉         | 92/1000 [00:00<00:04, 196.44it/s] 11%|█         | 112/1000 [00:00<00:04, 186.28it/s] 13%|█▎        | 132/1000 [00:00<00:04, 189.89it/s] 15%|█▌        | 152/1000 [00:00<00:04, 180.16it/s] 17%|█▋        | 171/1000 [00:00<00:04, 180.40it/s] 19%|█▉        | 190/1000 [00:01<00:04, 182.99it/s] 21%|██        | 209/1000 [00:01<00:04, 162.32it/s] 23%|██▎       | 226/1000 [00:01<00:04, 154.84it/s] 24%|██▍       | 242/1000 [00:01<00:04, 154.52it/s] 26%|██▌       | 259/1000 [00:01<00:04, 156.60it/s] 28%|██▊       | 275/1000 [00:01<00:05, 144.21it/s] 29%|██▉       | 290/1000 [00:01<00:05, 139.60it/s] 30%|███       | 305/1000 [00:01<00:04, 140.77it/s] 32%|███▏      | 320/1000 [00:02<00:05, 121.69it/s] 33%|███▎      | 333/1000 [00:02<00:05, 118.37it/s] 35%|███▌      | 350/1000 [00:02<00:05, 128.94it/s] 36%|███▋      | 364/1000 [00:02<00:05, 107.45it/s] 38%|███▊      | 378/1000 [00:02<00:05, 114.40it/s] 39%|███▉      | 392/1000 [00:02<00:05, 120.44it/s] 40%|████      | 405/1000 [00:02<00:05, 113.77it/s] 42%|████▎     | 425/1000 [00:02<00:04, 133.83it/s] 44%|████▍     | 441/1000 [00:02<00:04, 136.87it/s] 46%|████▋     | 463/1000 [00:03<00:03, 158.61it/s] 48%|████▊     | 483/1000 [00:03<00:03, 169.46it/s] 50%|█████     | 503/1000 [00:03<00:02, 176.62it/s] 52%|█████▏    | 523/1000 [00:03<00:02, 177.53it/s] 54%|█████▍    | 544/1000 [00:03<00:02, 183.77it/s] 56%|█████▋    | 563/1000 [00:03<00:02, 174.93it/s] 58%|█████▊    | 581/1000 [00:03<00:02, 170.96it/s] 60%|██████    | 600/1000 [00:03<00:02, 175.28it/s] 62%|██████▏   | 619/1000 [00:03<00:02, 178.61it/s] 64%|██████▎   | 637/1000 [00:04<00:02, 174.19it/s] 66%|██████▌   | 655/1000 [00:04<00:02, 170.16it/s] 67%|██████▋   | 673/1000 [00:04<00:02, 158.44it/s] 69%|██████▉   | 690/1000 [00:04<00:02, 144.13it/s] 71%|███████   | 707/1000 [00:04<00:01, 147.64it/s] 72%|███████▎  | 725/1000 [00:04<00:01, 155.87it/s] 74%|███████▍  | 741/1000 [00:04<00:01, 152.03it/s] 76%|███████▌  | 757/1000 [00:04<00:01, 146.83it/s] 78%|███████▊  | 775/1000 [00:04<00:01, 152.45it/s] 79%|███████▉  | 791/1000 [00:05<00:01, 135.99it/s] 80%|████████  | 805/1000 [00:05<00:01, 126.23it/s] 82%|████████▏ | 823/1000 [00:05<00:01, 138.24it/s] 84%|████████▍ | 838/1000 [00:05<00:01, 119.58it/s] 86%|████████▌ | 855/1000 [00:05<00:01, 129.83it/s] 87%|████████▋ | 869/1000 [00:05<00:01, 128.03it/s] 89%|████████▉ | 888/1000 [00:05<00:00, 143.70it/s] 91%|█████████ | 907/1000 [00:05<00:00, 151.18it/s] 92%|█████████▏| 923/1000 [00:06<00:00, 135.49it/s] 94%|█████████▍| 945/1000 [00:06<00:00, 155.15it/s] 96%|█████████▋| 963/1000 [00:06<00:00, 160.40it/s] 98%|█████████▊| 984/1000 [00:06<00:00, 172.53it/s]100%|██████████| 1000/1000 [00:06<00:00, 152.94it/s]

Clustering Summary (n_clusters=50):
  Mean within-cluster distance: 0.4036
  Mean between-cluster distance: 0.4221
  Separation ratio: 1.0457
  Cluster size distribution: min=3, max=3289, mean=220.2

--- Analyzing with 100 clusters ---
Computing metrics for 100 clusters...
Computing within-cluster distances:   0%|          | 0/100 [00:00<?, ?it/s]Computing within-cluster distances:  10%|█         | 10/100 [00:00<00:01, 83.14it/s]Computing within-cluster distances:  40%|████      | 40/100 [00:00<00:00, 197.02it/s]Computing within-cluster distances:  65%|██████▌   | 65/100 [00:00<00:00, 219.87it/s]Computing within-cluster distances: 100%|██████████| 100/100 [00:00<00:00, 239.74it/s]
Computing between-cluster distances for 1000 cluster pairs...
  0%|          | 0/1000 [00:00<?, ?it/s]  3%|▎         | 26/1000 [00:00<00:03, 254.50it/s]  5%|▌         | 52/1000 [00:00<00:05, 187.65it/s]  7%|▋         | 73/1000 [00:00<00:04, 188.10it/s] 10%|▉         | 95/1000 [00:00<00:04, 197.67it/s] 12%|█▏        | 116/1000 [00:00<00:04, 190.43it/s] 14%|█▍        | 139/1000 [00:00<00:04, 201.06it/s] 16%|█▋        | 163/1000 [00:00<00:03, 209.98it/s] 18%|█▊        | 185/1000 [00:00<00:03, 206.09it/s] 21%|██        | 206/1000 [00:01<00:03, 204.27it/s] 23%|██▎       | 231/1000 [00:01<00:03, 212.97it/s] 25%|██▌       | 253/1000 [00:01<00:03, 205.32it/s] 28%|██▊       | 276/1000 [00:01<00:03, 210.70it/s] 30%|███       | 300/1000 [00:01<00:03, 215.03it/s] 32%|███▏      | 322/1000 [00:01<00:03, 208.05it/s] 34%|███▍      | 343/1000 [00:01<00:03, 194.32it/s] 36%|███▋      | 363/1000 [00:01<00:03, 184.76it/s] 38%|███▊      | 382/1000 [00:01<00:03, 177.85it/s] 40%|████      | 401/1000 [00:02<00:03, 180.24it/s] 42%|████▏     | 424/1000 [00:02<00:03, 190.46it/s] 44%|████▍     | 444/1000 [00:02<00:03, 185.28it/s] 47%|████▋     | 471/1000 [00:02<00:02, 206.82it/s] 49%|████▉     | 492/1000 [00:02<00:02, 200.75it/s] 51%|█████▏    | 513/1000 [00:02<00:02, 182.49it/s] 54%|█████▎    | 535/1000 [00:02<00:02, 190.86it/s] 56%|█████▌    | 562/1000 [00:02<00:02, 212.24it/s] 59%|█████▉    | 588/1000 [00:02<00:01, 221.88it/s] 62%|██████▏   | 616/1000 [00:03<00:01, 238.07it/s] 64%|██████▍   | 641/1000 [00:03<00:01, 230.57it/s] 66%|██████▋   | 665/1000 [00:03<00:01, 189.67it/s] 69%|██████▉   | 691/1000 [00:03<00:01, 206.64it/s] 71%|███████▏  | 713/1000 [00:03<00:01, 199.98it/s] 73%|███████▎  | 734/1000 [00:03<00:01, 201.76it/s] 76%|███████▌  | 756/1000 [00:03<00:01, 199.91it/s] 78%|███████▊  | 777/1000 [00:03<00:01, 196.18it/s] 80%|████████  | 802/1000 [00:03<00:00, 205.80it/s] 82%|████████▎ | 825/1000 [00:04<00:00, 211.45it/s] 85%|████████▍ | 847/1000 [00:04<00:00, 195.57it/s] 87%|████████▋ | 867/1000 [00:04<00:00, 194.44it/s] 89%|████████▉ | 889/1000 [00:04<00:00, 200.57it/s] 91%|█████████ | 910/1000 [00:04<00:00, 190.37it/s] 93%|█████████▎| 931/1000 [00:04<00:00, 193.99it/s] 95%|█████████▌| 953/1000 [00:04<00:00, 199.78it/s] 97%|█████████▋| 974/1000 [00:04<00:00, 189.18it/s]100%|█████████▉| 996/1000 [00:04<00:00, 195.97it/s]100%|██████████| 1000/1000 [00:05<00:00, 199.87it/s]

Clustering Summary (n_clusters=100):
  Mean within-cluster distance: 0.3990
  Mean between-cluster distance: 0.4217
  Separation ratio: 1.0568
  Cluster size distribution: min=2, max=2065, mean=110.1

--- Analyzing with 500 clusters ---
Computing metrics for 500 clusters...
Computing within-cluster distances:   0%|          | 0/500 [00:00<?, ?it/s]Computing within-cluster distances:   4%|▍         | 21/500 [00:00<00:02, 209.32it/s]Computing within-cluster distances:   9%|▉         | 44/500 [00:00<00:02, 216.60it/s]Computing within-cluster distances:  14%|█▎        | 68/500 [00:00<00:01, 225.01it/s]Computing within-cluster distances:  18%|█▊        | 92/500 [00:00<00:01, 227.71it/s]Computing within-cluster distances:  23%|██▎       | 115/500 [00:00<00:01, 194.17it/s]Computing within-cluster distances:  27%|██▋       | 136/500 [00:00<00:01, 195.65it/s]Computing within-cluster distances:  46%|████▌     | 228/500 [00:00<00:00, 408.62it/s]Computing within-cluster distances:  54%|█████▍    | 272/500 [00:00<00:00, 395.25it/s]Computing within-cluster distances:  74%|███████▎  | 368/500 [00:00<00:00, 555.83it/s]Computing within-cluster distances: 100%|██████████| 500/500 [00:01<00:00, 467.55it/s]
Computing between-cluster distances for 1000 cluster pairs...
  0%|          | 0/1000 [00:00<?, ?it/s]  5%|▍         | 49/1000 [00:00<00:01, 484.38it/s] 10%|▉         | 98/1000 [00:00<00:02, 440.40it/s] 14%|█▍        | 143/1000 [00:00<00:02, 407.02it/s] 18%|█▊        | 185/1000 [00:00<00:01, 409.23it/s] 23%|██▎       | 227/1000 [00:00<00:01, 393.34it/s] 27%|██▋       | 267/1000 [00:00<00:01, 390.86it/s] 31%|███       | 307/1000 [00:00<00:01, 371.30it/s] 35%|███▍      | 349/1000 [00:00<00:01, 381.52it/s] 39%|███▉      | 392/1000 [00:00<00:01, 389.24it/s] 43%|████▎     | 434/1000 [00:01<00:01, 395.67it/s] 47%|████▋     | 474/1000 [00:01<00:01, 394.85it/s] 51%|█████▏    | 514/1000 [00:01<00:01, 385.88it/s] 56%|█████▌    | 557/1000 [00:01<00:01, 394.74it/s] 60%|██████    | 603/1000 [00:01<00:00, 408.91it/s] 65%|██████▍   | 649/1000 [00:01<00:00, 423.66it/s] 69%|██████▉   | 692/1000 [00:01<00:00, 405.65it/s] 73%|███████▎  | 733/1000 [00:01<00:00, 394.66it/s] 78%|███████▊  | 781/1000 [00:01<00:00, 415.93it/s] 83%|████████▎ | 826/1000 [00:02<00:00, 424.91it/s] 87%|████████▋ | 869/1000 [00:02<00:00, 416.02it/s] 91%|█████████ | 911/1000 [00:02<00:00, 406.32it/s] 96%|█████████▌| 957/1000 [00:02<00:00, 414.35it/s]100%|█████████▉| 999/1000 [00:02<00:00, 407.90it/s]100%|██████████| 1000/1000 [00:02<00:00, 404.13it/s]

Clustering Summary (n_clusters=500):
  Mean within-cluster distance: 0.3580
  Mean between-cluster distance: 0.4048
  Separation ratio: 1.1308
  Cluster size distribution: min=1, max=398, mean=22.0

--- Analyzing with 1000 clusters ---
Computing metrics for 1000 clusters...
Computing within-cluster distances:   0%|          | 0/1000 [00:00<?, ?it/s]Computing within-cluster distances:   4%|▎         | 35/1000 [00:00<00:02, 349.93it/s]Computing within-cluster distances:   8%|▊         | 79/1000 [00:00<00:02, 401.97it/s]Computing within-cluster distances:  12%|█▏        | 120/1000 [00:00<00:02, 380.28it/s]Computing within-cluster distances:  16%|█▌        | 159/1000 [00:00<00:02, 377.54it/s]Computing within-cluster distances:  20%|█▉        | 197/1000 [00:00<00:02, 367.77it/s]Computing within-cluster distances:  23%|██▎       | 234/1000 [00:00<00:02, 305.45it/s]Computing within-cluster distances:  27%|██▋       | 267/1000 [00:00<00:02, 285.21it/s]Computing within-cluster distances:  30%|██▉       | 297/1000 [00:00<00:02, 267.20it/s]Computing within-cluster distances:  32%|███▎      | 325/1000 [00:01<00:02, 261.96it/s]Computing within-cluster distances:  47%|████▋     | 469/1000 [00:01<00:00, 572.45it/s]Computing within-cluster distances:  58%|█████▊    | 581/1000 [00:01<00:00, 721.01it/s]Computing within-cluster distances:  81%|████████  | 809/1000 [00:01<00:00, 1156.84it/s]Computing within-cluster distances: 100%|██████████| 1000/1000 [00:01<00:00, 700.28it/s]
Computing between-cluster distances for 1000 cluster pairs...
  0%|          | 0/1000 [00:00<?, ?it/s]  6%|▌         | 55/1000 [00:00<00:01, 546.74it/s] 11%|█         | 110/1000 [00:00<00:01, 545.50it/s] 18%|█▊        | 175/1000 [00:00<00:01, 591.98it/s] 24%|██▎       | 235/1000 [00:00<00:01, 588.41it/s] 30%|██▉       | 298/1000 [00:00<00:01, 598.49it/s] 37%|███▋      | 368/1000 [00:00<00:01, 630.06it/s] 43%|████▎     | 432/1000 [00:00<00:00, 611.15it/s] 49%|████▉     | 494/1000 [00:00<00:00, 611.11it/s] 56%|█████▌    | 556/1000 [00:00<00:00, 592.17it/s] 62%|██████▏   | 618/1000 [00:01<00:00, 596.17it/s] 68%|██████▊   | 678/1000 [00:01<00:00, 589.14it/s] 74%|███████▎  | 737/1000 [00:01<00:00, 569.39it/s] 80%|████████  | 801/1000 [00:01<00:00, 588.58it/s] 86%|████████▌ | 862/1000 [00:01<00:00, 588.82it/s] 93%|█████████▎| 929/1000 [00:01<00:00, 609.13it/s] 99%|█████████▉| 993/1000 [00:01<00:00, 612.74it/s]100%|██████████| 1000/1000 [00:01<00:00, 597.53it/s]

Clustering Summary (n_clusters=1000):
  Mean within-cluster distance: 0.3125
  Mean between-cluster distance: 0.3961
  Separation ratio: 1.2676
  Cluster size distribution: min=1, max=197, mean=11.0

--- Analyzing with 2000 clusters ---
Computing metrics for 2000 clusters...
Computing within-cluster distances:   0%|          | 0/2000 [00:00<?, ?it/s]Computing within-cluster distances:   6%|▌         | 115/2000 [00:00<00:01, 1146.88it/s]Computing within-cluster distances:  13%|█▎        | 263/2000 [00:00<00:01, 1341.90it/s]Computing within-cluster distances:  20%|██        | 409/2000 [00:00<00:01, 1390.93it/s]Computing within-cluster distances:  27%|██▋       | 549/2000 [00:00<00:01, 873.93it/s] Computing within-cluster distances:  33%|███▎      | 656/2000 [00:00<00:02, 605.97it/s]Computing within-cluster distances:  37%|███▋      | 737/2000 [00:01<00:02, 522.51it/s]Computing within-cluster distances:  40%|████      | 803/2000 [00:01<00:02, 516.38it/s]Computing within-cluster distances:  47%|████▋     | 942/2000 [00:01<00:01, 690.14it/s]Computing within-cluster distances:  64%|██████▍   | 1285/2000 [00:01<00:00, 1296.54it/s]Computing within-cluster distances:  87%|████████▋ | 1743/2000 [00:01<00:00, 2085.06it/s]Computing within-cluster distances: 100%|██████████| 2000/2000 [00:01<00:00, 1290.28it/s]
Computing between-cluster distances for 1000 cluster pairs...
  0%|          | 0/1000 [00:00<?, ?it/s] 10%|█         | 105/1000 [00:00<00:00, 1028.46it/s] 21%|██        | 208/1000 [00:00<00:00, 961.11it/s]  30%|███       | 305/1000 [00:00<00:00, 924.91it/s] 40%|███▉      | 398/1000 [00:00<00:00, 890.22it/s] 49%|████▉     | 494/1000 [00:00<00:00, 911.00it/s] 59%|█████▉    | 589/1000 [00:00<00:00, 921.59it/s] 70%|███████   | 704/1000 [00:00<00:00, 991.55it/s] 81%|████████  | 810/1000 [00:00<00:00, 1012.39it/s] 91%|█████████ | 912/1000 [00:00<00:00, 978.80it/s] 100%|██████████| 1000/1000 [00:01<00:00, 948.91it/s]

Clustering Summary (n_clusters=2000):
  Mean within-cluster distance: 0.2520
  Mean between-cluster distance: 0.3851
  Separation ratio: 1.5281
  Cluster size distribution: min=1, max=82, mean=5.5

============================================================
Total computation time: 20.11 minutes
============================================================
✓ Intermediate results saved to: /home/datadi/burns/aws/workloads/results/metrics/agglomerative_clustering/agglomerative_clustering_full_results.json

============================================================
✓ FULL analysis complete!
✓ Results saved to: /home/datadi/burns/aws/workloads/results/metrics/agglomerative_clustering/agglomerative_clustering_full_results.json
============================================================
